### kerberos


---

---

# üìò –ì–ª–∞–≤–∞ 1. –í–≤–µ–¥–µ–Ω–∏–µ

## 1.1. –ê–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å —Ç–µ–º—ã

–ü—Ä–æ—Ç–æ–∫–æ–ª Kerberos —è–≤–ª—è–µ—Ç—Å—è –æ—Å–Ω–æ–≤–Ω—ã–º –º–µ—Ö–∞–Ω–∏–∑–º–æ–º –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≤ –¥–æ–º–µ–Ω–Ω—ã—Ö —Å–µ—Ç—è—Ö Microsoft Active Directory –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ä–µ—Å—É—Ä—Å–∞–º –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã. –ù–µ—Å–º–æ—Ç—Ä—è –Ω–∞ –≤—ã—Å–æ–∫—É—é —Å—Ç–µ–ø–µ–Ω—å –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–π –∑–∞—â–∏—â—ë–Ω–Ω–æ—Å—Ç–∏, –ø—Ä–æ—Ç–æ–∫–æ–ª –ø–æ–¥–≤–µ—Ä–∂–µ–Ω —Ä–∞–∑–ª–∏—á–Ω—ã–º —Ç–∏–ø–∞–º –∞—Ç–∞–∫, –ø–æ–∑–≤–æ–ª—è—é—â–∏–º –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫–∞–º –æ–±—Ö–æ–¥–∏—Ç—å —Å–∏—Å—Ç–µ–º—É –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –±–µ–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —è–≤–Ω–æ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π.

–¢–∞–∫–∏–µ –∞—Ç–∞–∫–∏, –∫–∞–∫ **Golden Ticket**, **Silver Ticket**, **Kerberoasting**, **AS-REP Roasting** –∏ **Pass-the-Ticket**, –≤—Å—ë —á–∞—â–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –ø—Ä–∏ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏–∏ –ø–µ–Ω—Ç–µ—Å—Ç–æ–≤ –∏ —Å–ª–æ–∂–Ω—ã—Ö APT-–∞—Ç–∞–∫. –û–Ω–∏ –Ω–µ –æ—Å—Ç–∞–≤–ª—è—é—Ç —Å–ª–µ–¥–æ–≤ –≤ —Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤–∞—Ö –∑–∞—â–∏—Ç—ã, —Ç–∞–∫–∏—Ö –∫–∞–∫ –∞–Ω—Ç–∏–≤–∏—Ä—É—Å—ã –∏–ª–∏ —Ñ–∞–µ—Ä–≤–æ–ª—ã, –ø–æ—Å–∫–æ–ª—å–∫—É –º–∞—Å–∫–∏—Ä—É—é—Ç—Å—è –ø–æ–¥ –Ω–æ—Ä–º–∞–ª—å–Ω—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Å–µ—Ç–∏ –∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –ª–µ–≥–∏—Ç–∏–º–Ω—ã–µ –ø—Ä–æ—Ç–æ–∫–æ–ª—ã –¥–æ–º–µ–Ω–Ω–æ–π —Å—Ä–µ–¥—ã.

–≠—Ç–æ –¥–µ–ª–∞–µ—Ç –æ—Å–æ–±–µ–Ω–Ω–æ –≤–∞–∂–Ω—ã–º —Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É –ø—Ä–æ–≥—Ä–∞–º–º–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π, —Å–ø–æ—Å–æ–±–Ω—ã—Ö –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å–µ—Ç–µ–≤–æ–π —Ç—Ä–∞—Ñ–∏–∫ Active Directory –∏ –≤—ã—è–≤–ª—è—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–∏ –∞—Ç–∞–∫ –Ω–∞ –ø—Ä–æ—Ç–æ–∫–æ–ª Kerberos –Ω–∞ –æ—Å–Ω–æ–≤–µ –∞–Ω–æ–º–∞–ª—å–Ω–æ–≥–æ –ø–æ–≤–µ–¥–µ–Ω–∏—è. –¢–∞–∫–∏–µ —Å–∏—Å—Ç–µ–º—ã –ø–æ–∑–≤–æ–ª—è—Ç –ø–æ–≤—ã—Å–∏—Ç—å —É—Ä–æ–≤–µ–Ω—å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º –∏ —Å–Ω–∏–∑–∏—Ç—å —Ä–∏—Å–∫–∏ –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏–∏ –¥–æ–º–µ–Ω–Ω–æ–π —Å—Ä–µ–¥—ã.

–°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–æ–¥—Ö–æ–¥—ã –∫ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—é –∞—Ç–∞–∫ –Ω–∞ Kerberos –≤–∫–ª—é—á–∞—é—Ç —Å–∏–≥–Ω–∞—Ç—É—Ä–Ω—ã–π –∞–Ω–∞–ª–∏–∑ (–æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–π –Ω–∞ –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö —à–∞–±–ª–æ–Ω–∞—Ö), –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø—Ä–∞–≤–∏–ª SIEM-—Å–∏—Å—Ç–µ–º –∏ —Ä—É—á–Ω–æ–µ —Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–æ–≤. –û–¥–Ω–∞–∫–æ –æ–Ω–∏ —Ç—Ä–µ–±—É—é—Ç –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤ –∏ —á–∞—Å—Ç–æ –Ω–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã –ø—Ä–æ—Ç–∏–≤ –Ω–æ–≤—ã—Ö –∏–ª–∏ –º–∞–ª–æ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤ –∞—Ç–∞–∫. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –∞–∫—Ç—É–∞–ª—å–Ω–æ–π –∑–∞–¥–∞—á–µ–π —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è, —Ä–µ–∞–ª–∏–∑—É—é—â–µ–≥–æ –ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∏–π –ø–æ–¥—Ö–æ–¥ –∫ –≤—ã—è–≤–ª–µ–Ω–∏—é —É–≥—Ä–æ–∑, –æ—Å–Ω–æ–≤–∞–Ω–Ω–æ–º—É –Ω–∞ –∞–Ω–∞–ª–∏–∑–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–π –æ—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ –ø–æ–≤–µ–¥–µ–Ω–∏—è Kerberos-—Å–µ—Å—Å–∏–π.

---

## 1.2. –¶–µ–ª—å —Ä–∞–±–æ—Ç—ã

–¶–µ–ª—å—é –¥–∞–Ω–Ω–æ–π –≤—ã–ø—É—Å–∫–Ω–æ–π –∫–≤–∞–ª–∏—Ñ–∏–∫–∞—Ü–∏–æ–Ω–Ω–æ–π —Ä–∞–±–æ—Ç—ã —è–≤–ª—è–µ—Ç—Å—è **—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è, –≤—ã—è–≤–ª—è—é—â–µ–≥–æ –∞—Ç–∞–∫–∏ –Ω–∞ –ø—Ä–æ—Ç–æ–∫–æ–ª Kerberos —á–µ—Ä–µ–∑ –∞–Ω–∞–ª–∏–∑ –∞–Ω–æ–º–∞–ª–∏–π –≤ —Å–µ—Ç–µ–≤–æ–º —Ç—Ä–∞—Ñ–∏–∫–µ Active Directory**.

–î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ —ç—Ç–æ–π —Ü–µ–ª–∏ –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç —Å–æ–∑–¥–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã, —Å–ø–æ—Å–æ–±–Ω–æ–π:
- –°–æ–±–∏—Ä–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ —Å–µ—Ç–µ–≤–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞ (PCAP) –∏ –∂—É—Ä–Ω–∞–ª–æ–≤ —Å–æ–±—ã—Ç–∏–π Windows.
- –ü–∞—Ä—Å–∏—Ç—å Kerberos-—Å–æ–æ–±—â–µ–Ω–∏—è –∏ –∏–∑–≤–ª–µ–∫–∞—Ç—å –∫–ª—é—á–µ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã.
- –û–±–Ω–∞—Ä—É–∂–∏–≤–∞—Ç—å –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è –æ—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ –ø–æ–≤–µ–¥–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ —Å–µ—Ä–≤–∏—Å–æ–≤.
- –§–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö –∞—Ç–∞–∫–∞—Ö –∏ –≤—ã–≤–æ–¥–∏—Ç—å –∏—Ö –≤ —É–¥–æ–±–æ—á–∏—Ç–∞–µ–º–æ–º –≤–∏–¥–µ.

---

## 1.3. –ó–∞–¥–∞—á–∏ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è

–î–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è —É–∫–∞–∑–∞–Ω–Ω–æ–π —Ü–µ–ª–∏ –±—ã–ª–∏ –ø–æ—Å—Ç–∞–≤–ª–µ–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ –∑–∞–¥–∞—á–∏:

1. **–ü—Ä–æ–≤–µ—Å—Ç–∏ –∞–Ω–∞–ª–∏–∑ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–µ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ Kerberos –≤ —Å—Ä–µ–¥–µ Active Directory.**
   - –ò–∑—É—á–∏—Ç—å —ç—Ç–∞–ø—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏: AS-REQ / AS-REP, TGS-REQ / TGS-REP, AP-REQ.
   - –ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É Kerberos-–±–∏–ª–µ—Ç–æ–≤ –∏ —Ñ–æ—Ä–º–∞—Ç —Å–æ–æ–±—â–µ–Ω–∏–π.
   - –†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å —Ä–æ–ª—å KDC, SPN –∏ —É—á–µ—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏ krbtgt.

2. **–ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å –∏–∑–≤–µ—Å—Ç–Ω—ã–µ –º–µ—Ç–æ–¥–∏–∫–∏ –∞—Ç–∞–∫ –Ω–∞ –ø—Ä–æ—Ç–æ–∫–æ–ª Kerberos.**
   - –ò–∑—É—á–∏—Ç—å —Ç–∞–∫–∏–µ –∞—Ç–∞–∫–∏, –∫–∞–∫ Golden Ticket, Silver Ticket, Kerberoasting, AS-REP Roasting, Pass-the-Ticket.
   - –í—ã—è–≤–∏—Ç—å —Ö–∞—Ä–∞–∫—Ç–µ—Ä–Ω—ã–µ —Å–µ—Ç–µ–≤—ã–µ –∏ –ª–æ–≥–æ–≤—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏–∏.
   - –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Å–ø–æ—Å–æ–±—ã –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∫–∞–∂–¥–æ–π –∏–∑ –Ω–∏—Ö.

3. **–í—ã—è–≤–∏—Ç—å —Ö–∞—Ä–∞–∫—Ç–µ—Ä–Ω—ã–µ —Å–µ—Ç–µ–≤—ã–µ –∏ –ª–æ–≥–æ–≤—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏–∏.**
   - –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —á–∞—Å—Ç–æ—Ç—É –∑–∞–ø—Ä–æ—Å–æ–≤ TGT/TGS.
   - –ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å TTL –±–∏–ª–µ—Ç–æ–≤, SPN, –æ—à–∏–±–∫–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏.
   - –°–æ–∑–¥–∞—Ç—å –º–æ–¥–µ–ª–∏ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ –ø–æ–≤–µ–¥–µ–Ω–∏—è Kerberos-—Å–µ—Å—Å–∏–π.

4. **–†–∞–∑—Ä–∞–±–æ—Ç–∞—Ç—å –º–æ–¥–µ–ª—å –ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞.**
   - –ü–æ—Å—Ç—Ä–æ–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª–∏ –ø–æ–≤–µ–¥–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ —Å–µ—Ä–≤–∏—Å–æ–≤.
   - –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ç–µ–∫—É—â–∏—Ö —Å–æ–±—ã—Ç–∏–π —Å –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏.
   - –†–∞–∑—Ä–∞–±–æ—Ç–∞—Ç—å –ø—Ä–∞–≤–∏–ª–∞ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∞–Ω–æ–º–∞–ª–∏–π.

5. **–°–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º–Ω—ã–π –º–æ–¥—É–ª—å.**
   - –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –∏–∑ PCAP-—Ñ–∞–π–ª–æ–≤ –∏ –ª–æ–≥–æ–≤ Windows.
   - –†–∞–∑—Ä–∞–±–æ—Ç–∞—Ç—å –ø–∞—Ä—Å–µ—Ä Kerberos-—Å–æ–æ–±—â–µ–Ω–∏–π.
   - –°–æ–∑–¥–∞—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º—ã –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∞—Ç–∞–∫.
   - –û—Ä–≥–∞–Ω–∏–∑–æ–≤–∞—Ç—å –≤—ã–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤ CLI –∏ JSON-—Ñ–æ—Ä–º–∞—Ç–µ.

6. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–Ω–æ–µ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–µ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–µ.**
   - –ü—Ä–æ–≤–µ—Å—Ç–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —ç—Ç–∞–ª–æ–Ω–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏—è—Ö –∞—Ç–∞–∫.
   - –û—Ü–µ–Ω–∏—Ç—å —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –ø–æ –º–µ—Ç—Ä–∏–∫–∞–º —Ç–æ—á–Ω–æ—Å—Ç–∏ –∏ —Å–∫–æ—Ä–æ—Å—Ç–∏.
   - –°—Ä–∞–≤–Ω–∏—Ç—å —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ —Ä–µ—à–µ–Ω–∏—è–º–∏.

---

## 1.4. –û–±—ä–µ–∫—Ç –∏ –ø—Ä–µ–¥–º–µ—Ç –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è

### –û–±—ä–µ–∫—Ç –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è:
–°–∏—Å—Ç–µ–º–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ Kerberos –≤ —Å—Ä–µ–¥–µ Microsoft Active Directory.

### –ü—Ä–µ–¥–º–µ—Ç –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è:
–ü—Ä–æ—Ü–µ—Å—Å –≤—ã—è–≤–ª–µ–Ω–∏—è –∞—Ç–∞–∫ –Ω–∞ –ø—Ä–æ—Ç–æ–∫–æ–ª Kerberos —Å –ø–æ–º–æ—â—å—é –ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ —Å–µ—Ç–µ–≤–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞ –∏ –∂—É—Ä–Ω–∞–ª–∏—Ä–æ–≤–∞–Ω–∏—è —Å–æ–±—ã—Ç–∏–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.

---

## 1.5. –ú–µ—Ç–æ–¥–æ–ª–æ–≥–∏—è –∏ –ø–æ–¥—Ö–æ–¥—ã

–†–∞–±–æ—Ç–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ —Å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º —Å–ª–µ–¥—É—é—â–∏—Ö –º–µ—Ç–æ–¥–æ–ª–æ–≥–∏–π –∏ –ø–æ–¥—Ö–æ–¥–æ–≤:

- **–ê–Ω–∞–ª–∏–∑ –Ω–∞—É—á–Ω–æ–π –∏ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–π –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä—ã** –ø–æ –ø—Ä–æ—Ç–æ–∫–æ–ª—É Kerberos –∏ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º —É–≥—Ä–æ–∑–∞–º.
- **–≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥** ‚Äî –ø—Ä–æ–≤–µ–¥–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö –∞—Ç–∞–∫ –≤ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º–æ–π –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–π —Å—Ä–µ–¥–µ.
- **–°–∏–≥–Ω–∞—Ç—É—Ä–Ω—ã–π –∏ –ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑** –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∞–Ω–æ–º–∞–ª–∏–π.
- **–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è** —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —è–∑—ã–∫–∞ Python –∏ –±–∏–±–ª–∏–æ—Ç–µ–∫ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Å–µ—Ç–µ–≤–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞ –∏ –ª–æ–≥–æ–≤ Windows.


## 1.6. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–∞–±–æ—Ç—ã

–†–∞–±–æ—Ç–∞ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ **—à–µ—Å—Ç–∏ –≥–ª–∞–≤**, —Å–ø–∏—Å–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –∏ **–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π**.

| –ì–ª–∞–≤–∞ | –¢–µ–º–∞ |
|-------|------|
| **–ì–ª–∞–≤–∞ 1** | –í–≤–µ–¥–µ–Ω–∏–µ ‚Äî —Å–æ–¥–µ—Ä–∂–∏—Ç —Ü–µ–ª—å, –∑–∞–¥–∞—á–∏, –æ–±—ä–µ–∫—Ç –∏ –ø—Ä–µ–¥–º–µ—Ç –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è, –∞ —Ç–∞–∫–∂–µ –æ–±–æ—Å–Ω–æ–≤—ã–≤–∞–µ—Ç—Å—è –µ—ë –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å. |
| **–ì–ª–∞–≤–∞ 2** | –¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–µ –æ—Å–Ω–æ–≤—ã ‚Äî –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ Kerberos, –µ–≥–æ —Ä–æ–ª–∏ –≤ Active Directory –∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —Ç–∏–ø–æ–≤—ã—Ö –∞—Ç–∞–∫. |
| **–ì–ª–∞–≤–∞ 3** | –ê–Ω–∞–ª–∏–∑ –∞—Ç–∞–∫ –∏ –≤—ã—è–≤–ª–µ–Ω–∏–µ –∞–Ω–æ–º–∞–ª–∏–π ‚Äî –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —É–≥—Ä–æ–∑, –≤—ã—è–≤–ª–µ–Ω–∏–µ –∞–Ω–æ–º–∞–ª–∏–π –∏ –º–µ—Ç–æ–¥—ã –∏—Ö –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è. |
| **–ì–ª–∞–≤–∞ 4** | –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è ‚Äî –æ–ø–∏—Å–∞–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–≥—Ä–∞–º–º—ã. |
| **–ì–ª–∞–≤–∞ 5** | –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ—Ü–µ–Ω–∫–∞ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ ‚Äî –ø—Ä–æ–≤–µ–¥–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤ –∏ –∞–Ω–∞–ª–∏–∑ –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤. |
| **–ì–ª–∞–≤–∞ 6** | –ó–∞–∫–ª—é—á–µ–Ω–∏–µ ‚Äî –≤—ã–≤–æ–¥—ã –ø–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –∏ –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤—ã –¥–∞–ª—å–Ω–µ–π—à–µ–π —Ä–∞–±–æ—Ç—ã. |

**–ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è** —Å–æ–¥–µ—Ä–∂–∞—Ç –∏—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ –ø—Ä–æ–≥—Ä–∞–º–º—ã, –ø—Ä–∏–º–µ—Ä—ã –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∞—Ç–∞–∫, —á–µ–∫-–ª–∏—Å—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –¥—Ä—É–≥–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã.

---


# üìò –ì–ª–∞–≤–∞ 2. –¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–µ –æ—Å–Ω–æ–≤—ã

## 2.1. –ü—Ä–æ—Ç–æ–∫–æ–ª Kerberos: –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ —ç—Ç–∞–ø—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

–ü—Ä–æ—Ç–æ–∫–æ–ª Kerberos ‚Äî —ç—Ç–æ –º–µ—Ö–∞–Ω–∏–∑–º —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏, —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–π –ø—Ä–æ–µ–∫—Ç–æ–º Athena –≤ –£–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–µ –ë–µ—Ä–∫–ª–∏ –∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –≤ RFC 4120 –∫–∞–∫ Kerberos –≤–µ—Ä—Å–∏–∏ 5. –ï–≥–æ —Ü–µ–ª—å ‚Äî –æ–±–µ—Å–ø–µ—á–∏—Ç—å –±–µ–∑–æ–ø–∞—Å–Ω–æ–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–æ–¥–ª–∏–Ω–Ω–æ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ —Å–µ—Ä–≤–∏—Å–æ–≤ –≤ –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω–æ–π —Å–µ—Ç–∏ –±–µ–∑ –ø–µ—Ä–µ–¥–∞—á–∏ –ø–∞—Ä–æ–ª–µ–π –ø–æ –∫–∞–Ω–∞–ª—É —Å–≤—è–∑–∏.

### 2.1.1. –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã Kerberos

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|----------|
| **KDC (Key Distribution Center)** | –¶–µ–Ω—Ç—Ä —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –∫–ª—é—á–µ–π, —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ Authentication Server (AS) –∏ Ticket Granting Server (TGS) |
| **TGT (Ticket Granting Ticket)** | –í—Ä–µ–º–µ–Ω–Ω—ã–π –±–∏–ª–µ—Ç, –≤—ã–¥–∞–≤–∞–µ–º—ã–π –ø—Ä–∏ —É—Å–ø–µ—à–Ω–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ —É AS |
| **TGS-–±–∏–ª–µ—Ç (Service Ticket)** | –ë–∏–ª–µ—Ç –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É —Å–µ—Ä–≤–∏—Å—É |
| **SPN (Service Principal Name)** | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Å–µ—Ä–≤–∏—Å–∞ –≤ –¥–æ–º–µ–Ω–µ |
| **Principal** | –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–ª–∏ —Å–µ—Ä–≤–∏—Å–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ user@REALM |

### 2.1.2. –≠—Ç–∞–ø—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≤ Kerberos

#### –≠—Ç–∞–ø 1. –ó–∞–ø—Ä–æ—Å TGT (AS-REQ)
–ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–ø—Ä–æ—Å –Ω–∞ KDC —Å –∏–º–µ–Ω–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –¥—Ä—É–≥–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏. –û–Ω –º–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—É—é –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é (pre-authentication).

#### –≠—Ç–∞–ø 2. –û—Ç–≤–µ—Ç –æ—Ç AS (AS-REP)
KDC –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ª–∏—á–Ω–æ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –ï—Å–ª–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞, –æ–Ω –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç:
- **TGT**, –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–ª—é—á–æ–º krbtgt,
- **–°–µ—Å—Å–∏–æ–Ω–Ω—ã–π –∫–ª—é—á**, –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π —Ö—ç—à–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

#### –≠—Ç–∞–ø 3. –ó–∞–ø—Ä–æ—Å TGS (TGS-REQ)
–î–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É —Å–µ—Ä–≤–∏—Å—É –∫–ª–∏–µ–Ω—Ç –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç —É TGS –±–∏–ª–µ—Ç –Ω–∞ –¥–æ—Å—Ç—É–ø –∫ –Ω–µ–º—É, –∏—Å–ø–æ–ª—å–∑—É—è TGT.

#### –≠—Ç–∞–ø 4. –û—Ç–≤–µ—Ç –æ—Ç TGS (TGS-REP)
KDC –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç:
- **TGS-–±–∏–ª–µ—Ç**, –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–ª—é—á–æ–º —Å–µ—Ä–≤–∏—Å–∞,
- **–°–µ—Å—Å–∏–æ–Ω–Ω—ã–π –∫–ª—é—á –∫–ª–∏–µ–Ω—Ç–∞ –∏ —Å–µ—Ä–≤–∏—Å–∞**, –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–µ—Å—Å–∏–æ–Ω–Ω—ã–º –∫–ª—é—á–æ–º –∫–ª–∏–µ–Ω—Ç–∞ –∏ TGT.

#### –≠—Ç–∞–ø 5. –î–æ—Å—Ç—É–ø –∫ —Å–µ—Ä–≤–∏—Å—É (AP-REQ / AP-REP)
–ö–ª–∏–µ–Ω—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç TGS-–±–∏–ª–µ—Ç –∏ –∞–≤—Ç–æ—Ä–∏–∑—É–µ—Ç—Å—è —É —Å–µ—Ä–≤–∏—Å–∞, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ–¥–ª–∏–Ω–Ω–æ—Å—Ç—å –±–∏–ª–µ—Ç–∞ –∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ —Ä–µ—Å—É—Ä—Å—É.

### 2.1.3. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å Kerberos

- –í—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è —à–∏—Ñ—Ä—É—é—Ç—Å—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω—ã—Ö –∫–ª—é—á–µ–π.
- –ü–∞—Ä–æ–ª—å –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –ø–æ —Å–µ—Ç–∏.
- –ë–∏–ª–µ—Ç—ã –∏–º–µ—é—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–µ –≤—Ä–µ–º—è –∂–∏–∑–Ω–∏.
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è pre-authentication –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è offline-–∞—Ç–∞–∫.

---

## 2.2. –†–æ–ª—å Kerberos –≤ Microsoft Active Directory

Microsoft Active Directory (AD) –∏–Ω—Ç–µ–≥—Ä–∏—Ä—É–µ—Ç –ø—Ä–æ—Ç–æ–∫–æ–ª Kerberos –∫–∞–∫ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –º–µ—Ö–∞–Ω–∏–∑–º –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –∫–æ–º–ø—å—é—Ç–µ—Ä–æ–≤ –≤ –¥–æ–º–µ–Ω–Ω–æ–π —Å—Ä–µ–¥–µ. –≠—Ç–æ –¥–µ–ª–∞–µ—Ç Kerberos —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–º —ç–ª–µ–º–µ–Ω—Ç–æ–º –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –≤—Å–µ–π –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã.

### 2.2.1. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Kerberos –≤ AD

- **KDC** —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –≤ –≤–∏–¥–µ —Å–ª—É–∂–±—ã NetLogon –Ω–∞ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞—Ö –¥–æ–º–µ–Ω–∞.
- **krbtgt** ‚Äî —Å–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è —É—á–µ—Ç–Ω–∞—è –∑–∞–ø–∏—Å—å –¥–æ–º–µ–Ω–∞, –∏—Å–ø–æ–ª—å–∑—É–µ–º–∞—è –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è TGT.
- –ö–∞–∂–¥—ã–π –∫–æ–º–ø—å—é—Ç–µ—Ä –≤ –¥–æ–º–µ–Ω–µ –∏–º–µ–µ—Ç —Å–≤–æ—é —É—á–µ—Ç–Ω—É—é –∑–∞–ø–∏—Å—å, –∫–æ—Ç–æ—Ä–∞—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≤ –¥–æ–º–µ–Ω–µ.

### 2.2.2. –ü–æ–ª–∏—Ç–∏–∫–∏ Kerberos –≤ AD

–ü–æ–ª–∏—Ç–∏–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ Kerberos:

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|----------|
| **max-ticket-life** | –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –∂–∏–∑–Ω–∏ TGT (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 10 —á–∞—Å–æ–≤) |
| **max-renewable-ticket-life** | –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –ø—Ä–æ–¥–ª–µ–Ω–∏—è –±–∏–ª–µ—Ç–∞ (–¥–æ 7 –¥–Ω–µ–π) |
| **realm** | –ò–º—è –¥–æ–º–µ–Ω–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, LAB.LOCAL) |
| **pre-authentication** | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤–∫–ª—é—á–µ–Ω–∞) |

–≠—Ç–∏ –ø–æ–ª–∏—Ç–∏–∫–∏ –º–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å —á–µ—Ä–µ–∑ –≥—Ä—É–ø–ø–æ–≤—ã–µ –ø–æ–ª–∏—Ç–∏–∫–∏ (GPO), –Ω–æ –∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–µ –≤–ª–∏—è–µ—Ç –Ω–∞ —É—Ä–æ–≤–µ–Ω—å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å.

### 2.2.3. –ñ—É—Ä–Ω–∞–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π Kerberos –≤ Windows

Windows Event Logs —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–æ–±—ã—Ç–∏—è, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å Kerberos:

| ID —Å–æ–±—ã—Ç–∏—è | –û–ø–∏—Å–∞–Ω–∏–µ |
|-----------|----------|
| **4768** | –ó–∞–ø—Ä–æ—Å TGT |
| **4769** | –ó–∞–ø—Ä–æ—Å TGS |
| **4771** | –û—à–∏–±–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ Kerberos |
| **4624** | –£—Å–ø–µ—à–Ω—ã–π –≤—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É |
| **4625** | –ù–µ—É–¥–∞—á–Ω–∞—è –ø–æ–ø—ã—Ç–∫–∞ –≤—Ö–æ–¥–∞ |

–≠—Ç–∏ —Å–æ–±—ã—Ç–∏—è —è–≤–ª—è—é—Ç—Å—è –≤–∞–∂–Ω—ã–º –∏—Å—Ç–æ—á–Ω–∏–∫–æ–º –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∞–Ω–æ–º–∞–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏.

---

## 2.3. –¢–∏–ø–æ–≤—ã–µ –∞—Ç–∞–∫–∏ –Ω–∞ –ø—Ä–æ—Ç–æ–∫–æ–ª Kerberos

–ù–µ—Å–º–æ—Ç—Ä—è –Ω–∞ –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç—å —Å–∞–º–æ–≥–æ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞, –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫–∏ –Ω–∞—Ö–æ–¥—è—Ç —Å–ø–æ—Å–æ–±—ã –µ–≥–æ —ç–∫—Å–ø–ª—É–∞—Ç–∏—Ä–æ–≤–∞—Ç—å, –∏—Å–ø–æ–ª—å–∑—É—è —Å–ª–∞–±—ã–µ –º–µ—Å—Ç–∞ –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ —É—á—ë—Ç–Ω—ã–º–∏ –∑–∞–ø–∏—Å—è–º–∏ –∏ –ø–æ–ª–∏—Ç–∏–∫–∞–º–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.

### 2.3.1. Golden Ticket

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–¥–¥–µ–ª—å–Ω–æ–≥–æ TGT –≤–Ω–µ —Å–∏—Å—Ç–µ–º—ã, –∏—Å–ø–æ–ª—å–∑—É—è —Ö—ç—à —É—á–µ—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏ krbtgt.
- **–¶–µ–ª—å**: –ü–æ–ª—É—á–µ–Ω–∏–µ –Ω–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫–æ –≤—Å–µ–º —Ä–µ—Å—É—Ä—Å–∞–º –¥–æ–º–µ–Ω–∞.
- **–ú–µ—Ç–æ–¥—ã –ø–æ–ª—É—á–µ–Ω–∏—è —Ö—ç—à–∞ krbtgt**:
  - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Mimikatz –Ω–∞ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–µ –¥–æ–º–µ–Ω–∞.
  - –ü–µ—Ä–µ—Ö–≤–∞—Ç —Ç—Ä–∞—Ñ–∏–∫–∞ —Å –ø–æ–º–æ—â—å—é Pass-the-Ticket.
- **–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ**:
  - –î–æ–ª–≥–∏–π TTL –±–∏–ª–µ—Ç–∞.
  - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∫–æ—Ç–æ—Ä–æ–≥–æ –Ω–µ—Ç –≤ —Å–∏—Å—Ç–µ–º–µ.
  - –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Å–æ–±—ã—Ç–∏—è –≤—Ö–æ–¥–∞ –≤ —Å–∏—Å—Ç–µ–º—É.

### 2.3.2. Silver Ticket

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –ü–æ–¥–¥–µ–ª–∫–∞ TGS-–±–∏–ª–µ—Ç–∞ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ö—ç—à–∞ –µ–≥–æ —É—á–µ—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏.
- **–¶–µ–ª—å**: –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞ –∫ –æ–¥–Ω–æ–º—É —Å–µ—Ä–≤–∏—Å—É –±–µ–∑ –æ–±—Ä–∞—â–µ–Ω–∏—è –∫ KDC.
- **–ú–µ—Ç–æ–¥—ã –ø–æ–ª—É—á–µ–Ω–∏—è —Ö—ç—à–∞ —Å–µ—Ä–≤–∏—Å–∞**:
  - –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∏–∑ –ø–∞–º—è—Ç–∏ —Å–µ—Ä–≤–µ—Ä–∞ —Å–µ—Ä–≤–∏—Å–∞ —Å –ø–æ–º–æ—â—å—é Mimikatz.
  - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–∞–Ω–µ–µ —É–∫—Ä–∞–¥–µ–Ω–Ω–æ–≥–æ —Ö—ç—à–∞ –∏–∑ –¥–∞–º–ø–∞ SAM/NTDS.
- **–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ**:
  - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –±–∏–ª–µ—Ç–∞ –±–µ–∑ –ø—Ä–µ–¥—à–µ—Å—Ç–≤—É—é—â–µ–≥–æ TGT.
  - –ó–∞–ø—Ä–æ—Å—ã –∫ SPN, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ–º—É –ø–æ–≤–µ–¥–µ–Ω–∏—é.

### 2.3.3. Pass-the-Ticket (PtT)

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —É–∫—Ä–∞–¥–µ–Ω–Ω–æ–≥–æ –±–∏–ª–µ—Ç–∞ –±–µ–∑ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏.
- **–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã**:
  - Mimikatz (`kerberos::list /export`)
  - Rubeus
- **–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ**:
  - –ü–æ–≤—Ç–æ—Ä–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –æ–¥–Ω–æ–≥–æ –∏ —Ç–æ–≥–æ –∂–µ –±–∏–ª–µ—Ç–∞.
  - –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∏–∑ —Ä–∞–∑–Ω—ã—Ö —Ö–æ—Å—Ç–æ–≤ —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º –±–∏–ª–µ—Ç–æ–º.

### 2.3.4. Kerberoasting

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –ó–∞–ø—Ä–æ—Å TGS –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö SPN —Å –ø–æ—Å–ª–µ–¥—É—é—â–∏–º –æ—Ñ—Ñ–ª–∞–π–Ω-–ø–µ—Ä–µ–±–æ—Ä–æ–º —Ö—ç—à–µ–π.
- **–¶–µ–ª—å**: –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π –æ—Ç —É—á–µ—Ç–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π —Å–µ—Ä–≤–∏—Å–æ–≤.
- **–ú–µ—Ç–æ–¥—ã –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è**:
  - `GetUserSPNs.py` (Impacket)
  - Rubeus
- **–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ**:
  - –ú–Ω–æ–∂–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ TGS –∫ —Ä–∞–∑–Ω—ã–º SPN.
  - –í—ã—Å–æ–∫–∞—è —á–∞—Å—Ç–æ—Ç–∞ —Ç–∞–∫–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤.

### 2.3.5. AS-REP Roasting

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –ü–æ–ª—É—á–µ–Ω–∏–µ —á–∞—Å—Ç–∏ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞ AS-REP –±–µ–∑ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏.
- **–£—Å–ª–æ–≤–∏–µ**: –í—ã–∫–ª—é—á–µ–Ω–∏–µ pre-authentication —É –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.
- **–ú–µ—Ç–æ–¥—ã –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è**:
  - Rubeus (`asreproast`)
- **–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ**:
  - –ú–Ω–æ–∂–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ AS-REQ –±–µ–∑ –ø–æ—Å–ª–µ–¥—É—é—â–µ–≥–æ –æ—Ç–≤–µ—Ç–∞ –∫–ª–∏–µ–Ω—Ç–∞.
  - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –≤—ã–∫–ª—é—á–µ–Ω–Ω–æ–π pre-authentication.

### 2.3.6. Brute-force –∞—Ç–∞–∫–∏ —á–µ—Ä–µ–∑ Kerberos

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –ü–µ—Ä–µ–±–æ—Ä –ø–∞—Ä–æ–ª–µ–π –ø—É—Ç—ë–º –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏.
- **–ú–µ—Ç–æ–¥—ã –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è**:
  - Kerbrute
  - Rubeus
- **–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ**:
  - –°–µ—Ä–∏—è —Å–æ–±—ã—Ç–∏–π 4771 —Å –æ—à–∏–±–∫–æ–π "bad password".
  - –ü–æ–≤—Ç–æ—Ä–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏ –≤—Ö–æ–¥–∞ –æ—Ç –æ–¥–Ω–æ–≥–æ IP-–∞–¥—Ä–µ—Å–∞ –∏–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

---

## 2.4. MITRE ATT&CK –∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –∞—Ç–∞–∫ –Ω–∞ Kerberos

MITRE ATT&CK Framework –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ç–∞–∫—Ç–∏–∫ –∏ —Ç–µ—Ö–Ω–∏–∫, –ø—Ä–∏–º–µ–Ω—è–µ–º—ã—Ö –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫–∞–º–∏. –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –∏–∑ –Ω–∏—Ö –Ω–∞–ø—Ä—è–º—É—é —Å–≤—è–∑–∞–Ω—ã —Å –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–º Kerberos:

| ID —Ç–µ—Ö–Ω–∏–∫–∏ | –ù–∞–∑–≤–∞–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|------------|----------|----------|
| T1097      | Pass the Ticket | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —É–∫—Ä–∞–¥–µ–Ω–Ω—ã—Ö –±–∏–ª–µ—Ç–æ–≤ Kerberos |
| T1558      | Steal or Forge Kerberos Tickets | –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–¥–¥–µ–ª—å–Ω—ã—Ö –±–∏–ª–µ—Ç–æ–≤ (Golden/Silver Ticket) |
| T1485      | Kerberoasting | –ó–∞–ø—Ä–æ—Å –∏ –ø–µ—Ä–µ–±–æ—Ä TGS-–±–∏–ª–µ—Ç–æ–≤ |
| T1533      | Account Manipulation | –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —É—á–µ—Ç–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π –¥–ª—è –æ–±–ª–µ–≥—á–µ–Ω–∏—è –∞—Ç–∞–∫ |
| T1078      | Valid Accounts | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ª–µ–≥–∏—Ç–∏–º–Ω—ã—Ö —É—á–µ—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –≤—Ö–æ–¥–∞ |

---

## 2.5. –ó–∞–∫–ª—é—á–µ–Ω–∏–µ –ø–æ –≥–ª–∞–≤–µ

–í –¥–∞–Ω–Ω–æ–π –≥–ª–∞–≤–µ –±—ã–ª–∏ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω—ã –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ –ø—Ä–∏–Ω—Ü–∏–ø—ã —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ Kerberos, –µ–≥–æ —Ä–æ–ª—å –≤ —Å—Ä–µ–¥–µ Microsoft Active Directory, –∞ —Ç–∞–∫–∂–µ —Ç–∏–ø–æ–≤—ã–µ –∞—Ç–∞–∫–∏, –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –Ω–∞ –æ–±—Ö–æ–¥ –ª–µ–≥–∏—Ç–∏–º–Ω–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏. –ë—ã–ª–æ –ø–æ–∫–∞–∑–∞–Ω–æ, —á—Ç–æ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤ –∞—Ç–∞–∫ –Ω–∞ –¥–æ–º–µ–Ω–Ω—ã–µ —Å–µ—Ç–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç Kerberos –∫–∞–∫ –≤–µ–∫—Ç–æ—Ä –ø—Ä–æ–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏—è, —á—Ç–æ –ø–æ–¥—á–µ—Ä–∫–∏–≤–∞–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –≤–Ω–µ–¥—Ä–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è —Ç–∞–∫–∏—Ö —É–≥—Ä–æ–∑.

–≠—Ç–∏ –¥–∞–Ω–Ω—ã–µ –ø–æ—Å–ª—É–∂–∞—Ç –æ—Å–Ω–æ–≤–æ–π –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∏—Ö –º–æ–¥–µ–ª–µ–π –∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è, —Å–ø–æ—Å–æ–±–Ω–æ–≥–æ –≤—ã—è–≤–ª—è—Ç—å –∞—Ç–∞–∫–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∞–Ω–æ–º–∞–ª—å–Ω–æ–≥–æ –ø–æ–≤–µ–¥–µ–Ω–∏—è Kerberos-—Å–µ—Å—Å–∏–π.

---
---

# üìò –ì–ª–∞–≤–∞ 3. –ê–Ω–∞–ª–∏–∑ –∞—Ç–∞–∫ –∏ –≤—ã—è–≤–ª–µ–Ω–∏–µ –∞–Ω–æ–º–∞–ª–∏–π

## 3.1. –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ –ø–æ–≤–µ–¥–µ–Ω–∏—è –≤ Kerberos-—Å–µ—Å—Å–∏—è—Ö

–î–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∞—Ç–∞–∫ –Ω–∞ –ø—Ä–æ—Ç–æ–∫–æ–ª Kerberos –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ–Ω–∏–º–∞—Ç—å, –∫–∞–∫ –≤—ã–≥–ª—è–¥–∏—Ç **–Ω–æ—Ä–º–∞–ª—å–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ —Å–µ—Ä–≤–∏—Å–æ–≤** –≤ –¥–æ–º–µ–Ω–Ω–æ–π —Å—Ä–µ–¥–µ Active Directory. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–æ–∑–¥–∞—Ç—å **–±–∞–∑–æ–≤—ã–µ –º–æ–¥–µ–ª–∏ –ø–æ–≤–µ–¥–µ–Ω–∏—è (baseline)**, –ø–æ –∫–æ—Ç–æ—Ä—ã–º –º–æ–∂–Ω–æ —Å—Ä–∞–≤–Ω–∏–≤–∞—Ç—å —Ç–µ–∫—É—â—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∏ –≤—ã—è–≤–ª—è—Ç—å –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è.

### 3.1.1. –û–±—ã—á–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è Kerberos:

#### a) –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –≤—Ö–æ–¥:
- –ü—Ä–∏ –≤—Ö–æ–¥–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ —Å–∏—Å—Ç–µ–º—É –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç—Å—è **TGT (Ticket Granting Ticket)**.
- –ó–∞—Ç–µ–º –∑–∞–ø—Ä–∞—à–∏–≤–∞—é—Ç—Å—è **TGS (Ticket Granting Service tickets)** –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ —Ä–µ—Å—É—Ä—Å–∞–º: —Ñ–∞–π–ª–æ–≤—ã–º —Å–µ—Ä–≤–µ—Ä–∞–º, –ø–æ—á—Ç–æ–≤—ã–º —Å–µ—Ä–≤–∏—Å–∞–º –∏ —Ç.–¥.
- –î–æ—Å—Ç—É–ø –∫ —Ä–µ—Å—É—Ä—Å–∞–º –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ **AP-REQ / AP-REP** —Å–æ–æ–±—â–µ–Ω–∏—è.

#### b) –°–µ—Ä–≤–∏—Å–Ω–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ:
- –°–µ—Ä–≤–∏—Å—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Å–≤–æ–∏ —É—á–µ—Ç–Ω—ã–µ –∑–∞–ø–∏—Å–∏ –∏ SPN (Service Principal Name).
- –û–Ω–∏ –º–æ–≥—É—Ç –∑–∞–ø—Ä–∞—à–∏–≤–∞—Ç—å –±–∏–ª–µ—Ç—ã –Ω–∞ –¥—Ä—É–≥–∏–µ —Å–µ—Ä–≤–∏—Å—ã (–¥–µ–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ).

#### c) –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∏–ª–µ—Ç–æ–≤:
- –ë–∏–ª–µ—Ç—ã –∏–º–µ—é—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–µ –≤—Ä–µ–º—è –∂–∏–∑–Ω–∏ (–æ–±—ã—á–Ω–æ –¥–æ 10 —á–∞—Å–æ–≤).
- –ü–µ—Ä–µ–¥ –∏—Å—Ç–µ—á–µ–Ω–∏–µ–º —Å—Ä–æ–∫–∞ –¥–µ–π—Å—Ç–≤–∏—è –æ–Ω–∏ –º–æ–≥—É—Ç –±—ã—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω—ã –±–µ–∑ –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏.

### 3.1.2. –¢–∏–ø–∏—á–Ω—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ Kerberos:

| –ú–µ—Ç—Ä–∏–∫–∞ | –ù–æ—Ä–º–∞–ª—å–Ω—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω |
|--------|---------------------|
| –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ TGT –∑–∞ –¥–µ–Ω—å | 1‚Äì3 –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |
| –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ TGS –∑–∞ –¥–µ–Ω—å | 5‚Äì20 –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |
| –°—Ä–µ–¥–Ω–µ–µ TTL –±–∏–ª–µ—Ç–∞ | 6‚Äì10 —á–∞—Å–æ–≤ |
| –ß–∞—Å—Ç–æ—Ç–∞ –æ–±—Ä–∞—â–µ–Ω–∏–π –∫ KDC | –†–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤ —Ç–µ—á–µ–Ω–∏–µ —Ä–∞–±–æ—á–µ–≥–æ –¥–Ω—è |
| –û—à–∏–±–∫–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (ID 4771) | 0‚Äì2 –ø–æ–ø—ã—Ç–∫–∏ –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |

### 3.1.3. –ü—Ä–æ—Ñ–∏–ª–∏ –ø–æ–≤–µ–¥–µ–Ω–∏—è:

#### a) –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –ø—Ä–æ—Ñ–∏–ª—å:
- –í—Ä–µ–º—è –≤—Ö–æ–¥–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —É—Ç—Ä–æ, –±—É–¥–Ω–∏–µ –¥–Ω–∏).
- –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ SPN: –Ω–∞–ø—Ä–∏–º–µ—Ä, CIFS/fileserver, HTTP/webapp.
- –ì–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–µ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ (IP-–∞–¥—Ä–µ—Å, –ª–æ–≥–∏—á–µ—Å–∫–∞—è –∑–æ–Ω–∞ —Å–µ—Ç–∏).

#### b) –°–µ—Ä–≤–∏—Å–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å:
- –†–µ–≥—É–ª—è—Ä–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∫ –¥—Ä—É–≥–∏–º —Å–µ—Ä–≤–∏—Å–∞–º.
- –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –Ω–æ—á—å—é ‚Äî –±—ç–∫–∞–ø—ã, –∑–∞–¥–∞–Ω–∏—è –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞).
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö SPN.

#### c) –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—Å–∫–∏–π –ø—Ä–æ—Ñ–∏–ª—å:
- –î–æ—Å—Ç—É–ø –∫ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–º —Ä–µ—Å—É—Ä—Å–∞–º (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –¥–æ–º–µ–Ω–∞, SQL-—Å–µ—Ä–≤–µ—Ä).
- –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ GPO, –∏–∑–º–µ–Ω–µ–Ω–∏–µ –ø–æ–ª–∏—Ç–∏–∫ Kerberos).

---

## 3.2. –ü—Ä–∏–∑–Ω–∞–∫–∏ –∞—Ç–∞–∫ –Ω–∞ –ø—Ä–æ—Ç–æ–∫–æ–ª Kerberos

–ù–µ–∫–æ—Ç–æ—Ä—ã–µ –∏–∑ –Ω–∞–∏–±–æ–ª–µ–µ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—ë–Ω–Ω—ã—Ö –∞—Ç–∞–∫ –Ω–∞ –ø—Ä–æ—Ç–æ–∫–æ–ª Kerberos –æ—Å—Ç–∞–≤–ª—è—é—Ç —Ö–∞—Ä–∞–∫—Ç–µ—Ä–Ω—ã–µ —Å–ª–µ–¥—ã –≤ —Å–µ—Ç–µ–≤–æ–º —Ç—Ä–∞—Ñ–∏–∫–µ –∏ –ª–æ–≥–∞—Ö —Å–æ–±—ã—Ç–∏–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ Windows. –≠—Ç–∏ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –º–æ–≥—É—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è —É–≥—Ä–æ–∑.

### 3.2.1. Golden Ticket

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–¥–¥–µ–ª—å–Ω–æ–≥–æ TGT –≤–Ω–µ —Å–∏—Å—Ç–µ–º—ã, –∏—Å–ø–æ–ª—å–∑—É—è —Ö—ç—à —É—á–µ—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏ krbtgt.
- **–¶–µ–ª—å**: –ü–æ–ª—É—á–µ–Ω–∏–µ –Ω–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫–æ –≤—Å–µ–º —Ä–µ—Å—É—Ä—Å–∞–º –¥–æ–º–µ–Ω–∞.
- **–ü—Ä–∏–∑–Ω–∞–∫–∏:**
  - –î–ª–∏—Ç–µ–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –∂–∏–∑–Ω–∏ –±–∏–ª–µ—Ç–∞ (–¥–æ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –¥–Ω–µ–π).
  - –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–≥–æ —Å–æ–±—ã—Ç–∏—è –≤—Ö–æ–¥–∞ –≤ —Å–∏—Å—Ç–µ–º—É.
  - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–ª–∏ –≥—Ä—É–ø–ø—ã.
- **–õ–æ–≥–∏ Windows (Event ID):** 4768, 4769, 4624 (–ø—Ä–∏ –≤—Ö–æ–¥–µ).

### 3.2.2. Silver Ticket

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –ü–æ–¥–¥–µ–ª–∫–∞ TGS-–±–∏–ª–µ—Ç–∞ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ö—ç—à–∞ –µ–≥–æ —É—á–µ—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏.
- **–¶–µ–ª—å**: –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞ –∫ –æ–¥–Ω–æ–º—É —Å–µ—Ä–≤–∏—Å—É –±–µ–∑ –æ–±—Ä–∞—â–µ–Ω–∏—è –∫ KDC.
- **–ü—Ä–∏–∑–Ω–∞–∫–∏:**
  - –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä–µ–¥—à–µ—Å—Ç–≤—É—é—â–µ–≥–æ TGT.
  - –ó–∞–ø—Ä–æ—Å—ã –∫ –Ω–µ–æ–±—ã—á–Ω—ã–º SPN.
  - –ü–æ–ø—ã—Ç–∫–∏ –¥–æ—Å—Ç—É–ø–∞ –∫ —Å–µ—Ä–≤–∏—Å–∞–º –±–µ–∑ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è –ø–æ–ª–Ω–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏.
- **–õ–æ–≥–∏ Windows (Event ID):** 4769, 4624, 4625.

### 3.2.3. Kerberoasting

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –ó–∞–ø—Ä–æ—Å TGS –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö SPN —Å –ø–æ—Å–ª–µ–¥—É—é—â–∏–º –æ—Ñ—Ñ–ª–∞–π–Ω-–ø–µ—Ä–µ–±–æ—Ä–æ–º —Ö—ç—à–µ–π.
- **–¶–µ–ª—å**: –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π –æ—Ç —É—á–µ—Ç–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π —Å–µ—Ä–≤–∏—Å–æ–≤.
- **–ü—Ä–∏–∑–Ω–∞–∫–∏:**
  - –ú–Ω–æ–∂–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ TGS –∫ —Ä–∞–∑–Ω—ã–º SPN.
  - –ó–∞–ø—Ä–æ—Å—ã –∫ SPN, —Å–≤—è–∑–∞–Ω–Ω—ã–º —Å —É—á–µ—Ç–Ω—ã–º–∏ –∑–∞–ø–∏—Å—è–º–∏ —Å–µ—Ä–≤–∏—Å–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, MSSQLSvc, HTTP).
  - –í—ã—Å–æ–∫–∞—è —á–∞—Å—Ç–æ—Ç–∞ —Ç–∞–∫–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –∫–æ—Ä–æ—Ç–∫–∏–π –ø—Ä–æ–º–µ–∂—É—Ç–æ–∫ –≤—Ä–µ–º–µ–Ω–∏.
- **–õ–æ–≥–∏ Windows (Event ID):** 4769.

### 3.2.4. AS-REP Roasting

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –ü–æ–ª—É—á–µ–Ω–∏–µ —á–∞—Å—Ç–∏ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞ AS-REP –±–µ–∑ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏.
- **–£—Å–ª–æ–≤–∏–µ**: –í—ã–∫–ª—é—á–µ–Ω–Ω–∞—è pre-authentication.
- **–ü—Ä–∏–∑–Ω–∞–∫–∏:**
  - –ú–Ω–æ–∂–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ AS-REQ –±–µ–∑ –ø–æ—Å–ª–µ–¥—É—é—â–µ–≥–æ –æ—Ç–≤–µ—Ç–∞ –∫–ª–∏–µ–Ω—Ç–∞.
  - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –≤—ã–∫–ª—é—á–µ–Ω–Ω–æ–π pre-authentication.
- **–õ–æ–≥–∏ Windows (Event ID):** 4771 (–æ—à–∏–±–∫–∞ "KDC_ERR_PREAUTH_REQUIRED" –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç).

### 3.2.5. Pass-the-Ticket

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —É–∫—Ä–∞–¥–µ–Ω–Ω–æ–≥–æ –±–∏–ª–µ—Ç–∞ –±–µ–∑ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏.
- **–ü—Ä–∏–∑–Ω–∞–∫–∏:**
  - –ü–æ–≤—Ç–æ—Ä–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –æ–¥–Ω–æ–≥–æ –∏ —Ç–æ–≥–æ –∂–µ –±–∏–ª–µ—Ç–∞.
  - –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∏–∑ —Ä–∞–∑–Ω—ã—Ö —Ö–æ—Å—Ç–æ–≤ —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º –±–∏–ª–µ—Ç–æ–º.
  - –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Å–æ–±—ã—Ç–∏–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –¥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –±–∏–ª–µ—Ç–∞.
- **–õ–æ–≥–∏ Windows (Event ID):** 4624, 4672.

### 3.2.6. Brute-force —á–µ—Ä–µ–∑ Kerberos

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –ü–µ—Ä–µ–±–æ—Ä –ø–∞—Ä–æ–ª–µ–π –ø—É—Ç—ë–º –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏.
- **–ü—Ä–∏–∑–Ω–∞–∫–∏:**
  - –°–µ—Ä–∏—è —Å–æ–±—ã—Ç–∏–π 4771 —Å –æ—à–∏–±–∫–æ–π "bad password".
  - –ü–æ–≤—Ç–æ—Ä–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏ –≤—Ö–æ–¥–∞ –æ—Ç –æ–¥–Ω–æ–≥–æ IP-–∞–¥—Ä–µ—Å–∞ –∏–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
  - –í—ã—Å–æ–∫–∞—è —á–∞—Å—Ç–æ—Ç–∞ –∑–∞–ø—Ä–æ—Å–æ–≤ AS-REQ.
- **–õ–æ–≥–∏ Windows (Event ID):** 4771.

---

## 3.3. –ú–µ—Ç–æ–¥—ã –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∞—Ç–∞–∫

–î–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Å–µ—Ç–µ–≤–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞ –∏ –≤—ã—è–≤–ª–µ–Ω–∏—è –∞—Ç–∞–∫ –Ω–∞ –ø—Ä–æ—Ç–æ–∫–æ–ª Kerberos –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è —Ä–∞–∑–ª–∏—á–Ω—ã–µ –º–µ—Ç–æ–¥—ã, –≤ —Ç–æ–º —á–∏—Å–ª–µ —Å–∏–≥–Ω–∞—Ç—É—Ä–Ω—ã–π –∏ –ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑. –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —ç—Ç–∏—Ö –ø–æ–¥—Ö–æ–¥–æ–≤ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–≤—ã—Å–∏—Ç—å —Ç–æ—á–Ω–æ—Å—Ç—å –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∏ —Å–Ω–∏–∑–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π.

### 3.3.1. –°–∏–≥–Ω–∞—Ç—É—Ä–Ω—ã–π –∞–Ω–∞–ª–∏–∑

–°–∏–≥–Ω–∞—Ç—É—Ä–Ω—ã–π –º–µ—Ç–æ–¥ –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Å—Ä–∞–≤–Ω–µ–Ω–∏–∏ —Ç–µ–∫—É—â–∏—Ö —Å–æ–±—ã—Ç–∏–π —Å –∑–∞—Ä–∞–Ω–µ–µ –∏–∑–≤–µ—Å—Ç–Ω—ã–º–∏ —à–∞–±–ª–æ–Ω–∞–º–∏ –∞—Ç–∞–∫.

#### –ü—Ä–∏–º–µ—Ä—ã —Å–∏–≥–Ω–∞—Ç—É—Ä:

- **Golden Ticket**: TTL –±–∏–ª–µ—Ç–∞ > 24 —á–∞—Å–∞ + –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ krbtgt.
- **Kerberoasting**: –±–æ–ª–µ–µ 20 TGS-–∑–∞–ø—Ä–æ—Å–æ–≤ –∑–∞ –º–∏–Ω—É—Ç—É.
- **AS-REP Roasting**: AS-REQ –±–µ–∑ –ø–æ—Å–ª–µ–¥—É—é—â–µ–≥–æ AS-REP.

#### –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:
- Sigma rules
- Snort / Suricata –ø—Ä–∞–≤–∏–ª–∞
- YARA –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è —Ç—Ä–∞—Ñ–∏–∫–∞

### 3.3.2. –ü–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑

–ü–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∏–π –º–µ—Ç–æ–¥ –æ—Å–Ω–æ–≤–∞–Ω –Ω–∞ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–∏ –º–æ–¥–µ–ª–µ–π –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ –ø–æ–≤–µ–¥–µ–Ω–∏—è –∏ –≤—ã—è–≤–ª–µ–Ω–∏–∏ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–π –æ—Ç –Ω–∏—Ö.

#### –ü–æ–¥—Ö–æ–¥—ã:
- **–°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑**: —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —á–∞—Å—Ç–æ—Ç—ã —Å–æ–±—ã—Ç–∏–π —Å –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏.
- **–ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–π –∞–Ω–∞–ª–∏–∑**: —É—á—ë—Ç –≤—Ä–µ–º–µ–Ω–∏, –≥–µ–æ–≥—Ä–∞—Ñ–∏–∏, —Ç–∏–ø–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞, —Ä–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
- **–ú–µ–∂—Å–µ—Ç–µ–≤–æ–π –∞–Ω–∞–ª–∏–∑**: –≤—ã—è–≤–ª–µ–Ω–∏–µ –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–π –º–µ–∂–¥—É —ç—Ç–∞–ø–∞–º–∏ Kerberos-—Å–µ—Å—Å–∏–∏.

#### –ü—Ä–∏–º–µ—Ä—ã –ø—Ä–∞–≤–∏–ª:
- –ù–µ–æ–±—ã—á–Ω–æ –≤—ã—Å–æ–∫–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ TGS-–±–∏–ª–µ—Ç–æ–≤ –¥–ª—è –æ–±—ã—á–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ TGS –±–µ–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ TGT.
- –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å Kerberos –≤–Ω–µ —Ä–∞–±–æ—á–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏.

### 3.3.3. –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è

–ú–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ –º–æ–∂–µ—Ç –ø—Ä–∏–º–µ–Ω—è—Ç—å—Å—è –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è —Å–ª–æ–∂–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π –ø–æ–≤–µ–¥–µ–Ω–∏—è –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∞–Ω–æ–º–∞–ª–∏–π.

#### –ü–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã:
- **Isolation Forest** ‚Äî –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –≤—ã–±—Ä–æ—Å–æ–≤.
- **Autoencoder** ‚Äî –¥–ª—è –≤—ã—è–≤–ª–µ–Ω–∏—è –Ω–µ—Ö–∞—Ä–∞–∫—Ç–µ—Ä–Ω—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤.
- **LSTM** ‚Äî –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π Kerberos-—Å–æ–±—ã—Ç–∏–π.

#### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –Ω–æ–≤—ã—Ö, —Ä–∞–Ω–µ–µ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –∞—Ç–∞–∫.
- –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –º–æ–¥–µ–ª–µ–π –ø–æ–≤–µ–¥–µ–Ω–∏—è.
- –£—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫ –∏–∑–º–µ–Ω–µ–Ω–∏—é –ø–æ–≤–µ–¥–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º.

#### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:
- –¢—Ä–µ–±—É–µ—Ç—Å—è –±–æ–ª—å—à–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ–±—É—á–µ–Ω–∏—è.
- –°–ª–æ–∂–Ω–æ—Å—Ç—å –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤.
- –í—ã—Å–æ–∫–∏–µ –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è.

---

## 3.4. –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã —Å–æ–±—ã—Ç–∏–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ Windows

–í –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –∫ —Å–µ—Ç–µ–≤–æ–º—É —Ç—Ä–∞—Ñ–∏–∫—É, –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∞—Ç–∞–∫ –Ω–∞ Kerberos –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∂—É—Ä–Ω–∞–ª—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ Windows, –≥–¥–µ —Ñ–∏–∫—Å–∏—Ä—É—é—Ç—Å—è –∫–ª—é—á–µ–≤—ã–µ —Å–æ–±—ã—Ç–∏—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏.

| Event ID | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|-----------|
| **4768** | –ó–∞–ø—Ä–æ—Å TGT (Authentication Service Request) |
| **4769** | –ó–∞–ø—Ä–æ—Å TGS (Ticket Granting Service Request) |
| **4771** | –û—à–∏–±–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ Kerberos (–Ω–∞–ø—Ä–∏–º–µ—Ä, –Ω–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å) |
| **4672** | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π –ø—Ä–∏ –≤—Ö–æ–¥–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |
| **4624** | –£—Å–ø–µ—à–Ω—ã–π –≤—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É |
| **4625** | –ù–µ—É–¥–∞—á–Ω–∞—è –ø–æ–ø—ã—Ç–∫–∞ –≤—Ö–æ–¥–∞ |

–≠—Ç–∏ —Å–æ–±—ã—Ç–∏—è –ø–æ–∑–≤–æ–ª—è—é—Ç —Å—Ç—Ä–æ–∏—Ç—å –º–æ–¥–µ–ª—å –ø–æ–≤–µ–¥–µ–Ω–∏—è –∏ –≤—ã—è–≤–ª—è—Ç—å –∞–Ω–æ–º–∞–ª—å–Ω—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –¥–∞–∂–µ –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞ —Å–µ—Ç–µ–≤–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞.

---

## 3.5. –ó–∞–∫–ª—é—á–µ–Ω–∏–µ –ø–æ –≥–ª–∞–≤–µ

–í –¥–∞–Ω–Ω–æ–π –≥–ª–∞–≤–µ –±—ã–ª–∏ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω—ã –º–æ–¥–µ–ª–∏ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ –ø–æ–≤–µ–¥–µ–Ω–∏—è Kerberos-—Å–µ—Å—Å–∏–π, –∞ —Ç–∞–∫–∂–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –Ω–∞–∏–±–æ–ª–µ–µ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—ë–Ω–Ω—ã—Ö –∞—Ç–∞–∫ –Ω–∞ –ø—Ä–æ—Ç–æ–∫–æ–ª Kerberos. –ë—ã–ª–æ –ø–æ–∫–∞–∑–∞–Ω–æ, —á—Ç–æ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∞—Ç–∞–∫ –æ—Å—Ç–∞–≤–ª—è—é—Ç —Ö–∞—Ä–∞–∫—Ç–µ—Ä–Ω—ã–µ —Å–ª–µ–¥—ã –≤ —Å–µ—Ç–µ–≤–æ–º —Ç—Ä–∞—Ñ–∏–∫–µ –∏ –ª–æ–≥–∞—Ö –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–∏—Å—Ç–µ–º—ã –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –∞–Ω–∞–ª–∏–∑–∞ –∞–Ω–æ–º–∞–ª–∏–π.

–ë—ã–ª–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã —Ç—Ä–∏ –æ—Å–Ω–æ–≤–Ω—ã—Ö –º–µ—Ç–æ–¥–∞ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è: —Å–∏–≥–Ω–∞—Ç—É—Ä–Ω—ã–π, –ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∏–π –∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è. –ù–∞ –æ—Å–Ω–æ–≤–µ —ç—Ç–æ–≥–æ –º–∞—Ç–µ—Ä–∏–∞–ª–∞ –±—ã–ª–∞ —Å–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∞ –∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞, —Å–ø–æ—Å–æ–±–Ω–∞—è –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å–µ—Ç–µ–≤–æ–π —Ç—Ä–∞—Ñ–∏–∫ Active Directory –∏ –≤—ã—è–≤–ª—è—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–∏ –∞—Ç–∞–∫ –Ω–∞ –ø—Ä–æ—Ç–æ–∫–æ–ª Kerberos.

---

# üìò –ì–ª–∞–≤–∞ 4. –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è

## 4.1. –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Ä–∞–∑—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º–æ–º—É –ü–û

### 4.1.1. –û–±—â–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

–î–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è —Ü–µ–ª–∏ ‚Äî **—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è, –≤—ã—è–≤–ª—è—é—â–µ–≥–æ –∞—Ç–∞–∫–∏ –Ω–∞ –ø—Ä–æ—Ç–æ–∫–æ–ª Kerberos —á–µ—Ä–µ–∑ –∞–Ω–∞–ª–∏–∑ –∞–Ω–æ–º–∞–ª–∏–π –≤ —Å–µ—Ç–µ–≤–æ–º —Ç—Ä–∞—Ñ–∏–∫–µ Active Directory**, ‚Äî –±—ã–ª–∏ —Å—Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ –æ–±—â–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è:

- –ü—Ä–æ–≥—Ä–∞–º–º–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å **–∞–≤—Ç–æ–Ω–æ–º–Ω–æ–π**, –Ω–µ —Ç—Ä–µ–±—É—é—â–µ–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π.
- –î–æ–ª–∂–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å **–º–Ω–æ–∂–µ—Å—Ç–≤–æ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö**: —Å–µ—Ç–µ–≤–æ–π —Ç—Ä–∞—Ñ–∏–∫ (PCAP), –ª–æ–≥–∏ Windows Event Logs –∏ –ø–æ—Ç–æ–∫–æ–≤–æ–µ –Ω–∞–±–ª—é–¥–µ–Ω–∏–µ –∑–∞ —Å–µ—Ç—å—é.
- –ü—Ä–æ–≥—Ä–∞–º–º–∞ –¥–æ–ª–∂–Ω–∞ **–æ–±–Ω–∞—Ä—É–∂–∏–≤–∞—Ç—å –∏–∑–≤–µ—Å—Ç–Ω—ã–µ –∞—Ç–∞–∫–∏** –Ω–∞ Kerberos: Golden Ticket, Silver Ticket, Kerberoasting, AS-REP Roasting, Pass-the-Ticket.
- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞ –¥–æ–ª–∂–Ω—ã –≤—ã–≤–æ–¥–∏—Ç—å—Å—è –≤ —É–¥–æ–±–æ—á–∏—Ç–∞–µ–º–æ–º —Ñ–æ—Ä–º–∞—Ç–µ: CLI, JSON –∏–ª–∏ CSV.
- –ü—Ä–æ–≥—Ä–∞–º–º–∞ –¥–æ–ª–∂–Ω–∞ –∏–º–µ—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å —Å–∏—Å—Ç–µ–º–∞–º–∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (SIEM) —á–µ—Ä–µ–∑ Syslog, Slack –∏–ª–∏ Email.

### 4.1.2. –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

| ‚Ññ | –§—É–Ω–∫—Ü–∏—è | –û–ø–∏—Å–∞–Ω–∏–µ |
|----|--------|----------|
| 1 | –°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –∏–∑ PCAP-—Ñ–∞–π–ª–æ–≤ | –ß—Ç–µ–Ω–∏–µ –ø–∞–∫–µ—Ç–æ–≤ –∏ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π Kerberos |
| 2 | –ó–∞—Ö–≤–∞—Ç —Ç—Ä–∞—Ñ–∏–∫–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ | –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å live capture —Å –ø–æ–º–æ—â—å—é tcpdump/tshark |
| 3 | –ü–∞—Ä—Å–∏–Ω–≥ Kerberos-—Å–æ–æ–±—â–µ–Ω–∏–π | –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –±–∏–ª–µ—Ç–æ–≤ (TGT/TGS), SPN, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π |
| 4 | –ß—Ç–µ–Ω–∏–µ –ª–æ–≥–æ–≤ Windows | –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —á—Ç–µ–Ω–∏—è EVT/ETW-—Ñ–∞–π–ª–æ–≤ —Å —Å–æ–±—ã—Ç–∏—è–º–∏ Kerberos (ID 4768, 4769, 4771) |
| 5 | –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∞—Ç–∞–∫ | –ê–Ω–∞–ª–∏–∑ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–π –æ—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ –ø–æ–≤–µ–¥–µ–Ω–∏—è –∏ —Å–∏–≥–Ω–∞—Ç—É—Ä |
| 6 | –í—ã–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ | –¶–≤–µ—Ç–æ–≤–∞—è –∏–Ω–¥–∏–∫–∞—Ü–∏—è —É—Ä–æ–≤–Ω—è —Ä–∏—Å–∫–∞, —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ —Ñ–∞–π–ª |
| 7 | –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –≤–Ω–µ—à–Ω–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏ | –û—Ç–ø—Ä–∞–≤–∫–∞ –∞–ª–µ—Ä—Ç–æ–≤ —á–µ—Ä–µ–∑ Syslog, Email –∏–ª–∏ API |

### 4.1.3. –ù–µ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ |
|-----------|------------|
| –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å | –†–∞–±–æ—Ç–∞ –Ω–∞ Windows –∏ Linux |
| –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å | –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç—Ä–∞—Ñ–∏–∫–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ –∏–ª–∏ –±–ª–∏–∑–∫–æ–º –∫ –Ω–µ–º—É |
| –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å | –ù–∏–∫–∞–∫–∞—è –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –Ω–µ –¥–æ–ª–∂–Ω–∞ –∑–∞–ø–∏—Å—ã–≤–∞—Ç—å—Å—è –±–µ–∑ —Å–æ–≥–ª–∞—Å–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |
| –£–¥–æ–±—Å—Ç–≤–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è | CLI-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å –ø–æ–Ω—è—Ç–Ω—ã–º –≤—ã–≤–æ–¥–æ–º |
| –†–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å | –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö –ø—Ä–∞–≤–∏–ª –∞–Ω–∞–ª–∏–∑–∞ –∏ —Ç–∏–ø–æ–≤ –∞—Ç–∞–∫ |
| –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ—Å—Ç—å | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –≤ –∫–æ–¥–µ, README, –ø—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è |

---

## 4.2. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã

–†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–Ω–æ–µ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–µ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–µ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É—é—â–∏—Ö –º–æ–¥—É–ª–µ–π, –∫–∞–∂–¥—ã–π –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Å–≤–æ—é —Ñ—É–Ω–∫—Ü–∏—é –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ —Å–±–æ—Ä–∞, –∞–Ω–∞–ª–∏–∑–∞ –∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∞–Ω–æ–º–∞–ª–∏–π –≤ Kerberos-—Ç—Ä–∞—Ñ–∏–∫–µ.

### 4.2.1. –ú–æ–¥—É–ª—å —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

–≠—Ç–æ—Ç –º–æ–¥—É–ª—å –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –ø–æ–ª—É—á–µ–Ω–∏–µ –∏—Å—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞.

#### –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:
- –ß—Ç–µ–Ω–∏–µ PCAP-—Ñ–∞–π–ª–æ–≤.
- –ó–∞—Ö–≤–∞—Ç —Ç—Ä–∞—Ñ–∏–∫–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏.
- –ß—Ç–µ–Ω–∏–µ Windows Event Logs (EVTX).
- –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ —Å–æ–±—ã—Ç–∏–π –ø–æ IP, –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –≤—Ä–µ–º–µ–Ω–∏.

#### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `scapy` –∏ `pyshark` –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ –ø–∞–∫–µ—Ç–æ–≤.
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `Evtx` –¥–ª—è —á—Ç–µ–Ω–∏—è –∂—É—Ä–Ω–∞–ª–æ–≤ Windows.
- –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–æ—Ä—Ç–∞ 88 (Kerberos).

### 4.2.2. –ú–æ–¥—É–ª—å –ø–∞—Ä—Å–∏–Ω–≥–∞ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏

–≠—Ç–æ—Ç –º–æ–¥—É–ª—å –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –æ–±—Ä–∞–±–æ—Ç–∫—É —Å—ã—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏ –≤—ã–¥–µ–ª–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ —Ç–µ—Ö —Å–æ–±—ã—Ç–∏–π, –∫–æ—Ç–æ—Ä—ã–µ —Å–≤—è–∑–∞–Ω—ã —Å –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–º Kerberos.

#### –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:
- –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ ASN.1 —Å—Ç—Ä—É–∫—Ç—É—Ä –∏–∑ –ø–∞–∫–µ—Ç–æ–≤.
- –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, SPN, —Ç–∏–ø–∞ –∑–∞–ø—Ä–æ—Å–∞, TTL –±–∏–ª–µ—Ç–∞.
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –Ω–µ—Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞.

#### –ü—Ä–∏–º–µ—Ä –ø–∞—Ä—Å–∏–Ω–≥–∞ Kerberos-–∑–∞–ø—Ä–æ—Å–∞:
```python
from scapy.all import *
from scapy.layers.kerberos import Kerberos

def extract_kerberos_data(pkt):
    if pkt.haslayer(Kerberos):
        kerb_layer = pkt[Kerberos]
        return {
            'type': kerb_layer.type,
            'user': kerb_layer.cname,
            'spn': kerb_layer.sname,
            'till': kerb_layer.till,
            'timestamp': pkt.time
        }
```

### 4.2.3. –ú–æ–¥—É–ª—å –∞–Ω–∞–ª–∏–∑–∞ –∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∞–Ω–æ–º–∞–ª–∏–π

–≠—Ç–æ—Ç –º–æ–¥—É–ª—å —Ä–µ–∞–ª–∏–∑—É–µ—Ç –∞–ª–≥–æ—Ä–∏—Ç–º—ã –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∞—Ç–∞–∫.

#### –ú–µ—Ç–æ–¥—ã –∞–Ω–∞–ª–∏–∑–∞:
- **–°–∏–≥–Ω–∞—Ç—É—Ä–Ω—ã–π –∞–Ω–∞–ª–∏–∑:** —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –∏–∑–≤–µ—Å—Ç–Ω—ã–º–∏ —à–∞–±–ª–æ–Ω–∞–º–∏ –∞—Ç–∞–∫.
- **–ü–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑:** —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ç–µ–∫—É—â–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π —Å –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏.
- **–ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–π –∞–Ω–∞–ª–∏–∑:** –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è –º–µ–∂–¥—É —ç—Ç–∞–ø–∞–º–∏ Kerberos-—Å–µ—Å—Å–∏–∏.

#### –ü—Ä–∏–º–µ—Ä –ø—Ä–∞–≤–∏–ª–∞ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è Golden Ticket:
```python
def detect_golden_ticket(ticket):
    if ticket['lifetime'] > 86400 and ticket['user'] == 'krbtgt':
        return {
            'alert': 'Golden Ticket detected',
            'severity': 'high',
            'description': 'Ticket with long lifetime issued for krbtgt account'
        }
```

#### –ü—Ä–∏–º–µ—Ä –ø—Ä–∞–≤–∏–ª–∞ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è Kerberoasting:
```python
def detect_kerberoasting(tgs_requests):
    if len(tgs_requests) > 20 and tgs_requests[0]['time_diff'] < 5:
        return {
            'alert': 'Potential Kerberoasting detected',
            'severity': 'medium',
            'description': 'Multiple TGS requests to service accounts in a short time'
        }
```

### 4.2.4. –ú–æ–¥—É–ª—å –≤—ã–≤–æ–¥–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

–≠—Ç–æ—Ç –º–æ–¥—É–ª—å –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∞–Ω–∞–ª–∏–∑–∞.

#### –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:
- –¶–≤–µ—Ç–æ–≤–æ–π –≤—ã–≤–æ–¥ –≤ CLI.
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤ JSON/CSV.
- –û—Ç–ø—Ä–∞–≤–∫–∞ –∞–ª–µ—Ä—Ç–æ–≤ —á–µ—Ä–µ–∑ Syslog, Slack, Email.

#### –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞ –≤ –∫–æ–Ω—Å–æ–ª—å:
```python
from termcolor import colored

def display_alert(alert):
    color_map = {
        'low': 'green',
        'medium': 'yellow',
        'high': 'red'
    }
    print(colored(f"[!] {alert['description']}", color_map.get(alert['severity'], 'white')))
```

#### –ü—Ä–∏–º–µ—Ä —Ñ–æ—Ä–º–∞—Ç–∞ JSON:
```json
{
  "timestamp": "2025-04-05T10:34:22",
  "alert": "Golden Ticket detected",
  "severity": "high",
  "description": "Ticket with long lifetime issued for krbtgt account",
  "source_ip": "192.168.1.100"
}
```

---

## 4.3. –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –º–æ–¥—É–ª–µ–π

### 4.3.1. –ü–∞—Ä—Å–∏–Ω–≥ —Å–µ—Ç–µ–≤–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞

–î–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ —Å–µ—Ç–µ–≤–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å —Å–ª–µ–¥—É—é—â–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏:

- **Scapy**: –ø–æ–∑–≤–æ–ª—è–µ—Ç —á–∏—Ç–∞—Ç—å –∏ –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å–µ—Ç–µ–≤—ã–µ –ø–∞–∫–µ—Ç—ã, –≤ —Ç–æ–º —á–∏—Å–ª–µ —Å Kerberos-–∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏.
- **PyShark**: –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —É–¥–æ–±–Ω—ã–π API –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Wireshark-–ø–∞–∫–µ—Ç–∞–º–∏, –æ—Å–æ–±–µ–Ω–Ω–æ –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å ASN.1-—Å—Ç—Ä—É–∫—Ç—É—Ä–∞–º–∏.

#### –ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞:
```python
from scapy.all import *
from scapy.layers.kerberos import Kerberos

def parse_kerberos_packets(pcap_file):
    packets = rdpcap(pcap_file)
    for pkt in packets:
        if Kerberos in pkt:
            kerb_pkt = pkt[Kerberos]
            print(f"[+] Kerberos packet found: {kerb_pkt.show()}")
```

### 4.3.2. –ê–Ω–∞–ª–∏–∑ –∂—É—Ä–Ω–∞–ª–æ–≤ Windows

–î–ª—è —á—Ç–µ–Ω–∏—è —Å–æ–±—ã—Ç–∏–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ Windows –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è Python-–º–æ–¥—É–ª—å `Evtx`, –ø–æ–∑–≤–æ–ª—è—é—â–∏–π —Ä–∞–±–æ—Ç–∞—Ç—å —Å ETL/EVTX-—Ñ–∞–π–ª–∞–º–∏.

#### –ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞:
```python
import xml.etree.ElementTree as ET
import Evtx.Evtx as evtx

def read_event_logs(log_file):
    with evtx.Evtx(log_file) as log:
        for record in log.records():
            xml = ET.fromstring(record.xml())
            event_id = xml.find('.//EventID').text
            if event_id in ['4768', '4769', '4771']:
                yield parse_kerberos_event(xml)

def parse_kerberos_event(xml_data):
    # –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, SPN, –≤—Ä–µ–º–µ–Ω–∏ –∏ –¥—Ä—É–≥–∏—Ö –ø–æ–ª–µ–π
    return {
        'event_id': ...,
        'user': ...,
        'spn': ...,
        'timestamp': ...
    }
```

### 4.3.3. –ê–ª–≥–æ—Ä–∏—Ç–º—ã –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∞–Ω–æ–º–∞–ª–∏–π

–ë—ã–ª–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ –ø—Ä–∞–≤–∏–ª–∞ –∞–Ω–∞–ª–∏–∑–∞:

#### Golden Ticket:
```python
def detect_golden_ticket(ticket):
    if ticket['lifetime'] > 86400 and ticket['user'] == 'krbtgt':
        return "Golden Ticket detected"
```

#### Kerberoasting:
```python
def detect_kerberoasting(tgs_requests):
    if len(tgs_requests) > 20 and tgs_requests[0]['time_diff'] < 5:
        return "Potential Kerberoasting detected"
```

#### Silver Ticket:
```python
def detect_silver_ticket(session):
    if 'TGT' not in session and 'TGS' in session:
        return "Possible Silver Ticket detected"
```

### 4.3.4. –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –≤—ã–≤–æ–¥–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤—ã–≤–æ–¥–∏–ª–∏—Å—å –≤ –∫–æ–Ω—Å–æ–ª—å —Å —Ü–≤–µ—Ç–æ–≤–æ–π –∏–Ω–¥–∏–∫–∞—Ü–∏–µ–π:

```python
from termcolor import colored

def display_alert(alert):
    color_map = {
        'low': 'green',
        'medium': 'yellow',
        'high': 'red'
    }
    print(colored(f"[!] {alert['description']}", color_map.get(alert['severity'], 'white')))
```

–ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞:
```
[!] Potential Kerberoasting detected at 10:34:22 from 192.168.1.100
```

---

## 4.4. –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

### 4.4.1. –Ø–∑—ã–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è

- **Python 3.10+** ‚Äî –≤—ã–±—Ä–∞–Ω –∫–∞–∫ –æ—Å–Ω–æ–≤–Ω–æ–π —è–∑—ã–∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –±–ª–∞–≥–æ–¥–∞—Ä—è —à–∏—Ä–æ–∫–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–µ —Å–µ—Ç–µ–≤—ã—Ö –∏ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫.

### 4.4.2. –ë–∏–±–ª–∏–æ—Ç–µ–∫–∏ –∏ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∏

| –ù–∞–∑–≤–∞–Ω–∏–µ | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|---------|------------|
| Scapy | –ü–∞—Ä—Å–∏–Ω–≥ —Å–µ—Ç–µ–≤–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞ |
| PyShark | –î–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ Kerberos-—Å–æ–æ–±—â–µ–Ω–∏–π |
| Pandas | –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏ –∞–Ω–∞–ª–∏–∑ –ª–æ–≥–æ–≤ |
| NumPy | –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ |
| Evtx | –ß—Ç–µ–Ω–∏–µ Windows Event Logs |
| Termcolor | –¶–≤–µ—Ç–æ–≤–æ–µ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –≤—ã–≤–æ–¥–∞ |
| Argparse | –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ |
| Logging | –õ–æ–≥–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç—ã –ø—Ä–æ–≥—Ä–∞–º–º—ã |

### 4.4.3. –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∞–Ω–∞–ª–∏–∑–∞

| –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|-----------|------------|
| Wireshark | –ê–Ω–∞–ª–∏–∑ –∏ —ç–∫—Å–ø–æ—Ä—Ç PCAP-—Ñ–∞–π–ª–æ–≤ |
| Tcpdump | –ó–∞—Ö–≤–∞—Ç —Ç—Ä–∞—Ñ–∏–∫–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ |
| Event Viewer | –ß—Ç–µ–Ω–∏–µ –∏ —ç–∫—Å–ø–æ—Ä—Ç Windows Security Logs |
| Sigma | –°–æ–∑–¥–∞–Ω–∏–µ —Å–∏–≥–Ω–∞—Ç—É—Ä –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è |
| Jupyter Notebook | –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö –∏ –æ—Ç–ª–∞–¥–∫–∞ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ |

---

