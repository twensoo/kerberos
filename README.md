### kerberos


---

---

# ðŸ“˜ Ð“Ð»Ð°Ð²Ð° 1. Ð’Ð²ÐµÐ´ÐµÐ½Ð¸Ðµ

## 1.1. ÐÐºÑ‚ÑƒÐ°Ð»ÑŒÐ½Ð¾ÑÑ‚ÑŒ Ñ‚ÐµÐ¼Ñ‹

ÐŸÑ€Ð¾Ñ‚Ð¾ÐºÐ¾Ð» Kerberos ÑÐ²Ð»ÑÐµÑ‚ÑÑ Ð¾ÑÐ½Ð¾Ð²Ð½Ñ‹Ð¼ Ð¼ÐµÑ…Ð°Ð½Ð¸Ð·Ð¼Ð¾Ð¼ Ð°ÑƒÑ‚ÐµÐ½Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸Ð¸ Ð² Ð´Ð¾Ð¼ÐµÐ½Ð½Ñ‹Ñ… ÑÐµÑ‚ÑÑ… Microsoft Active Directory Ð¸ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ÑÑ Ð´Ð»Ñ Ð¾Ð±ÐµÑÐ¿ÐµÑ‡ÐµÐ½Ð¸Ñ Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾Ð³Ð¾ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð° Ðº Ñ€ÐµÑÑƒÑ€ÑÐ°Ð¼ ÐºÐ¾Ñ€Ð¿Ð¾Ñ€Ð°Ñ‚Ð¸Ð²Ð½Ð¾Ð¹ Ð¸Ð½Ñ„Ñ€Ð°ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ñ‹. ÐÐµÑÐ¼Ð¾Ñ‚Ñ€Ñ Ð½Ð° Ð²Ñ‹ÑÐ¾ÐºÑƒÑŽ ÑÑ‚ÐµÐ¿ÐµÐ½ÑŒ ÐºÑ€Ð¸Ð¿Ñ‚Ð¾Ð³Ñ€Ð°Ñ„Ð¸Ñ‡ÐµÑÐºÐ¾Ð¹ Ð·Ð°Ñ‰Ð¸Ñ‰Ñ‘Ð½Ð½Ð¾ÑÑ‚Ð¸, Ð¿Ñ€Ð¾Ñ‚Ð¾ÐºÐ¾Ð» Ð¿Ð¾Ð´Ð²ÐµÑ€Ð¶ÐµÐ½ Ñ€Ð°Ð·Ð»Ð¸Ñ‡Ð½Ñ‹Ð¼ Ñ‚Ð¸Ð¿Ð°Ð¼ Ð°Ñ‚Ð°Ðº, Ð¿Ð¾Ð·Ð²Ð¾Ð»ÑÑŽÑ‰Ð¸Ð¼ Ð·Ð»Ð¾ÑƒÐ¼Ñ‹ÑˆÐ»ÐµÐ½Ð½Ð¸ÐºÐ°Ð¼ Ð¾Ð±Ñ…Ð¾Ð´Ð¸Ñ‚ÑŒ ÑÐ¸ÑÑ‚ÐµÐ¼Ñƒ Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚Ð¸ Ð±ÐµÐ· Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ñ ÑÐ²Ð½Ð¾ Ð²Ñ€ÐµÐ´Ð¾Ð½Ð¾ÑÐ½Ñ‹Ñ… Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ð¹.

Ð¢Ð°ÐºÐ¸Ðµ Ð°Ñ‚Ð°ÐºÐ¸, ÐºÐ°Ðº **Golden Ticket**, **Silver Ticket**, **Kerberoasting**, **AS-REP Roasting** Ð¸ **Pass-the-Ticket**, Ð²ÑÑ‘ Ñ‡Ð°Ñ‰Ðµ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÑŽÑ‚ÑÑ Ð¿Ñ€Ð¸ Ð¿Ñ€Ð¾Ð²ÐµÐ´ÐµÐ½Ð¸Ð¸ Ð¿ÐµÐ½Ñ‚ÐµÑÑ‚Ð¾Ð² Ð¸ ÑÐ»Ð¾Ð¶Ð½Ñ‹Ñ… APT-Ð°Ñ‚Ð°Ðº. ÐžÐ½Ð¸ Ð½Ðµ Ð¾ÑÑ‚Ð°Ð²Ð»ÑÑŽÑ‚ ÑÐ»ÐµÐ´Ð¾Ð² Ð² Ñ‚Ñ€Ð°Ð´Ð¸Ñ†Ð¸Ð¾Ð½Ð½Ñ‹Ñ… ÑÑ€ÐµÐ´ÑÑ‚Ð²Ð°Ñ… Ð·Ð°Ñ‰Ð¸Ñ‚Ñ‹, Ñ‚Ð°ÐºÐ¸Ñ… ÐºÐ°Ðº Ð°Ð½Ñ‚Ð¸Ð²Ð¸Ñ€ÑƒÑÑ‹ Ð¸Ð»Ð¸ Ñ„Ð°ÐµÑ€Ð²Ð¾Ð»Ñ‹, Ð¿Ð¾ÑÐºÐ¾Ð»ÑŒÐºÑƒ Ð¼Ð°ÑÐºÐ¸Ñ€ÑƒÑŽÑ‚ÑÑ Ð¿Ð¾Ð´ Ð½Ð¾Ñ€Ð¼Ð°Ð»ÑŒÐ½ÑƒÑŽ Ð°ÐºÑ‚Ð¸Ð²Ð½Ð¾ÑÑ‚ÑŒ ÑÐµÑ‚Ð¸ Ð¸ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÑŽÑ‚ Ð»ÐµÐ³Ð¸Ñ‚Ð¸Ð¼Ð½Ñ‹Ðµ Ð¿Ñ€Ð¾Ñ‚Ð¾ÐºÐ¾Ð»Ñ‹ Ð´Ð¾Ð¼ÐµÐ½Ð½Ð¾Ð¹ ÑÑ€ÐµÐ´Ñ‹.

Ð­Ñ‚Ð¾ Ð´ÐµÐ»Ð°ÐµÑ‚ Ð¾ÑÐ¾Ð±ÐµÐ½Ð½Ð¾ Ð²Ð°Ð¶Ð½Ñ‹Ð¼ Ñ€Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚ÐºÑƒ Ð¿Ñ€Ð¾Ð³Ñ€Ð°Ð¼Ð¼Ð½Ñ‹Ñ… Ñ€ÐµÑˆÐµÐ½Ð¸Ð¹, ÑÐ¿Ð¾ÑÐ¾Ð±Ð½Ñ‹Ñ… Ð°Ð½Ð°Ð»Ð¸Ð·Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ ÑÐµÑ‚ÐµÐ²Ð¾Ð¹ Ñ‚Ñ€Ð°Ñ„Ð¸Ðº Active Directory Ð¸ Ð²Ñ‹ÑÐ²Ð»ÑÑ‚ÑŒ Ð¿Ñ€Ð¸Ð·Ð½Ð°ÐºÐ¸ Ð°Ñ‚Ð°Ðº Ð½Ð° Ð¿Ñ€Ð¾Ñ‚Ð¾ÐºÐ¾Ð» Kerberos Ð½Ð° Ð¾ÑÐ½Ð¾Ð²Ðµ Ð°Ð½Ð¾Ð¼Ð°Ð»ÑŒÐ½Ð¾Ð³Ð¾ Ð¿Ð¾Ð²ÐµÐ´ÐµÐ½Ð¸Ñ. Ð¢Ð°ÐºÐ¸Ðµ ÑÐ¸ÑÑ‚ÐµÐ¼Ñ‹ Ð¿Ð¾Ð·Ð²Ð¾Ð»ÑÑ‚ Ð¿Ð¾Ð²Ñ‹ÑÐ¸Ñ‚ÑŒ ÑƒÑ€Ð¾Ð²ÐµÐ½ÑŒ Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚Ð¸ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ð¾Ð½Ð½Ñ‹Ñ… ÑÐ¸ÑÑ‚ÐµÐ¼ Ð¸ ÑÐ½Ð¸Ð·Ð¸Ñ‚ÑŒ Ñ€Ð¸ÑÐºÐ¸ ÐºÐ¾Ð¼Ð¿Ñ€Ð¾Ð¼ÐµÑ‚Ð°Ñ†Ð¸Ð¸ Ð´Ð¾Ð¼ÐµÐ½Ð½Ð¾Ð¹ ÑÑ€ÐµÐ´Ñ‹.

Ð¡ÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÑŽÑ‰Ð¸Ðµ Ð¿Ð¾Ð´Ñ…Ð¾Ð´Ñ‹ Ðº Ð¾Ð±Ð½Ð°Ñ€ÑƒÐ¶ÐµÐ½Ð¸ÑŽ Ð°Ñ‚Ð°Ðº Ð½Ð° Kerberos Ð²ÐºÐ»ÑŽÑ‡Ð°ÑŽÑ‚ ÑÐ¸Ð³Ð½Ð°Ñ‚ÑƒÑ€Ð½Ñ‹Ð¹ Ð°Ð½Ð°Ð»Ð¸Ð· (Ð¾ÑÐ½Ð¾Ð²Ð°Ð½Ð½Ñ‹Ð¹ Ð½Ð° Ð¸Ð·Ð²ÐµÑÑ‚Ð½Ñ‹Ñ… ÑˆÐ°Ð±Ð»Ð¾Ð½Ð°Ñ…), Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¿Ñ€Ð°Ð²Ð¸Ð» SIEM-ÑÐ¸ÑÑ‚ÐµÐ¼ Ð¸ Ñ€ÑƒÑ‡Ð½Ð¾Ðµ Ñ€Ð°ÑÑÐ»ÐµÐ´Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¸Ð½Ñ†Ð¸Ð´ÐµÐ½Ñ‚Ð¾Ð². ÐžÐ´Ð½Ð°ÐºÐ¾ Ð¾Ð½Ð¸ Ñ‚Ñ€ÐµÐ±ÑƒÑŽÑ‚ Ð·Ð½Ð°Ñ‡Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ñ… Ñ€ÐµÑÑƒÑ€ÑÐ¾Ð² Ð¸ Ñ‡Ð°ÑÑ‚Ð¾ Ð½ÐµÑÑ„Ñ„ÐµÐºÑ‚Ð¸Ð²Ð½Ñ‹ Ð¿Ñ€Ð¾Ñ‚Ð¸Ð² Ð½Ð¾Ð²Ñ‹Ñ… Ð¸Ð»Ð¸ Ð¼Ð°Ð»Ð¾Ð¸Ð·Ð²ÐµÑÑ‚Ð½Ñ‹Ñ… Ð¼ÐµÑ‚Ð¾Ð´Ð¾Ð² Ð°Ñ‚Ð°Ðº. Ð¢Ð°ÐºÐ¸Ð¼ Ð¾Ð±Ñ€Ð°Ð·Ð¾Ð¼, Ð°ÐºÑ‚ÑƒÐ°Ð»ÑŒÐ½Ð¾Ð¹ Ð·Ð°Ð´Ð°Ñ‡ÐµÐ¹ ÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ñ‚ÑÑ Ñ€Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° Ð¿Ñ€Ð¾Ð³Ñ€Ð°Ð¼Ð¼Ð½Ð¾Ð³Ð¾ Ð¾Ð±ÐµÑÐ¿ÐµÑ‡ÐµÐ½Ð¸Ñ, Ñ€ÐµÐ°Ð»Ð¸Ð·ÑƒÑŽÑ‰ÐµÐ³Ð¾ Ð¿Ð¾Ð²ÐµÐ´ÐµÐ½Ñ‡ÐµÑÐºÐ¸Ð¹ Ð¿Ð¾Ð´Ñ…Ð¾Ð´ Ðº Ð²Ñ‹ÑÐ²Ð»ÐµÐ½Ð¸ÑŽ ÑƒÐ³Ñ€Ð¾Ð·, Ð¾ÑÐ½Ð¾Ð²Ð°Ð½Ð½Ð¾Ð¼Ñƒ Ð½Ð° Ð°Ð½Ð°Ð»Ð¸Ð·Ðµ Ð¾Ñ‚ÐºÐ»Ð¾Ð½ÐµÐ½Ð¸Ð¹ Ð¾Ñ‚ Ð½Ð¾Ñ€Ð¼Ð°Ð»ÑŒÐ½Ð¾Ð³Ð¾ Ð¿Ð¾Ð²ÐµÐ´ÐµÐ½Ð¸Ñ Kerberos-ÑÐµÑÑÐ¸Ð¹.

---

## 1.2. Ð¦ÐµÐ»ÑŒ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹

Ð¦ÐµÐ»ÑŒÑŽ Ð´Ð°Ð½Ð½Ð¾Ð¹ Ð²Ñ‹Ð¿ÑƒÑÐºÐ½Ð¾Ð¹ ÐºÐ²Ð°Ð»Ð¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸Ð¾Ð½Ð½Ð¾Ð¹ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹ ÑÐ²Ð»ÑÐµÑ‚ÑÑ **Ñ€Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° Ð¿Ñ€Ð¾Ð³Ñ€Ð°Ð¼Ð¼Ð½Ð¾Ð³Ð¾ Ð¾Ð±ÐµÑÐ¿ÐµÑ‡ÐµÐ½Ð¸Ñ, Ð²Ñ‹ÑÐ²Ð»ÑÑŽÑ‰ÐµÐ³Ð¾ Ð°Ñ‚Ð°ÐºÐ¸ Ð½Ð° Ð¿Ñ€Ð¾Ñ‚Ð¾ÐºÐ¾Ð» Kerberos Ñ‡ÐµÑ€ÐµÐ· Ð°Ð½Ð°Ð»Ð¸Ð· Ð°Ð½Ð¾Ð¼Ð°Ð»Ð¸Ð¹ Ð² ÑÐµÑ‚ÐµÐ²Ð¾Ð¼ Ñ‚Ñ€Ð°Ñ„Ð¸ÐºÐµ Active Directory**.

Ð”Ð¾ÑÑ‚Ð¸Ð¶ÐµÐ½Ð¸Ðµ ÑÑ‚Ð¾Ð¹ Ñ†ÐµÐ»Ð¸ Ð¿Ñ€ÐµÐ´Ð¿Ð¾Ð»Ð°Ð³Ð°ÐµÑ‚ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ðµ ÑÐ¸ÑÑ‚ÐµÐ¼Ñ‹, ÑÐ¿Ð¾ÑÐ¾Ð±Ð½Ð¾Ð¹:
- Ð¡Ð¾Ð±Ð¸Ñ€Ð°Ñ‚ÑŒ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð¸Ð· ÑÐµÑ‚ÐµÐ²Ð¾Ð³Ð¾ Ñ‚Ñ€Ð°Ñ„Ð¸ÐºÐ° (PCAP) Ð¸ Ð¶ÑƒÑ€Ð½Ð°Ð»Ð¾Ð² ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ð¹ Windows.
- ÐŸÐ°Ñ€ÑÐ¸Ñ‚ÑŒ Kerberos-ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ Ð¸ Ð¸Ð·Ð²Ð»ÐµÐºÐ°Ñ‚ÑŒ ÐºÐ»ÑŽÑ‡ÐµÐ²Ñ‹Ðµ Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ñ‹.
- ÐžÐ±Ð½Ð°Ñ€ÑƒÐ¶Ð¸Ð²Ð°Ñ‚ÑŒ Ð¾Ñ‚ÐºÐ»Ð¾Ð½ÐµÐ½Ð¸Ñ Ð¾Ñ‚ Ð½Ð¾Ñ€Ð¼Ð°Ð»ÑŒÐ½Ð¾Ð³Ð¾ Ð¿Ð¾Ð²ÐµÐ´ÐµÐ½Ð¸Ñ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÐµÐ¹ Ð¸ ÑÐµÑ€Ð²Ð¸ÑÐ¾Ð².
- Ð¤Ð¾Ñ€Ð¼Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ ÑƒÐ²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ñ Ð¾ Ð¿Ð¾Ñ‚ÐµÐ½Ñ†Ð¸Ð°Ð»ÑŒÐ½Ñ‹Ñ… Ð°Ñ‚Ð°ÐºÐ°Ñ… Ð¸ Ð²Ñ‹Ð²Ð¾Ð´Ð¸Ñ‚ÑŒ Ð¸Ñ… Ð² ÑƒÐ´Ð¾Ð±Ð¾Ñ‡Ð¸Ñ‚Ð°ÐµÐ¼Ð¾Ð¼ Ð²Ð¸Ð´Ðµ.

---

## 1.3. Ð—Ð°Ð´Ð°Ñ‡Ð¸ Ð¸ÑÑÐ»ÐµÐ´Ð¾Ð²Ð°Ð½Ð¸Ñ

Ð”Ð»Ñ Ð´Ð¾ÑÑ‚Ð¸Ð¶ÐµÐ½Ð¸Ñ ÑƒÐºÐ°Ð·Ð°Ð½Ð½Ð¾Ð¹ Ñ†ÐµÐ»Ð¸ Ð±Ñ‹Ð»Ð¸ Ð¿Ð¾ÑÑ‚Ð°Ð²Ð»ÐµÐ½Ñ‹ ÑÐ»ÐµÐ´ÑƒÑŽÑ‰Ð¸Ðµ Ð·Ð°Ð´Ð°Ñ‡Ð¸:

1. **ÐŸÑ€Ð¾Ð²ÐµÑÑ‚Ð¸ Ð°Ð½Ð°Ð»Ð¸Ð· Ð¾ÑÐ¾Ð±ÐµÐ½Ð½Ð¾ÑÑ‚ÐµÐ¹ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¾Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ Ð¿Ñ€Ð¾Ñ‚Ð¾ÐºÐ¾Ð»Ð° Kerberos Ð² ÑÑ€ÐµÐ´Ðµ Active Directory.**
   - Ð˜Ð·ÑƒÑ‡Ð¸Ñ‚ÑŒ ÑÑ‚Ð°Ð¿Ñ‹ Ð°ÑƒÑ‚ÐµÐ½Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸Ð¸: AS-REQ / AS-REP, TGS-REQ / TGS-REP, AP-REQ.
   - Ð˜ÑÑÐ»ÐµÐ´Ð¾Ð²Ð°Ñ‚ÑŒ ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ñƒ Kerberos-Ð±Ð¸Ð»ÐµÑ‚Ð¾Ð² Ð¸ Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ð¹.
   - Ð Ð°ÑÑÐ¼Ð¾Ñ‚Ñ€ÐµÑ‚ÑŒ Ñ€Ð¾Ð»ÑŒ KDC, SPN Ð¸ ÑƒÑ‡ÐµÑ‚Ð½Ð¾Ð¹ Ð·Ð°Ð¿Ð¸ÑÐ¸ krbtgt.

2. **Ð˜ÑÑÐ»ÐµÐ´Ð¾Ð²Ð°Ñ‚ÑŒ Ð¸Ð·Ð²ÐµÑÑ‚Ð½Ñ‹Ðµ Ð¼ÐµÑ‚Ð¾Ð´Ð¸ÐºÐ¸ Ð°Ñ‚Ð°Ðº Ð½Ð° Ð¿Ñ€Ð¾Ñ‚Ð¾ÐºÐ¾Ð» Kerberos.**
   - Ð˜Ð·ÑƒÑ‡Ð¸Ñ‚ÑŒ Ñ‚Ð°ÐºÐ¸Ðµ Ð°Ñ‚Ð°ÐºÐ¸, ÐºÐ°Ðº Golden Ticket, Silver Ticket, Kerberoasting, AS-REP Roasting, Pass-the-Ticket.
   - Ð’Ñ‹ÑÐ²Ð¸Ñ‚ÑŒ Ñ…Ð°Ñ€Ð°ÐºÑ‚ÐµÑ€Ð½Ñ‹Ðµ ÑÐµÑ‚ÐµÐ²Ñ‹Ðµ Ð¸ Ð»Ð¾Ð³Ð¾Ð²Ñ‹Ðµ Ð¸Ð½Ð´Ð¸ÐºÐ°Ñ‚Ð¾Ñ€Ñ‹ ÐºÐ¾Ð¼Ð¿Ñ€Ð¾Ð¼ÐµÑ‚Ð°Ñ†Ð¸Ð¸.
   - ÐžÐ¿Ñ€ÐµÐ´ÐµÐ»Ð¸Ñ‚ÑŒ ÑÐ¿Ð¾ÑÐ¾Ð±Ñ‹ Ð¾Ð±Ð½Ð°Ñ€ÑƒÐ¶ÐµÐ½Ð¸Ñ ÐºÐ°Ð¶Ð´Ð¾Ð¹ Ð¸Ð· Ð½Ð¸Ñ….

3. **Ð’Ñ‹ÑÐ²Ð¸Ñ‚ÑŒ Ñ…Ð°Ñ€Ð°ÐºÑ‚ÐµÑ€Ð½Ñ‹Ðµ ÑÐµÑ‚ÐµÐ²Ñ‹Ðµ Ð¸ Ð»Ð¾Ð³Ð¾Ð²Ñ‹Ðµ Ð¸Ð½Ð´Ð¸ÐºÐ°Ñ‚Ð¾Ñ€Ñ‹ ÐºÐ¾Ð¼Ð¿Ñ€Ð¾Ð¼ÐµÑ‚Ð°Ñ†Ð¸Ð¸.**
   - ÐŸÑ€Ð¾Ð°Ð½Ð°Ð»Ð¸Ð·Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ñ‡Ð°ÑÑ‚Ð¾Ñ‚Ñƒ Ð·Ð°Ð¿Ñ€Ð¾ÑÐ¾Ð² TGT/TGS.
   - Ð˜ÑÑÐ»ÐµÐ´Ð¾Ð²Ð°Ñ‚ÑŒ TTL Ð±Ð¸Ð»ÐµÑ‚Ð¾Ð², SPN, Ð¾ÑˆÐ¸Ð±ÐºÐ¸ Ð°ÑƒÑ‚ÐµÐ½Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸Ð¸.
   - Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ Ð¼Ð¾Ð´ÐµÐ»Ð¸ Ð½Ð¾Ñ€Ð¼Ð°Ð»ÑŒÐ½Ð¾Ð³Ð¾ Ð¿Ð¾Ð²ÐµÐ´ÐµÐ½Ð¸Ñ Kerberos-ÑÐµÑÑÐ¸Ð¹.

4. **Ð Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚Ð°Ñ‚ÑŒ Ð¼Ð¾Ð´ÐµÐ»ÑŒ Ð¿Ð¾Ð²ÐµÐ´ÐµÐ½Ñ‡ÐµÑÐºÐ¾Ð³Ð¾ Ð°Ð½Ð°Ð»Ð¸Ð·Ð°.**
   - ÐŸÐ¾ÑÑ‚Ñ€Ð¾Ð¸Ñ‚ÑŒ Ð¿Ñ€Ð¾Ñ„Ð¸Ð»Ð¸ Ð¿Ð¾Ð²ÐµÐ´ÐµÐ½Ð¸Ñ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÐµÐ¹ Ð¸ ÑÐµÑ€Ð²Ð¸ÑÐ¾Ð².
   - Ð ÐµÐ°Ð»Ð¸Ð·Ð¾Ð²Ð°Ñ‚ÑŒ ÑÑ€Ð°Ð²Ð½ÐµÐ½Ð¸Ðµ Ñ‚ÐµÐºÑƒÑ‰Ð¸Ñ… ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ð¹ Ñ Ð¸ÑÑ‚Ð¾Ñ€Ð¸Ñ‡ÐµÑÐºÐ¸Ð¼Ð¸ Ð´Ð°Ð½Ð½Ñ‹Ð¼Ð¸.
   - Ð Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚Ð°Ñ‚ÑŒ Ð¿Ñ€Ð°Ð²Ð¸Ð»Ð° Ð¾Ð±Ð½Ð°Ñ€ÑƒÐ¶ÐµÐ½Ð¸Ñ Ð°Ð½Ð¾Ð¼Ð°Ð»Ð¸Ð¹.

5. **Ð¡Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ð¸ Ñ€ÐµÐ°Ð»Ð¸Ð·Ð¾Ð²Ð°Ñ‚ÑŒ Ð¿Ñ€Ð¾Ð³Ñ€Ð°Ð¼Ð¼Ð½Ñ‹Ð¹ Ð¼Ð¾Ð´ÑƒÐ»ÑŒ.**
   - Ð ÐµÐ°Ð»Ð¸Ð·Ð¾Ð²Ð°Ñ‚ÑŒ ÑÐ±Ð¾Ñ€ Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð¸Ð· PCAP-Ñ„Ð°Ð¹Ð»Ð¾Ð² Ð¸ Ð»Ð¾Ð³Ð¾Ð² Windows.
   - Ð Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚Ð°Ñ‚ÑŒ Ð¿Ð°Ñ€ÑÐµÑ€ Kerberos-ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ð¹.
   - Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ Ð°Ð»Ð³Ð¾Ñ€Ð¸Ñ‚Ð¼Ñ‹ Ð¾Ð±Ð½Ð°Ñ€ÑƒÐ¶ÐµÐ½Ð¸Ñ Ð°Ñ‚Ð°Ðº.
   - ÐžÑ€Ð³Ð°Ð½Ð¸Ð·Ð¾Ð²Ð°Ñ‚ÑŒ Ð²Ñ‹Ð²Ð¾Ð´ Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ð¾Ð² Ð² CLI Ð¸ JSON-Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚Ðµ.

6. **ÐŸÑ€Ð¾Ñ‚ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ñ€Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚Ð°Ð½Ð½Ð¾Ðµ Ð¿Ñ€Ð¾Ð³Ñ€Ð°Ð¼Ð¼Ð½Ð¾Ðµ Ð¾Ð±ÐµÑÐ¿ÐµÑ‡ÐµÐ½Ð¸Ðµ.**
   - ÐŸÑ€Ð¾Ð²ÐµÑÑ‚Ð¸ Ñ‚ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð½Ð° ÑÑ‚Ð°Ð»Ð¾Ð½Ð½Ñ‹Ñ… ÑÑ†ÐµÐ½Ð°Ñ€Ð¸ÑÑ… Ð°Ñ‚Ð°Ðº.
   - ÐžÑ†ÐµÐ½Ð¸Ñ‚ÑŒ ÑÑ„Ñ„ÐµÐºÑ‚Ð¸Ð²Ð½Ð¾ÑÑ‚ÑŒ Ð¾Ð±Ð½Ð°Ñ€ÑƒÐ¶ÐµÐ½Ð¸Ñ Ð¿Ð¾ Ð¼ÐµÑ‚Ñ€Ð¸ÐºÐ°Ð¼ Ñ‚Ð¾Ñ‡Ð½Ð¾ÑÑ‚Ð¸ Ð¸ ÑÐºÐ¾Ñ€Ð¾ÑÑ‚Ð¸.
   - Ð¡Ñ€Ð°Ð²Ð½Ð¸Ñ‚ÑŒ Ñ ÑÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÑŽÑ‰Ð¸Ð¼Ð¸ Ñ€ÐµÑˆÐµÐ½Ð¸ÑÐ¼Ð¸.

---

## 1.4. ÐžÐ±ÑŠÐµÐºÑ‚ Ð¸ Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚ Ð¸ÑÑÐ»ÐµÐ´Ð¾Ð²Ð°Ð½Ð¸Ñ

### ÐžÐ±ÑŠÐµÐºÑ‚ Ð¸ÑÑÐ»ÐµÐ´Ð¾Ð²Ð°Ð½Ð¸Ñ:
Ð¡Ð¸ÑÑ‚ÐµÐ¼Ð° Ð°ÑƒÑ‚ÐµÐ½Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸Ð¸ Ð½Ð° Ð¾ÑÐ½Ð¾Ð²Ðµ Ð¿Ñ€Ð¾Ñ‚Ð¾ÐºÐ¾Ð»Ð° Kerberos Ð² ÑÑ€ÐµÐ´Ðµ Microsoft Active Directory.

### ÐŸÑ€ÐµÐ´Ð¼ÐµÑ‚ Ð¸ÑÑÐ»ÐµÐ´Ð¾Ð²Ð°Ð½Ð¸Ñ:
ÐŸÑ€Ð¾Ñ†ÐµÑÑ Ð²Ñ‹ÑÐ²Ð»ÐµÐ½Ð¸Ñ Ð°Ñ‚Ð°Ðº Ð½Ð° Ð¿Ñ€Ð¾Ñ‚Ð¾ÐºÐ¾Ð» Kerberos Ñ Ð¿Ð¾Ð¼Ð¾Ñ‰ÑŒÑŽ Ð¿Ð¾Ð²ÐµÐ´ÐµÐ½Ñ‡ÐµÑÐºÐ¾Ð³Ð¾ Ð°Ð½Ð°Ð»Ð¸Ð·Ð° ÑÐµÑ‚ÐµÐ²Ð¾Ð³Ð¾ Ñ‚Ñ€Ð°Ñ„Ð¸ÐºÐ° Ð¸ Ð¶ÑƒÑ€Ð½Ð°Ð»Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ð¹ Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚Ð¸.

---

## 1.5. ÐœÐµÑ‚Ð¾Ð´Ð¾Ð»Ð¾Ð³Ð¸Ñ Ð¸ Ð¿Ð¾Ð´Ñ…Ð¾Ð´Ñ‹

Ð Ð°Ð±Ð¾Ñ‚Ð° Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð° Ñ Ð¿Ñ€Ð¸Ð¼ÐµÐ½ÐµÐ½Ð¸ÐµÐ¼ ÑÐ»ÐµÐ´ÑƒÑŽÑ‰Ð¸Ñ… Ð¼ÐµÑ‚Ð¾Ð´Ð¾Ð»Ð¾Ð³Ð¸Ð¹ Ð¸ Ð¿Ð¾Ð´Ñ…Ð¾Ð´Ð¾Ð²:

- **ÐÐ½Ð°Ð»Ð¸Ð· Ð½Ð°ÑƒÑ‡Ð½Ð¾Ð¹ Ð¸ Ñ‚ÐµÑ…Ð½Ð¸Ñ‡ÐµÑÐºÐ¾Ð¹ Ð»Ð¸Ñ‚ÐµÑ€Ð°Ñ‚ÑƒÑ€Ñ‹** Ð¿Ð¾ Ð¿Ñ€Ð¾Ñ‚Ð¾ÐºÐ¾Ð»Ñƒ Kerberos Ð¸ ÑÐ¾Ð²Ñ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ð¼ ÑƒÐ³Ñ€Ð¾Ð·Ð°Ð¼.
- **Ð­ÐºÑÐ¿ÐµÑ€Ð¸Ð¼ÐµÐ½Ñ‚Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ð¿Ð¾Ð´Ñ…Ð¾Ð´** â€” Ð¿Ñ€Ð¾Ð²ÐµÐ´ÐµÐ½Ð¸Ðµ Ñ‚ÐµÑÑ‚Ð¾Ð²Ñ‹Ñ… Ð°Ñ‚Ð°Ðº Ð² ÐºÐ¾Ð½Ñ‚Ñ€Ð¾Ð»Ð¸Ñ€ÑƒÐµÐ¼Ð¾Ð¹ Ð»Ð°Ð±Ð¾Ñ€Ð°Ñ‚Ð¾Ñ€Ð½Ð¾Ð¹ ÑÑ€ÐµÐ´Ðµ.
- **Ð¡Ð¸Ð³Ð½Ð°Ñ‚ÑƒÑ€Ð½Ñ‹Ð¹ Ð¸ Ð¿Ð¾Ð²ÐµÐ´ÐµÐ½Ñ‡ÐµÑÐºÐ¸Ð¹ Ð°Ð½Ð°Ð»Ð¸Ð·** Ð´Ð»Ñ Ð¾Ð±Ð½Ð°Ñ€ÑƒÐ¶ÐµÐ½Ð¸Ñ Ð°Ð½Ð¾Ð¼Ð°Ð»Ð¸Ð¹.
- **Ð Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° Ð¿Ñ€Ð¾Ð³Ñ€Ð°Ð¼Ð¼Ð½Ð¾Ð³Ð¾ Ð¾Ð±ÐµÑÐ¿ÐµÑ‡ÐµÐ½Ð¸Ñ** Ñ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸ÐµÐ¼ ÑÐ·Ñ‹ÐºÐ° Python Ð¸ Ð±Ð¸Ð±Ð»Ð¸Ð¾Ñ‚ÐµÐº Ð´Ð»Ñ Ð°Ð½Ð°Ð»Ð¸Ð·Ð° ÑÐµÑ‚ÐµÐ²Ð¾Ð³Ð¾ Ñ‚Ñ€Ð°Ñ„Ð¸ÐºÐ° Ð¸ Ð»Ð¾Ð³Ð¾Ð² Windows.


## 1.6. Ð¡Ñ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð° Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹

Ð Ð°Ð±Ð¾Ñ‚Ð° ÑÐ¾ÑÑ‚Ð¾Ð¸Ñ‚ Ð¸Ð· **ÑˆÐµÑÑ‚Ð¸ Ð³Ð»Ð°Ð²**, ÑÐ¿Ð¸ÑÐºÐ° Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð½Ñ‹Ñ… Ð¸ÑÑ‚Ð¾Ñ‡Ð½Ð¸ÐºÐ¾Ð² Ð¸ **Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ð¹**.

| Ð“Ð»Ð°Ð²Ð° | Ð¢ÐµÐ¼Ð° |
|-------|------|
| **Ð“Ð»Ð°Ð²Ð° 1** | Ð’Ð²ÐµÐ´ÐµÐ½Ð¸Ðµ â€” ÑÐ¾Ð´ÐµÑ€Ð¶Ð¸Ñ‚ Ñ†ÐµÐ»ÑŒ, Ð·Ð°Ð´Ð°Ñ‡Ð¸, Ð¾Ð±ÑŠÐµÐºÑ‚ Ð¸ Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚ Ð¸ÑÑÐ»ÐµÐ´Ð¾Ð²Ð°Ð½Ð¸Ñ, Ð° Ñ‚Ð°ÐºÐ¶Ðµ Ð¾Ð±Ð¾ÑÐ½Ð¾Ð²Ñ‹Ð²Ð°ÐµÑ‚ÑÑ ÐµÑ‘ Ð°ÐºÑ‚ÑƒÐ°Ð»ÑŒÐ½Ð¾ÑÑ‚ÑŒ. |
| **Ð“Ð»Ð°Ð²Ð° 2** | Ð¢ÐµÐ¾Ñ€ÐµÑ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ðµ Ð¾ÑÐ½Ð¾Ð²Ñ‹ â€” Ð¾Ð¿Ð¸ÑÐ°Ð½Ð¸Ðµ Ð¿Ñ€Ð¾Ñ‚Ð¾ÐºÐ¾Ð»Ð° Kerberos, ÐµÐ³Ð¾ Ñ€Ð¾Ð»Ð¸ Ð² Active Directory Ð¸ ÐºÐ»Ð°ÑÑÐ¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸Ñ Ñ‚Ð¸Ð¿Ð¾Ð²Ñ‹Ñ… Ð°Ñ‚Ð°Ðº. |
| **Ð“Ð»Ð°Ð²Ð° 3** | ÐÐ½Ð°Ð»Ð¸Ð· Ð°Ñ‚Ð°Ðº Ð¸ Ð²Ñ‹ÑÐ²Ð»ÐµÐ½Ð¸Ðµ Ð°Ð½Ð¾Ð¼Ð°Ð»Ð¸Ð¹ â€” Ð¼Ð¾Ð´ÐµÐ»Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ ÑƒÐ³Ñ€Ð¾Ð·, Ð²Ñ‹ÑÐ²Ð»ÐµÐ½Ð¸Ðµ Ð°Ð½Ð¾Ð¼Ð°Ð»Ð¸Ð¹ Ð¸ Ð¼ÐµÑ‚Ð¾Ð´Ñ‹ Ð¸Ñ… Ð¾Ð±Ð½Ð°Ñ€ÑƒÐ¶ÐµÐ½Ð¸Ñ. |
| **Ð“Ð»Ð°Ð²Ð° 4** | Ð Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° Ð¿Ñ€Ð¾Ð³Ñ€Ð°Ð¼Ð¼Ð½Ð¾Ð³Ð¾ Ð¾Ð±ÐµÑÐ¿ÐµÑ‡ÐµÐ½Ð¸Ñ â€” Ð¾Ð¿Ð¸ÑÐ°Ð½Ð¸Ðµ Ð°Ñ€Ñ…Ð¸Ñ‚ÐµÐºÑ‚ÑƒÑ€Ñ‹ Ð¸ Ñ€ÐµÐ°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ð¸ Ð¿Ñ€Ð¾Ð³Ñ€Ð°Ð¼Ð¼Ñ‹. |
| **Ð“Ð»Ð°Ð²Ð° 5** | Ð¢ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¸ Ð¾Ñ†ÐµÐ½ÐºÐ° ÑÑ„Ñ„ÐµÐºÑ‚Ð¸Ð²Ð½Ð¾ÑÑ‚Ð¸ â€” Ð¿Ñ€Ð¾Ð²ÐµÐ´ÐµÐ½Ð¸Ðµ Ñ‚ÐµÑÑ‚Ð¾Ð² Ð¸ Ð°Ð½Ð°Ð»Ð¸Ð· Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð½Ñ‹Ñ… Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ð¾Ð². |
| **Ð“Ð»Ð°Ð²Ð° 6** | Ð—Ð°ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ â€” Ð²Ñ‹Ð²Ð¾Ð´Ñ‹ Ð¿Ð¾ Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ð°Ð¼ Ð¸ÑÑÐ»ÐµÐ´Ð¾Ð²Ð°Ð½Ð¸Ñ Ð¸ Ð¿ÐµÑ€ÑÐ¿ÐµÐºÑ‚Ð¸Ð²Ñ‹ Ð´Ð°Ð»ÑŒÐ½ÐµÐ¹ÑˆÐµÐ¹ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹. |

**ÐŸÑ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ** ÑÐ¾Ð´ÐµÑ€Ð¶Ð°Ñ‚ Ð¸ÑÑ…Ð¾Ð´Ð½Ñ‹Ð¹ ÐºÐ¾Ð´ Ð¿Ñ€Ð¾Ð³Ñ€Ð°Ð¼Ð¼Ñ‹, Ð¿Ñ€Ð¸Ð¼ÐµÑ€Ñ‹ Ð¾Ð±Ð½Ð°Ñ€ÑƒÐ¶ÐµÐ½Ð¸Ñ Ð°Ñ‚Ð°Ðº, Ñ‡ÐµÐº-Ð»Ð¸ÑÑ‚ Ñ‚ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ Ð¸ Ð´Ñ€ÑƒÐ³Ð¸Ðµ Ð¼Ð°Ñ‚ÐµÑ€Ð¸Ð°Ð»Ñ‹.

---


# ðŸ“˜ Ð“Ð»Ð°Ð²Ð° 2. Ð¢ÐµÐ¾Ñ€ÐµÑ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ðµ Ð¾ÑÐ½Ð¾Ð²Ñ‹

## 2.1. ÐŸÑ€Ð¾Ñ‚Ð¾ÐºÐ¾Ð» Kerberos: Ð°Ñ€Ñ…Ð¸Ñ‚ÐµÐºÑ‚ÑƒÑ€Ð° Ð¸ ÑÑ‚Ð°Ð¿Ñ‹ Ð°ÑƒÑ‚ÐµÐ½Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸Ð¸

ÐŸÑ€Ð¾Ñ‚Ð¾ÐºÐ¾Ð» Kerberos â€” ÑÑ‚Ð¾ Ð¼ÐµÑ…Ð°Ð½Ð¸Ð·Ð¼ Ñ†ÐµÐ½Ñ‚Ñ€Ð°Ð»Ð¸Ð·Ð¾Ð²Ð°Ð½Ð½Ð¾Ð¹ Ð°ÑƒÑ‚ÐµÐ½Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸Ð¸, Ñ€Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚Ð°Ð½Ð½Ñ‹Ð¹ Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð¾Ð¼ Athena Ð² Ð£Ð½Ð¸Ð²ÐµÑ€ÑÐ¸Ñ‚ÐµÑ‚Ðµ Ð‘ÐµÑ€ÐºÐ»Ð¸ Ð¸ ÑÑ‚Ð°Ð½Ð´Ð°Ñ€Ñ‚Ð¸Ð·Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ñ‹Ð¹ Ð² RFC 4120 ÐºÐ°Ðº Kerberos Ð²ÐµÑ€ÑÐ¸Ð¸ 5. Ð•Ð³Ð¾ Ñ†ÐµÐ»ÑŒ â€” Ð¾Ð±ÐµÑÐ¿ÐµÑ‡Ð¸Ñ‚ÑŒ Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾Ðµ Ð¿Ð¾Ð´Ñ‚Ð²ÐµÑ€Ð¶Ð´ÐµÐ½Ð¸Ðµ Ð¿Ð¾Ð´Ð»Ð¸Ð½Ð½Ð¾ÑÑ‚Ð¸ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÐµÐ¹ Ð¸ ÑÐµÑ€Ð²Ð¸ÑÐ¾Ð² Ð² Ð½ÐµÐ±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾Ð¹ ÑÐµÑ‚Ð¸ Ð±ÐµÐ· Ð¿ÐµÑ€ÐµÐ´Ð°Ñ‡Ð¸ Ð¿Ð°Ñ€Ð¾Ð»ÐµÐ¹ Ð¿Ð¾ ÐºÐ°Ð½Ð°Ð»Ñƒ ÑÐ²ÑÐ·Ð¸.

### 2.1.1. ÐžÑÐ½Ð¾Ð²Ð½Ñ‹Ðµ ÐºÐ¾Ð¼Ð¿Ð¾Ð½ÐµÐ½Ñ‚Ñ‹ Kerberos

| ÐšÐ¾Ð¼Ð¿Ð¾Ð½ÐµÐ½Ñ‚ | ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ |
|----------|----------|
| **KDC (Key Distribution Center)** | Ð¦ÐµÐ½Ñ‚Ñ€ Ñ€Ð°ÑÐ¿Ñ€Ð¾ÑÑ‚Ñ€Ð°Ð½ÐµÐ½Ð¸Ñ ÐºÐ»ÑŽÑ‡ÐµÐ¹, ÑÐ¾ÑÑ‚Ð¾Ð¸Ñ‚ Ð¸Ð· Authentication Server (AS) Ð¸ Ticket Granting Server (TGS) |
| **TGT (Ticket Granting Ticket)** | Ð’Ñ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ð¹ Ð±Ð¸Ð»ÐµÑ‚, Ð²Ñ‹Ð´Ð°Ð²Ð°ÐµÐ¼Ñ‹Ð¹ Ð¿Ñ€Ð¸ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾Ð¹ Ð°ÑƒÑ‚ÐµÐ½Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸Ð¸ Ñƒ AS |
| **TGS-Ð±Ð¸Ð»ÐµÑ‚ (Service Ticket)** | Ð‘Ð¸Ð»ÐµÑ‚ Ð´Ð»Ñ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð° Ðº ÐºÐ¾Ð½ÐºÑ€ÐµÑ‚Ð½Ð¾Ð¼Ñƒ ÑÐµÑ€Ð²Ð¸ÑÑƒ |
| **SPN (Service Principal Name)** | Ð£Ð½Ð¸ÐºÐ°Ð»ÑŒÐ½Ñ‹Ð¹ Ð¸Ð´ÐµÐ½Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ‚Ð¾Ñ€ ÑÐµÑ€Ð²Ð¸ÑÐ° Ð² Ð´Ð¾Ð¼ÐµÐ½Ðµ |
| **Principal** | Ð˜Ð¼Ñ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ Ð¸Ð»Ð¸ ÑÐµÑ€Ð²Ð¸ÑÐ° Ð² Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚Ðµ user@REALM |

### 2.1.2. Ð­Ñ‚Ð°Ð¿Ñ‹ Ð°ÑƒÑ‚ÐµÐ½Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸Ð¸ Ð² Kerberos

#### Ð­Ñ‚Ð°Ð¿ 1. Ð—Ð°Ð¿Ñ€Ð¾Ñ TGT (AS-REQ)
ÐšÐ»Ð¸ÐµÐ½Ñ‚ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²Ð»ÑÐµÑ‚ Ð·Ð°Ð¿Ñ€Ð¾Ñ Ð½Ð° KDC Ñ Ð¸Ð¼ÐµÐ½ÐµÐ¼ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ Ð¸ Ð´Ñ€ÑƒÐ³Ð¸Ð¼Ð¸ Ð´Ð°Ð½Ð½Ñ‹Ð¼Ð¸. ÐžÐ½ Ð¼Ð¾Ð¶ÐµÑ‚ ÑÐ¾Ð´ÐµÑ€Ð¶Ð°Ñ‚ÑŒ Ð¿Ñ€ÐµÐ´Ð²Ð°Ñ€Ð¸Ñ‚ÐµÐ»ÑŒÐ½ÑƒÑŽ Ð°ÑƒÑ‚ÐµÐ½Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸ÑŽ (pre-authentication).

#### Ð­Ñ‚Ð°Ð¿ 2. ÐžÑ‚Ð²ÐµÑ‚ Ð¾Ñ‚ AS (AS-REP)
KDC Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑÐµÑ‚ Ð»Ð¸Ñ‡Ð½Ð¾ÑÑ‚ÑŒ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ. Ð•ÑÐ»Ð¸ Ð°ÑƒÑ‚ÐµÐ½Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸Ñ ÑƒÑÐ¿ÐµÑˆÐ½Ð°, Ð¾Ð½ Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÑ‚:
- **TGT**, Ð·Ð°ÑˆÐ¸Ñ„Ñ€Ð¾Ð²Ð°Ð½Ð½Ñ‹Ð¹ ÐºÐ»ÑŽÑ‡Ð¾Ð¼ krbtgt,
- **Ð¡ÐµÑÑÐ¸Ð¾Ð½Ð½Ñ‹Ð¹ ÐºÐ»ÑŽÑ‡**, Ð·Ð°ÑˆÐ¸Ñ„Ñ€Ð¾Ð²Ð°Ð½Ð½Ñ‹Ð¹ Ñ…ÑÑˆÐµÐ¼ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ.

#### Ð­Ñ‚Ð°Ð¿ 3. Ð—Ð°Ð¿Ñ€Ð¾Ñ TGS (TGS-REQ)
Ð”Ð»Ñ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð° Ðº ÐºÐ¾Ð½ÐºÑ€ÐµÑ‚Ð½Ð¾Ð¼Ñƒ ÑÐµÑ€Ð²Ð¸ÑÑƒ ÐºÐ»Ð¸ÐµÐ½Ñ‚ Ð·Ð°Ð¿Ñ€Ð°ÑˆÐ¸Ð²Ð°ÐµÑ‚ Ñƒ TGS Ð±Ð¸Ð»ÐµÑ‚ Ð½Ð° Ð´Ð¾ÑÑ‚ÑƒÐ¿ Ðº Ð½ÐµÐ¼Ñƒ, Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÑ TGT.

#### Ð­Ñ‚Ð°Ð¿ 4. ÐžÑ‚Ð²ÐµÑ‚ Ð¾Ñ‚ TGS (TGS-REP)
KDC Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÑ‚:
- **TGS-Ð±Ð¸Ð»ÐµÑ‚**, Ð·Ð°ÑˆÐ¸Ñ„Ñ€Ð¾Ð²Ð°Ð½Ð½Ñ‹Ð¹ ÐºÐ»ÑŽÑ‡Ð¾Ð¼ ÑÐµÑ€Ð²Ð¸ÑÐ°,
- **Ð¡ÐµÑÑÐ¸Ð¾Ð½Ð½Ñ‹Ð¹ ÐºÐ»ÑŽÑ‡ ÐºÐ»Ð¸ÐµÐ½Ñ‚Ð° Ð¸ ÑÐµÑ€Ð²Ð¸ÑÐ°**, Ð·Ð°ÑˆÐ¸Ñ„Ñ€Ð¾Ð²Ð°Ð½Ð½Ñ‹Ð¹ ÑÐµÑÑÐ¸Ð¾Ð½Ð½Ñ‹Ð¼ ÐºÐ»ÑŽÑ‡Ð¾Ð¼ ÐºÐ»Ð¸ÐµÐ½Ñ‚Ð° Ð¸ TGT.

#### Ð­Ñ‚Ð°Ð¿ 5. Ð”Ð¾ÑÑ‚ÑƒÐ¿ Ðº ÑÐµÑ€Ð²Ð¸ÑÑƒ (AP-REQ / AP-REP)
ÐšÐ»Ð¸ÐµÐ½Ñ‚ Ð¿Ñ€ÐµÐ´ÑÑ‚Ð°Ð²Ð»ÑÐµÑ‚ TGS-Ð±Ð¸Ð»ÐµÑ‚ Ð¸ Ð°Ð²Ñ‚Ð¾Ñ€Ð¸Ð·ÑƒÐµÑ‚ÑÑ Ñƒ ÑÐµÑ€Ð²Ð¸ÑÐ°, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑÐµÑ‚ Ð¿Ð¾Ð´Ð»Ð¸Ð½Ð½Ð¾ÑÑ‚ÑŒ Ð±Ð¸Ð»ÐµÑ‚Ð° Ð¸ Ð¿Ð¾Ð·Ð²Ð¾Ð»ÑÐµÑ‚ Ð¿Ð¾Ð»ÑƒÑ‡Ð¸Ñ‚ÑŒ Ð´Ð¾ÑÑ‚ÑƒÐ¿ Ðº Ñ€ÐµÑÑƒÑ€ÑÑƒ.

### 2.1.3. Ð‘ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚ÑŒ Kerberos

- Ð’ÑÐµ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ ÑˆÐ¸Ñ„Ñ€ÑƒÑŽÑ‚ÑÑ Ñ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸ÐµÐ¼ ÑÐ¸Ð¼Ð¼ÐµÑ‚Ñ€Ð¸Ñ‡Ð½Ñ‹Ñ… ÐºÐ»ÑŽÑ‡ÐµÐ¹.
- ÐŸÐ°Ñ€Ð¾Ð»ÑŒ Ð½Ð¸ÐºÐ¾Ð³Ð´Ð° Ð½Ðµ Ð¿ÐµÑ€ÐµÐ´Ð°ÐµÑ‚ÑÑ Ð¿Ð¾ ÑÐµÑ‚Ð¸.
- Ð‘Ð¸Ð»ÐµÑ‚Ñ‹ Ð¸Ð¼ÐµÑŽÑ‚ Ð¾Ð³Ñ€Ð°Ð½Ð¸Ñ‡ÐµÐ½Ð½Ð¾Ðµ Ð²Ñ€ÐµÐ¼Ñ Ð¶Ð¸Ð·Ð½Ð¸.
- ÐŸÐ¾Ð´Ð´ÐµÑ€Ð¶Ð¸Ð²Ð°ÐµÑ‚ÑÑ pre-authentication Ð´Ð»Ñ Ð¿Ñ€ÐµÐ´Ð¾Ñ‚Ð²Ñ€Ð°Ñ‰ÐµÐ½Ð¸Ñ offline-Ð°Ñ‚Ð°Ðº.

---

## 2.2. Ð Ð¾Ð»ÑŒ Kerberos Ð² Microsoft Active Directory

Microsoft Active Directory (AD) Ð¸Ð½Ñ‚ÐµÐ³Ñ€Ð¸Ñ€ÑƒÐµÑ‚ Ð¿Ñ€Ð¾Ñ‚Ð¾ÐºÐ¾Ð» Kerberos ÐºÐ°Ðº ÑÑ‚Ð°Ð½Ð´Ð°Ñ€Ñ‚Ð½Ñ‹Ð¹ Ð¼ÐµÑ…Ð°Ð½Ð¸Ð·Ð¼ Ð°ÑƒÑ‚ÐµÐ½Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸Ð¸ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÐµÐ¹ Ð¸ ÐºÐ¾Ð¼Ð¿ÑŒÑŽÑ‚ÐµÑ€Ð¾Ð² Ð² Ð´Ð¾Ð¼ÐµÐ½Ð½Ð¾Ð¹ ÑÑ€ÐµÐ´Ðµ. Ð­Ñ‚Ð¾ Ð´ÐµÐ»Ð°ÐµÑ‚ Kerberos Ñ†ÐµÐ½Ñ‚Ñ€Ð°Ð»ÑŒÐ½Ñ‹Ð¼ ÑÐ»ÐµÐ¼ÐµÐ½Ñ‚Ð¾Ð¼ Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚Ð¸ Ð²ÑÐµÐ¹ ÐºÐ¾Ñ€Ð¿Ð¾Ñ€Ð°Ñ‚Ð¸Ð²Ð½Ð¾Ð¹ Ð¸Ð½Ñ„Ñ€Ð°ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ñ‹.

### 2.2.1. Ð˜Ð½Ñ‚ÐµÐ³Ñ€Ð°Ñ†Ð¸Ñ Kerberos Ð² AD

- **KDC** Ñ€ÐµÐ°Ð»Ð¸Ð·Ð¾Ð²Ð°Ð½ Ð² Ð²Ð¸Ð´Ðµ ÑÐ»ÑƒÐ¶Ð±Ñ‹ NetLogon Ð½Ð° ÐºÐ¾Ð½Ñ‚Ñ€Ð¾Ð»Ð»ÐµÑ€Ð°Ñ… Ð´Ð¾Ð¼ÐµÐ½Ð°.
- **krbtgt** â€” ÑÐ¿ÐµÑ†Ð¸Ð°Ð»ÑŒÐ½Ð°Ñ ÑƒÑ‡ÐµÑ‚Ð½Ð°Ñ Ð·Ð°Ð¿Ð¸ÑÑŒ Ð´Ð¾Ð¼ÐµÐ½Ð°, Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÐ¼Ð°Ñ Ð´Ð»Ñ ÑˆÐ¸Ñ„Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ TGT.
- ÐšÐ°Ð¶Ð´Ñ‹Ð¹ ÐºÐ¾Ð¼Ð¿ÑŒÑŽÑ‚ÐµÑ€ Ð² Ð´Ð¾Ð¼ÐµÐ½Ðµ Ð¸Ð¼ÐµÐµÑ‚ ÑÐ²Ð¾ÑŽ ÑƒÑ‡ÐµÑ‚Ð½ÑƒÑŽ Ð·Ð°Ð¿Ð¸ÑÑŒ, ÐºÐ¾Ñ‚Ð¾Ñ€Ð°Ñ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ÑÑ Ð´Ð»Ñ Ð°ÑƒÑ‚ÐµÐ½Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸Ð¸ Ð² Ð´Ð¾Ð¼ÐµÐ½Ðµ.

### 2.2.2. ÐŸÐ¾Ð»Ð¸Ñ‚Ð¸ÐºÐ¸ Kerberos Ð² AD

ÐŸÐ¾Ð»Ð¸Ñ‚Ð¸ÐºÐ¸ Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»ÑÑŽÑ‚ Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ñ‹ Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚Ð¸ Kerberos:

| ÐŸÐ°Ñ€Ð°Ð¼ÐµÑ‚Ñ€ | ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ |
|----------|----------|
| **max-ticket-life** | ÐœÐ°ÐºÑÐ¸Ð¼Ð°Ð»ÑŒÐ½Ð¾Ðµ Ð²Ñ€ÐµÐ¼Ñ Ð¶Ð¸Ð·Ð½Ð¸ TGT (Ð¿Ð¾ ÑƒÐ¼Ð¾Ð»Ñ‡Ð°Ð½Ð¸ÑŽ 10 Ñ‡Ð°ÑÐ¾Ð²) |
| **max-renewable-ticket-life** | ÐœÐ°ÐºÑÐ¸Ð¼Ð°Ð»ÑŒÐ½Ð¾Ðµ Ð²Ñ€ÐµÐ¼Ñ Ð¿Ñ€Ð¾Ð´Ð»ÐµÐ½Ð¸Ñ Ð±Ð¸Ð»ÐµÑ‚Ð° (Ð´Ð¾ 7 Ð´Ð½ÐµÐ¹) |
| **realm** | Ð˜Ð¼Ñ Ð´Ð¾Ð¼ÐµÐ½Ð° (Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, LAB.LOCAL) |
| **pre-authentication** | ÐžÐ±ÑÐ·Ð°Ñ‚ÐµÐ»ÑŒÐ½Ð°Ñ Ð¿Ñ€ÐµÐ´Ð²Ð°Ñ€Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð°Ñ Ð°ÑƒÑ‚ÐµÐ½Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸Ñ (Ð¿Ð¾ ÑƒÐ¼Ð¾Ð»Ñ‡Ð°Ð½Ð¸ÑŽ Ð²ÐºÐ»ÑŽÑ‡ÐµÐ½Ð°) |

Ð­Ñ‚Ð¸ Ð¿Ð¾Ð»Ð¸Ñ‚Ð¸ÐºÐ¸ Ð¼Ð¾Ð¶Ð½Ð¾ Ð½Ð°ÑÑ‚Ñ€Ð°Ð¸Ð²Ð°Ñ‚ÑŒ Ñ‡ÐµÑ€ÐµÐ· Ð³Ñ€ÑƒÐ¿Ð¿Ð¾Ð²Ñ‹Ðµ Ð¿Ð¾Ð»Ð¸Ñ‚Ð¸ÐºÐ¸ (GPO), Ð½Ð¾ Ð¸Ñ… Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ðµ Ð²Ð»Ð¸ÑÐµÑ‚ Ð½Ð° ÑƒÑ€Ð¾Ð²ÐµÐ½ÑŒ Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚Ð¸ Ð¸ Ð¿Ñ€Ð¾Ð¸Ð·Ð²Ð¾Ð´Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ÑÑ‚ÑŒ.

### 2.2.3. Ð–ÑƒÑ€Ð½Ð°Ð»Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ð¹ Kerberos Ð² Windows

Windows Event Logs ÑÐ¾Ð´ÐµÑ€Ð¶Ð¸Ñ‚ ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ñ, ÑÐ²ÑÐ·Ð°Ð½Ð½Ñ‹Ðµ Ñ Kerberos:

| ID ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ñ | ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ |
|-----------|----------|
| **4768** | Ð—Ð°Ð¿Ñ€Ð¾Ñ TGT |
| **4769** | Ð—Ð°Ð¿Ñ€Ð¾Ñ TGS |
| **4771** | ÐžÑˆÐ¸Ð±ÐºÐ° Ð°ÑƒÑ‚ÐµÐ½Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸Ð¸ Kerberos |
| **4624** | Ð£ÑÐ¿ÐµÑˆÐ½Ñ‹Ð¹ Ð²Ñ…Ð¾Ð´ Ð² ÑÐ¸ÑÑ‚ÐµÐ¼Ñƒ |
| **4625** | ÐÐµÑƒÐ´Ð°Ñ‡Ð½Ð°Ñ Ð¿Ð¾Ð¿Ñ‹Ñ‚ÐºÐ° Ð²Ñ…Ð¾Ð´Ð° |

Ð­Ñ‚Ð¸ ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ñ ÑÐ²Ð»ÑÑŽÑ‚ÑÑ Ð²Ð°Ð¶Ð½Ñ‹Ð¼ Ð¸ÑÑ‚Ð¾Ñ‡Ð½Ð¸ÐºÐ¾Ð¼ Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð´Ð»Ñ Ð¾Ð±Ð½Ð°Ñ€ÑƒÐ¶ÐµÐ½Ð¸Ñ Ð°Ð½Ð¾Ð¼Ð°Ð»ÑŒÐ½Ð¾Ð¹ Ð°ÐºÑ‚Ð¸Ð²Ð½Ð¾ÑÑ‚Ð¸.

---

## 2.3. Ð¢Ð¸Ð¿Ð¾Ð²Ñ‹Ðµ Ð°Ñ‚Ð°ÐºÐ¸ Ð½Ð° Ð¿Ñ€Ð¾Ñ‚Ð¾ÐºÐ¾Ð» Kerberos

ÐÐµÑÐ¼Ð¾Ñ‚Ñ€Ñ Ð½Ð° Ð½Ð°Ð´Ñ‘Ð¶Ð½Ð¾ÑÑ‚ÑŒ ÑÐ°Ð¼Ð¾Ð³Ð¾ Ð¿Ñ€Ð¾Ñ‚Ð¾ÐºÐ¾Ð»Ð°, Ð·Ð»Ð¾ÑƒÐ¼Ñ‹ÑˆÐ»ÐµÐ½Ð½Ð¸ÐºÐ¸ Ð½Ð°Ñ…Ð¾Ð´ÑÑ‚ ÑÐ¿Ð¾ÑÐ¾Ð±Ñ‹ ÐµÐ³Ð¾ ÑÐºÑÐ¿Ð»ÑƒÐ°Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ, Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÑ ÑÐ»Ð°Ð±Ñ‹Ðµ Ð¼ÐµÑÑ‚Ð° Ð² ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ð¸, ÑƒÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ð¸ ÑƒÑ‡Ñ‘Ñ‚Ð½Ñ‹Ð¼Ð¸ Ð·Ð°Ð¿Ð¸ÑÑÐ¼Ð¸ Ð¸ Ð¿Ð¾Ð»Ð¸Ñ‚Ð¸ÐºÐ°Ð¼Ð¸ Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚Ð¸.

### 2.3.1. Golden Ticket

- **ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ**: Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ð¿Ð¾Ð´Ð´ÐµÐ»ÑŒÐ½Ð¾Ð³Ð¾ TGT Ð²Ð½Ðµ ÑÐ¸ÑÑ‚ÐµÐ¼Ñ‹, Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÑ Ñ…ÑÑˆ ÑƒÑ‡ÐµÑ‚Ð½Ð¾Ð¹ Ð·Ð°Ð¿Ð¸ÑÐ¸ krbtgt.
- **Ð¦ÐµÐ»ÑŒ**: ÐŸÐ¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ðµ Ð½ÐµÐ¾Ð³Ñ€Ð°Ð½Ð¸Ñ‡ÐµÐ½Ð½Ð¾Ð³Ð¾ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð° ÐºÐ¾ Ð²ÑÐµÐ¼ Ñ€ÐµÑÑƒÑ€ÑÐ°Ð¼ Ð´Ð¾Ð¼ÐµÐ½Ð°.
- **ÐœÐµÑ‚Ð¾Ð´Ñ‹ Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ñ Ñ…ÑÑˆÐ° krbtgt**:
  - Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ðµ Mimikatz Ð½Ð° ÐºÐ¾Ð½Ñ‚Ñ€Ð¾Ð»Ð»ÐµÑ€Ðµ Ð´Ð¾Ð¼ÐµÐ½Ð°.
  - ÐŸÐµÑ€ÐµÑ…Ð²Ð°Ñ‚ Ñ‚Ñ€Ð°Ñ„Ð¸ÐºÐ° Ñ Ð¿Ð¾Ð¼Ð¾Ñ‰ÑŒÑŽ Pass-the-Ticket.
- **ÐžÐ±Ð½Ð°Ñ€ÑƒÐ¶ÐµÐ½Ð¸Ðµ**:
  - Ð”Ð¾Ð»Ð³Ð¸Ð¹ TTL Ð±Ð¸Ð»ÐµÑ‚Ð°.
  - Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¸Ð¼ÐµÐ½Ð¸ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ, ÐºÐ¾Ñ‚Ð¾Ñ€Ð¾Ð³Ð¾ Ð½ÐµÑ‚ Ð² ÑÐ¸ÑÑ‚ÐµÐ¼Ðµ.
  - ÐžÑ‚ÑÑƒÑ‚ÑÑ‚Ð²Ð¸Ðµ ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ñ Ð²Ñ…Ð¾Ð´Ð° Ð² ÑÐ¸ÑÑ‚ÐµÐ¼Ñƒ.

### 2.3.2. Silver Ticket

- **ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ**: ÐŸÐ¾Ð´Ð´ÐµÐ»ÐºÐ° TGS-Ð±Ð¸Ð»ÐµÑ‚Ð° Ð´Ð»Ñ ÐºÐ¾Ð½ÐºÑ€ÐµÑ‚Ð½Ð¾Ð³Ð¾ ÑÐµÑ€Ð²Ð¸ÑÐ° Ñ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸ÐµÐ¼ Ñ…ÑÑˆÐ° ÐµÐ³Ð¾ ÑƒÑ‡ÐµÑ‚Ð½Ð¾Ð¹ Ð·Ð°Ð¿Ð¸ÑÐ¸.
- **Ð¦ÐµÐ»ÑŒ**: ÐŸÐ¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ðµ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð° Ðº Ð¾Ð´Ð½Ð¾Ð¼Ñƒ ÑÐµÑ€Ð²Ð¸ÑÑƒ Ð±ÐµÐ· Ð¾Ð±Ñ€Ð°Ñ‰ÐµÐ½Ð¸Ñ Ðº KDC.
- **ÐœÐµÑ‚Ð¾Ð´Ñ‹ Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ñ Ñ…ÑÑˆÐ° ÑÐµÑ€Ð²Ð¸ÑÐ°**:
  - Ð˜Ð·Ð²Ð»ÐµÑ‡ÐµÐ½Ð¸Ðµ Ð¸Ð· Ð¿Ð°Ð¼ÑÑ‚Ð¸ ÑÐµÑ€Ð²ÐµÑ€Ð° ÑÐµÑ€Ð²Ð¸ÑÐ° Ñ Ð¿Ð¾Ð¼Ð¾Ñ‰ÑŒÑŽ Mimikatz.
  - Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ðµ Ñ€Ð°Ð½ÐµÐµ ÑƒÐºÑ€Ð°Ð´ÐµÐ½Ð½Ð¾Ð³Ð¾ Ñ…ÑÑˆÐ° Ð¸Ð· Ð´Ð°Ð¼Ð¿Ð° SAM/NTDS.
- **ÐžÐ±Ð½Ð°Ñ€ÑƒÐ¶ÐµÐ½Ð¸Ðµ**:
  - Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð±Ð¸Ð»ÐµÑ‚Ð° Ð±ÐµÐ· Ð¿Ñ€ÐµÐ´ÑˆÐµÑÑ‚Ð²ÑƒÑŽÑ‰ÐµÐ³Ð¾ TGT.
  - Ð—Ð°Ð¿Ñ€Ð¾ÑÑ‹ Ðº SPN, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ðµ Ð½Ðµ ÑÐ¾Ð¾Ñ‚Ð²ÐµÑ‚ÑÑ‚Ð²ÑƒÑŽÑ‚ Ð½Ð¾Ñ€Ð¼Ð°Ð»ÑŒÐ½Ð¾Ð¼Ñƒ Ð¿Ð¾Ð²ÐµÐ´ÐµÐ½Ð¸ÑŽ.

### 2.3.3. Pass-the-Ticket (PtT)

- **ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ**: Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ðµ ÑƒÐºÑ€Ð°Ð´ÐµÐ½Ð½Ð¾Ð³Ð¾ Ð±Ð¸Ð»ÐµÑ‚Ð° Ð±ÐµÐ· Ñ€Ð°ÑÑˆÐ¸Ñ„Ñ€Ð¾Ð²ÐºÐ¸.
- **Ð˜Ð½ÑÑ‚Ñ€ÑƒÐ¼ÐµÐ½Ñ‚Ñ‹**:
  - Mimikatz (`kerberos::list /export`)
  - Rubeus
- **ÐžÐ±Ð½Ð°Ñ€ÑƒÐ¶ÐµÐ½Ð¸Ðµ**:
  - ÐŸÐ¾Ð²Ñ‚Ð¾Ñ€Ð½Ð¾Ðµ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¾Ð´Ð½Ð¾Ð³Ð¾ Ð¸ Ñ‚Ð¾Ð³Ð¾ Ð¶Ðµ Ð±Ð¸Ð»ÐµÑ‚Ð°.
  - ÐÐºÑ‚Ð¸Ð²Ð½Ð¾ÑÑ‚ÑŒ Ð¸Ð· Ñ€Ð°Ð·Ð½Ñ‹Ñ… Ñ…Ð¾ÑÑ‚Ð¾Ð² Ñ Ð¾Ð´Ð¸Ð½Ð°ÐºÐ¾Ð²Ñ‹Ð¼ Ð±Ð¸Ð»ÐµÑ‚Ð¾Ð¼.

### 2.3.4. Kerberoasting

- **ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ**: Ð—Ð°Ð¿Ñ€Ð¾Ñ TGS Ð´Ð»Ñ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒÑÐºÐ¸Ñ… SPN Ñ Ð¿Ð¾ÑÐ»ÐµÐ´ÑƒÑŽÑ‰Ð¸Ð¼ Ð¾Ñ„Ñ„Ð»Ð°Ð¹Ð½-Ð¿ÐµÑ€ÐµÐ±Ð¾Ñ€Ð¾Ð¼ Ñ…ÑÑˆÐµÐ¹.
- **Ð¦ÐµÐ»ÑŒ**: ÐŸÐ¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ðµ Ð¿Ð°Ñ€Ð¾Ð»ÐµÐ¹ Ð¾Ñ‚ ÑƒÑ‡ÐµÑ‚Ð½Ñ‹Ñ… Ð·Ð°Ð¿Ð¸ÑÐµÐ¹ ÑÐµÑ€Ð²Ð¸ÑÐ¾Ð².
- **ÐœÐµÑ‚Ð¾Ð´Ñ‹ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ñ**:
  - `GetUserSPNs.py` (Impacket)
  - Rubeus
- **ÐžÐ±Ð½Ð°Ñ€ÑƒÐ¶ÐµÐ½Ð¸Ðµ**:
  - ÐœÐ½Ð¾Ð¶ÐµÑÑ‚Ð²Ð¾ Ð·Ð°Ð¿Ñ€Ð¾ÑÐ¾Ð² TGS Ðº Ñ€Ð°Ð·Ð½Ñ‹Ð¼ SPN.
  - Ð’Ñ‹ÑÐ¾ÐºÐ°Ñ Ñ‡Ð°ÑÑ‚Ð¾Ñ‚Ð° Ñ‚Ð°ÐºÐ¸Ñ… Ð·Ð°Ð¿Ñ€Ð¾ÑÐ¾Ð².

### 2.3.5. AS-REP Roasting

- **ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ**: ÐŸÐ¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ðµ Ñ‡Ð°ÑÑ‚Ð¸ Ð·Ð°ÑˆÐ¸Ñ„Ñ€Ð¾Ð²Ð°Ð½Ð½Ð¾Ð³Ð¾ Ð¾Ñ‚Ð²ÐµÑ‚Ð° AS-REP Ð±ÐµÐ· Ð¿Ñ€ÐµÐ´Ð²Ð°Ñ€Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ð¹ Ð°ÑƒÑ‚ÐµÐ½Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸Ð¸.
- **Ð£ÑÐ»Ð¾Ð²Ð¸Ðµ**: Ð’Ñ‹ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ pre-authentication Ñƒ Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»Ñ‘Ð½Ð½Ñ‹Ñ… Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÐµÐ¹.
- **ÐœÐµÑ‚Ð¾Ð´Ñ‹ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ñ**:
  - Rubeus (`asreproast`)
- **ÐžÐ±Ð½Ð°Ñ€ÑƒÐ¶ÐµÐ½Ð¸Ðµ**:
  - ÐœÐ½Ð¾Ð¶ÐµÑÑ‚Ð²Ð¾ Ð·Ð°Ð¿Ñ€Ð¾ÑÐ¾Ð² AS-REQ Ð±ÐµÐ· Ð¿Ð¾ÑÐ»ÐµÐ´ÑƒÑŽÑ‰ÐµÐ³Ð¾ Ð¾Ñ‚Ð²ÐµÑ‚Ð° ÐºÐ»Ð¸ÐµÐ½Ñ‚Ð°.
  - Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÐµÐ¹ Ñ Ð²Ñ‹ÐºÐ»ÑŽÑ‡ÐµÐ½Ð½Ð¾Ð¹ pre-authentication.

### 2.3.6. Brute-force Ð°Ñ‚Ð°ÐºÐ¸ Ñ‡ÐµÑ€ÐµÐ· Kerberos

- **ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ**: ÐŸÐµÑ€ÐµÐ±Ð¾Ñ€ Ð¿Ð°Ñ€Ð¾Ð»ÐµÐ¹ Ð¿ÑƒÑ‚Ñ‘Ð¼ Ð¼Ð½Ð¾Ð¶ÐµÑÑ‚Ð²ÐµÐ½Ð½Ñ‹Ñ… Ð¿Ð¾Ð¿Ñ‹Ñ‚Ð¾Ðº Ð°ÑƒÑ‚ÐµÐ½Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸Ð¸.
- **ÐœÐµÑ‚Ð¾Ð´Ñ‹ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ñ**:
  - Kerbrute
  - Rubeus
- **ÐžÐ±Ð½Ð°Ñ€ÑƒÐ¶ÐµÐ½Ð¸Ðµ**:
  - Ð¡ÐµÑ€Ð¸Ñ ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ð¹ 4771 Ñ Ð¾ÑˆÐ¸Ð±ÐºÐ¾Ð¹ "bad password".
  - ÐŸÐ¾Ð²Ñ‚Ð¾Ñ€Ð½Ñ‹Ðµ Ð¿Ð¾Ð¿Ñ‹Ñ‚ÐºÐ¸ Ð²Ñ…Ð¾Ð´Ð° Ð¾Ñ‚ Ð¾Ð´Ð½Ð¾Ð³Ð¾ IP-Ð°Ð´Ñ€ÐµÑÐ° Ð¸Ð»Ð¸ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ.

---

## 2.4. MITRE ATT&CK Ð¸ ÐºÐ»Ð°ÑÑÐ¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸Ñ Ð°Ñ‚Ð°Ðº Ð½Ð° Kerberos

MITRE ATT&CK Framework Ð¿Ñ€ÐµÐ´Ð¾ÑÑ‚Ð°Ð²Ð»ÑÐµÑ‚ ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ð¾Ðµ Ð¾Ð¿Ð¸ÑÐ°Ð½Ð¸Ðµ Ñ‚Ð°ÐºÑ‚Ð¸Ðº Ð¸ Ñ‚ÐµÑ…Ð½Ð¸Ðº, Ð¿Ñ€Ð¸Ð¼ÐµÐ½ÑÐµÐ¼Ñ‹Ñ… Ð·Ð»Ð¾ÑƒÐ¼Ñ‹ÑˆÐ»ÐµÐ½Ð½Ð¸ÐºÐ°Ð¼Ð¸. ÐÐµÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ðµ Ð¸Ð· Ð½Ð¸Ñ… Ð½Ð°Ð¿Ñ€ÑÐ¼ÑƒÑŽ ÑÐ²ÑÐ·Ð°Ð½Ñ‹ Ñ Ð¿Ñ€Ð¾Ñ‚Ð¾ÐºÐ¾Ð»Ð¾Ð¼ Kerberos:

| ID Ñ‚ÐµÑ…Ð½Ð¸ÐºÐ¸ | ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ | ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ |
|------------|----------|----------|
| T1097      | Pass the Ticket | Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ðµ ÑƒÐºÑ€Ð°Ð´ÐµÐ½Ð½Ñ‹Ñ… Ð±Ð¸Ð»ÐµÑ‚Ð¾Ð² Kerberos |
| T1558      | Steal or Forge Kerberos Tickets | Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ð¿Ð¾Ð´Ð´ÐµÐ»ÑŒÐ½Ñ‹Ñ… Ð±Ð¸Ð»ÐµÑ‚Ð¾Ð² (Golden/Silver Ticket) |
| T1485      | Kerberoasting | Ð—Ð°Ð¿Ñ€Ð¾Ñ Ð¸ Ð¿ÐµÑ€ÐµÐ±Ð¾Ñ€ TGS-Ð±Ð¸Ð»ÐµÑ‚Ð¾Ð² |
| T1533      | Account Manipulation | Ð˜Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ðµ Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ð¾Ð² ÑƒÑ‡ÐµÑ‚Ð½Ñ‹Ñ… Ð·Ð°Ð¿Ð¸ÑÐµÐ¹ Ð´Ð»Ñ Ð¾Ð±Ð»ÐµÐ³Ñ‡ÐµÐ½Ð¸Ñ Ð°Ñ‚Ð°Ðº |
| T1078      | Valid Accounts | Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð»ÐµÐ³Ð¸Ñ‚Ð¸Ð¼Ð½Ñ‹Ñ… ÑƒÑ‡ÐµÑ‚Ð½Ñ‹Ñ… Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð´Ð»Ñ Ð²Ñ…Ð¾Ð´Ð° |

---

## 2.5. Ð—Ð°ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ Ð¿Ð¾ Ð³Ð»Ð°Ð²Ðµ

Ð’ Ð´Ð°Ð½Ð½Ð¾Ð¹ Ð³Ð»Ð°Ð²Ðµ Ð±Ñ‹Ð»Ð¸ Ñ€Ð°ÑÑÐ¼Ð¾Ñ‚Ñ€ÐµÐ½Ñ‹ Ð°Ñ€Ñ…Ð¸Ñ‚ÐµÐºÑ‚ÑƒÑ€Ð° Ð¸ Ð¿Ñ€Ð¸Ð½Ñ†Ð¸Ð¿Ñ‹ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¾Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ Ð¿Ñ€Ð¾Ñ‚Ð¾ÐºÐ¾Ð»Ð° Kerberos, ÐµÐ³Ð¾ Ñ€Ð¾Ð»ÑŒ Ð² ÑÑ€ÐµÐ´Ðµ Microsoft Active Directory, Ð° Ñ‚Ð°ÐºÐ¶Ðµ Ñ‚Ð¸Ð¿Ð¾Ð²Ñ‹Ðµ Ð°Ñ‚Ð°ÐºÐ¸, Ð½Ð°Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð½Ñ‹Ðµ Ð½Ð° Ð¾Ð±Ñ…Ð¾Ð´ Ð»ÐµÐ³Ð¸Ñ‚Ð¸Ð¼Ð½Ð¾Ð¹ Ð°ÑƒÑ‚ÐµÐ½Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸Ð¸. Ð‘Ñ‹Ð»Ð¾ Ð¿Ð¾ÐºÐ°Ð·Ð°Ð½Ð¾, Ñ‡Ñ‚Ð¾ Ð±Ð¾Ð»ÑŒÑˆÐ¸Ð½ÑÑ‚Ð²Ð¾ ÑÐ¾Ð²Ñ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ñ… Ð¼ÐµÑ‚Ð¾Ð´Ð¾Ð² Ð°Ñ‚Ð°Ðº Ð½Ð° Ð´Ð¾Ð¼ÐµÐ½Ð½Ñ‹Ðµ ÑÐµÑ‚Ð¸ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÑŽÑ‚ Kerberos ÐºÐ°Ðº Ð²ÐµÐºÑ‚Ð¾Ñ€ Ð¿Ñ€Ð¾Ð½Ð¸ÐºÐ½Ð¾Ð²ÐµÐ½Ð¸Ñ, Ñ‡Ñ‚Ð¾ Ð¿Ð¾Ð´Ñ‡ÐµÑ€ÐºÐ¸Ð²Ð°ÐµÑ‚ Ð½ÐµÐ¾Ð±Ñ…Ð¾Ð´Ð¸Ð¼Ð¾ÑÑ‚ÑŒ Ð²Ð½ÐµÐ´Ñ€ÐµÐ½Ð¸Ñ ÑÐ¸ÑÑ‚ÐµÐ¼ Ð¾Ð±Ð½Ð°Ñ€ÑƒÐ¶ÐµÐ½Ð¸Ñ Ñ‚Ð°ÐºÐ¸Ñ… ÑƒÐ³Ñ€Ð¾Ð·.

Ð­Ñ‚Ð¸ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð¿Ð¾ÑÐ»ÑƒÐ¶Ð°Ñ‚ Ð¾ÑÐ½Ð¾Ð²Ð¾Ð¹ Ð´Ð»Ñ Ð´Ð°Ð»ÑŒÐ½ÐµÐ¹ÑˆÐµÐ³Ð¾ Ð°Ð½Ð°Ð»Ð¸Ð·Ð° Ð¿Ð¾Ð²ÐµÐ´ÐµÐ½Ñ‡ÐµÑÐºÐ¸Ñ… Ð¼Ð¾Ð´ÐµÐ»ÐµÐ¹ Ð¸ Ñ€Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¸ Ð¿Ñ€Ð¾Ð³Ñ€Ð°Ð¼Ð¼Ð½Ð¾Ð³Ð¾ Ð¾Ð±ÐµÑÐ¿ÐµÑ‡ÐµÐ½Ð¸Ñ, ÑÐ¿Ð¾ÑÐ¾Ð±Ð½Ð¾Ð³Ð¾ Ð²Ñ‹ÑÐ²Ð»ÑÑ‚ÑŒ Ð°Ñ‚Ð°ÐºÐ¸ Ð½Ð° Ð¾ÑÐ½Ð¾Ð²Ðµ Ð°Ð½Ð¾Ð¼Ð°Ð»ÑŒÐ½Ð¾Ð³Ð¾ Ð¿Ð¾Ð²ÐµÐ´ÐµÐ½Ð¸Ñ Kerberos-ÑÐµÑÑÐ¸Ð¹.

---
---

# ðŸ“˜ Ð“Ð»Ð°Ð²Ð° 3. ÐÐ½Ð°Ð»Ð¸Ð· Ð°Ñ‚Ð°Ðº Ð¸ Ð²Ñ‹ÑÐ²Ð»ÐµÐ½Ð¸Ðµ Ð°Ð½Ð¾Ð¼Ð°Ð»Ð¸Ð¹

## 3.1. Ð¥Ð°Ñ€Ð°ÐºÑ‚ÐµÑ€Ð¸ÑÑ‚Ð¸ÐºÐ¸ Ð½Ð¾Ñ€Ð¼Ð°Ð»ÑŒÐ½Ð¾Ð³Ð¾ Ð¿Ð¾Ð²ÐµÐ´ÐµÐ½Ð¸Ñ Ð² Kerberos-ÑÐµÑÑÐ¸ÑÑ…

Ð”Ð»Ñ ÑÑ„Ñ„ÐµÐºÑ‚Ð¸Ð²Ð½Ð¾Ð³Ð¾ Ð¾Ð±Ð½Ð°Ñ€ÑƒÐ¶ÐµÐ½Ð¸Ñ Ð°Ñ‚Ð°Ðº Ð½Ð° Ð¿Ñ€Ð¾Ñ‚Ð¾ÐºÐ¾Ð» Kerberos Ð½ÐµÐ¾Ð±Ñ…Ð¾Ð´Ð¸Ð¼Ð¾ Ð¿Ð¾Ð½Ð¸Ð¼Ð°Ñ‚ÑŒ, ÐºÐ°Ðº Ð²Ñ‹Ð³Ð»ÑÐ´Ð¸Ñ‚ **Ð½Ð¾Ñ€Ð¼Ð°Ð»ÑŒÐ½Ð¾Ðµ Ð¿Ð¾Ð²ÐµÐ´ÐµÐ½Ð¸Ðµ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÐµÐ¹ Ð¸ ÑÐµÑ€Ð²Ð¸ÑÐ¾Ð²** Ð² Ð´Ð¾Ð¼ÐµÐ½Ð½Ð¾Ð¹ ÑÑ€ÐµÐ´Ðµ Active Directory. Ð­Ñ‚Ð¾ Ð¿Ð¾Ð·Ð²Ð¾Ð»ÑÐµÑ‚ ÑÐ¾Ð·Ð´Ð°Ñ‚ÑŒ **Ð±Ð°Ð·Ð¾Ð²Ñ‹Ðµ Ð¼Ð¾Ð´ÐµÐ»Ð¸ Ð¿Ð¾Ð²ÐµÐ´ÐµÐ½Ð¸Ñ (baseline)**, Ð¿Ð¾ ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¼ Ð¼Ð¾Ð¶Ð½Ð¾ ÑÑ€Ð°Ð²Ð½Ð¸Ð²Ð°Ñ‚ÑŒ Ñ‚ÐµÐºÑƒÑ‰ÑƒÑŽ Ð°ÐºÑ‚Ð¸Ð²Ð½Ð¾ÑÑ‚ÑŒ Ð¸ Ð²Ñ‹ÑÐ²Ð»ÑÑ‚ÑŒ Ð¾Ñ‚ÐºÐ»Ð¾Ð½ÐµÐ½Ð¸Ñ.

### 3.1.1. ÐžÐ±Ñ‹Ñ‡Ð½Ñ‹Ðµ ÑÑ†ÐµÐ½Ð°Ñ€Ð¸Ð¸ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ñ Kerberos:

#### a) ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒÑÐºÐ¸Ð¹ Ð²Ñ…Ð¾Ð´:
- ÐŸÑ€Ð¸ Ð²Ñ…Ð¾Ð´Ðµ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ Ð² ÑÐ¸ÑÑ‚ÐµÐ¼Ñƒ Ð·Ð°Ð¿Ñ€Ð°ÑˆÐ¸Ð²Ð°ÐµÑ‚ÑÑ **TGT (Ticket Granting Ticket)**.
- Ð—Ð°Ñ‚ÐµÐ¼ Ð·Ð°Ð¿Ñ€Ð°ÑˆÐ¸Ð²Ð°ÑŽÑ‚ÑÑ **TGS (Ticket Granting Service tickets)** Ð´Ð»Ñ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð° Ðº Ñ€ÐµÑÑƒÑ€ÑÐ°Ð¼: Ñ„Ð°Ð¹Ð»Ð¾Ð²Ñ‹Ð¼ ÑÐµÑ€Ð²ÐµÑ€Ð°Ð¼, Ð¿Ð¾Ñ‡Ñ‚Ð¾Ð²Ñ‹Ð¼ ÑÐµÑ€Ð²Ð¸ÑÐ°Ð¼ Ð¸ Ñ‚.Ð´.
- Ð”Ð¾ÑÑ‚ÑƒÐ¿ Ðº Ñ€ÐµÑÑƒÑ€ÑÐ°Ð¼ Ð¾ÑÑƒÑ‰ÐµÑÑ‚Ð²Ð»ÑÐµÑ‚ÑÑ Ñ‡ÐµÑ€ÐµÐ· **AP-REQ / AP-REP** ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ.

#### b) Ð¡ÐµÑ€Ð²Ð¸ÑÐ½Ð¾Ðµ Ð²Ð·Ð°Ð¸Ð¼Ð¾Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ðµ:
- Ð¡ÐµÑ€Ð²Ð¸ÑÑ‹ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÑŽÑ‚ ÑÐ²Ð¾Ð¸ ÑƒÑ‡ÐµÑ‚Ð½Ñ‹Ðµ Ð·Ð°Ð¿Ð¸ÑÐ¸ Ð¸ SPN (Service Principal Name).
- ÐžÐ½Ð¸ Ð¼Ð¾Ð³ÑƒÑ‚ Ð·Ð°Ð¿Ñ€Ð°ÑˆÐ¸Ð²Ð°Ñ‚ÑŒ Ð±Ð¸Ð»ÐµÑ‚Ñ‹ Ð½Ð° Ð´Ñ€ÑƒÐ³Ð¸Ðµ ÑÐµÑ€Ð²Ð¸ÑÑ‹ (Ð´ÐµÐ»ÐµÐ³Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ).

#### c) ÐžÐ±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ Ð±Ð¸Ð»ÐµÑ‚Ð¾Ð²:
- Ð‘Ð¸Ð»ÐµÑ‚Ñ‹ Ð¸Ð¼ÐµÑŽÑ‚ Ð¾Ð³Ñ€Ð°Ð½Ð¸Ñ‡ÐµÐ½Ð½Ð¾Ðµ Ð²Ñ€ÐµÐ¼Ñ Ð¶Ð¸Ð·Ð½Ð¸ (Ð¾Ð±Ñ‹Ñ‡Ð½Ð¾ Ð´Ð¾ 10 Ñ‡Ð°ÑÐ¾Ð²).
- ÐŸÐµÑ€ÐµÐ´ Ð¸ÑÑ‚ÐµÑ‡ÐµÐ½Ð¸ÐµÐ¼ ÑÑ€Ð¾ÐºÐ° Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ñ Ð¾Ð½Ð¸ Ð¼Ð¾Ð³ÑƒÑ‚ Ð±Ñ‹Ñ‚ÑŒ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ñ‹ Ð±ÐµÐ· Ð¿Ð¾Ð²Ñ‚Ð¾Ñ€Ð½Ð¾Ð¹ Ð°ÑƒÑ‚ÐµÐ½Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸Ð¸.

### 3.1.2. Ð¢Ð¸Ð¿Ð¸Ñ‡Ð½Ñ‹Ðµ Ð¿Ð¾ÐºÐ°Ð·Ð°Ñ‚ÐµÐ»Ð¸ Ð°ÐºÑ‚Ð¸Ð²Ð½Ð¾ÑÑ‚Ð¸ Kerberos:

| ÐœÐµÑ‚Ñ€Ð¸ÐºÐ° | ÐÐ¾Ñ€Ð¼Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ð´Ð¸Ð°Ð¿Ð°Ð·Ð¾Ð½ |
|--------|---------------------|
| ÐšÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ TGT Ð·Ð° Ð´ÐµÐ½ÑŒ | 1â€“3 Ð½Ð° Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ |
| ÐšÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ TGS Ð·Ð° Ð´ÐµÐ½ÑŒ | 5â€“20 Ð½Ð° Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ |
| Ð¡Ñ€ÐµÐ´Ð½ÐµÐµ TTL Ð±Ð¸Ð»ÐµÑ‚Ð° | 6â€“10 Ñ‡Ð°ÑÐ¾Ð² |
| Ð§Ð°ÑÑ‚Ð¾Ñ‚Ð° Ð¾Ð±Ñ€Ð°Ñ‰ÐµÐ½Ð¸Ð¹ Ðº KDC | Ð Ð°Ð²Ð½Ð¾Ð¼ÐµÑ€Ð½Ð¾Ðµ Ñ€Ð°ÑÐ¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð¸Ðµ Ð² Ñ‚ÐµÑ‡ÐµÐ½Ð¸Ðµ Ñ€Ð°Ð±Ð¾Ñ‡ÐµÐ³Ð¾ Ð´Ð½Ñ |
| ÐžÑˆÐ¸Ð±ÐºÐ¸ Ð°ÑƒÑ‚ÐµÐ½Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸Ð¸ (ID 4771) | 0â€“2 Ð¿Ð¾Ð¿Ñ‹Ñ‚ÐºÐ¸ Ð½Ð° Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ |

### 3.1.3. ÐŸÑ€Ð¾Ñ„Ð¸Ð»Ð¸ Ð¿Ð¾Ð²ÐµÐ´ÐµÐ½Ð¸Ñ:

#### a) ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒÑÐºÐ¸Ð¹ Ð¿Ñ€Ð¾Ñ„Ð¸Ð»ÑŒ:
- Ð’Ñ€ÐµÐ¼Ñ Ð²Ñ…Ð¾Ð´Ð° (Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, ÑƒÑ‚Ñ€Ð¾, Ð±ÑƒÐ´Ð½Ð¸Ðµ Ð´Ð½Ð¸).
- Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÐ¼Ñ‹Ðµ SPN: Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, CIFS/fileserver, HTTP/webapp.
- Ð“ÐµÐ¾Ð³Ñ€Ð°Ñ„Ð¸Ñ‡ÐµÑÐºÐ¾Ðµ Ñ€Ð°ÑÐ¿Ð¾Ð»Ð¾Ð¶ÐµÐ½Ð¸Ðµ (IP-Ð°Ð´Ñ€ÐµÑ, Ð»Ð¾Ð³Ð¸Ñ‡ÐµÑÐºÐ°Ñ Ð·Ð¾Ð½Ð° ÑÐµÑ‚Ð¸).

#### b) Ð¡ÐµÑ€Ð²Ð¸ÑÐ½Ñ‹Ð¹ Ð¿Ñ€Ð¾Ñ„Ð¸Ð»ÑŒ:
- Ð ÐµÐ³ÑƒÐ»ÑÑ€Ð½Ñ‹Ðµ Ð·Ð°Ð¿Ñ€Ð¾ÑÑ‹ Ðº Ð´Ñ€ÑƒÐ³Ð¸Ð¼ ÑÐµÑ€Ð²Ð¸ÑÐ°Ð¼.
- Ð¤Ð¸ÐºÑÐ¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ð¾Ðµ Ð²Ñ€ÐµÐ¼Ñ Ð°ÐºÑ‚Ð¸Ð²Ð½Ð¾ÑÑ‚Ð¸ (Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, Ð½Ð¾Ñ‡ÑŒÑŽ â€” Ð±ÑÐºÐ°Ð¿Ñ‹, Ð·Ð°Ð´Ð°Ð½Ð¸Ñ Ð¿Ð»Ð°Ð½Ð¸Ñ€Ð¾Ð²Ñ‰Ð¸ÐºÐ°).
- Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ðµ ÐºÐ¾Ð½ÐºÑ€ÐµÑ‚Ð½Ñ‹Ñ… SPN.

#### c) ÐÐ´Ð¼Ð¸Ð½Ð¸ÑÑ‚Ñ€Ð°Ñ‚Ð¾Ñ€ÑÐºÐ¸Ð¹ Ð¿Ñ€Ð¾Ñ„Ð¸Ð»ÑŒ:
- Ð”Ð¾ÑÑ‚ÑƒÐ¿ Ðº ÐºÑ€Ð¸Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ð¼ Ñ€ÐµÑÑƒÑ€ÑÐ°Ð¼ (Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, ÐºÐ¾Ð½Ñ‚Ñ€Ð¾Ð»Ð»ÐµÑ€ Ð´Ð¾Ð¼ÐµÐ½Ð°, SQL-ÑÐµÑ€Ð²ÐµÑ€).
- Ð’Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ðµ Ð¿Ñ€Ð¸Ð²Ð¸Ð»ÐµÐ³Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ñ‹Ñ… Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸Ð¹ (Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, ÑƒÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ GPO, Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ðµ Ð¿Ð¾Ð»Ð¸Ñ‚Ð¸Ðº Kerberos).

---

## 3.2. ÐŸÑ€Ð¸Ð·Ð½Ð°ÐºÐ¸ Ð°Ñ‚Ð°Ðº Ð½Ð° Ð¿Ñ€Ð¾Ñ‚Ð¾ÐºÐ¾Ð» Kerberos

ÐÐµÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ðµ Ð¸Ð· Ð½Ð°Ð¸Ð±Ð¾Ð»ÐµÐµ Ñ€Ð°ÑÐ¿Ñ€Ð¾ÑÑ‚Ñ€Ð°Ð½Ñ‘Ð½Ð½Ñ‹Ñ… Ð°Ñ‚Ð°Ðº Ð½Ð° Ð¿Ñ€Ð¾Ñ‚Ð¾ÐºÐ¾Ð» Kerberos Ð¾ÑÑ‚Ð°Ð²Ð»ÑÑŽÑ‚ Ñ…Ð°Ñ€Ð°ÐºÑ‚ÐµÑ€Ð½Ñ‹Ðµ ÑÐ»ÐµÐ´Ñ‹ Ð² ÑÐµÑ‚ÐµÐ²Ð¾Ð¼ Ñ‚Ñ€Ð°Ñ„Ð¸ÐºÐµ Ð¸ Ð»Ð¾Ð³Ð°Ñ… ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ð¹ Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚Ð¸ Windows. Ð­Ñ‚Ð¸ Ð¸Ð½Ð´Ð¸ÐºÐ°Ñ‚Ð¾Ñ€Ñ‹ Ð¼Ð¾Ð³ÑƒÑ‚ Ð±Ñ‹Ñ‚ÑŒ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ñ‹ Ð´Ð»Ñ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¾Ð³Ð¾ Ð¾Ð±Ð½Ð°Ñ€ÑƒÐ¶ÐµÐ½Ð¸Ñ ÑƒÐ³Ñ€Ð¾Ð·.

### 3.2.1. Golden Ticket

- **ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ**: Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ð¿Ð¾Ð´Ð´ÐµÐ»ÑŒÐ½Ð¾Ð³Ð¾ TGT Ð²Ð½Ðµ ÑÐ¸ÑÑ‚ÐµÐ¼Ñ‹, Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÑ Ñ…ÑÑˆ ÑƒÑ‡ÐµÑ‚Ð½Ð¾Ð¹ Ð·Ð°Ð¿Ð¸ÑÐ¸ krbtgt.
- **Ð¦ÐµÐ»ÑŒ**: ÐŸÐ¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ðµ Ð½ÐµÐ¾Ð³Ñ€Ð°Ð½Ð¸Ñ‡ÐµÐ½Ð½Ð¾Ð³Ð¾ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð° ÐºÐ¾ Ð²ÑÐµÐ¼ Ñ€ÐµÑÑƒÑ€ÑÐ°Ð¼ Ð´Ð¾Ð¼ÐµÐ½Ð°.
- **ÐŸÑ€Ð¸Ð·Ð½Ð°ÐºÐ¸:**
  - Ð”Ð»Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ðµ Ð²Ñ€ÐµÐ¼Ñ Ð¶Ð¸Ð·Ð½Ð¸ Ð±Ð¸Ð»ÐµÑ‚Ð° (Ð´Ð¾ Ð½ÐµÑÐºÐ¾Ð»ÑŒÐºÐ¸Ñ… Ð´Ð½ÐµÐ¹).
  - ÐžÑ‚ÑÑƒÑ‚ÑÑ‚Ð²Ð¸Ðµ ÑÐ¾Ð¾Ñ‚Ð²ÐµÑ‚ÑÑ‚Ð²ÑƒÑŽÑ‰ÐµÐ³Ð¾ ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ñ Ð²Ñ…Ð¾Ð´Ð° Ð² ÑÐ¸ÑÑ‚ÐµÐ¼Ñƒ.
  - Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð½ÐµÑÑ‚Ð°Ð½Ð´Ð°Ñ€Ñ‚Ð½Ð¾Ð³Ð¾ Ð¸Ð¼ÐµÐ½Ð¸ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ Ð¸Ð»Ð¸ Ð³Ñ€ÑƒÐ¿Ð¿Ñ‹.
- **Ð›Ð¾Ð³Ð¸ Windows (Event ID):** 4768, 4769, 4624 (Ð¿Ñ€Ð¸ Ð²Ñ…Ð¾Ð´Ðµ).

### 3.2.2. Silver Ticket

- **ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ**: ÐŸÐ¾Ð´Ð´ÐµÐ»ÐºÐ° TGS-Ð±Ð¸Ð»ÐµÑ‚Ð° Ð´Ð»Ñ ÐºÐ¾Ð½ÐºÑ€ÐµÑ‚Ð½Ð¾Ð³Ð¾ ÑÐµÑ€Ð²Ð¸ÑÐ° Ñ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸ÐµÐ¼ Ñ…ÑÑˆÐ° ÐµÐ³Ð¾ ÑƒÑ‡ÐµÑ‚Ð½Ð¾Ð¹ Ð·Ð°Ð¿Ð¸ÑÐ¸.
- **Ð¦ÐµÐ»ÑŒ**: ÐŸÐ¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ðµ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð° Ðº Ð¾Ð´Ð½Ð¾Ð¼Ñƒ ÑÐµÑ€Ð²Ð¸ÑÑƒ Ð±ÐµÐ· Ð¾Ð±Ñ€Ð°Ñ‰ÐµÐ½Ð¸Ñ Ðº KDC.
- **ÐŸÑ€Ð¸Ð·Ð½Ð°ÐºÐ¸:**
  - ÐžÑ‚ÑÑƒÑ‚ÑÑ‚Ð²Ð¸Ðµ Ð¿Ñ€ÐµÐ´ÑˆÐµÑÑ‚Ð²ÑƒÑŽÑ‰ÐµÐ³Ð¾ TGT.
  - Ð—Ð°Ð¿Ñ€Ð¾ÑÑ‹ Ðº Ð½ÐµÐ¾Ð±Ñ‹Ñ‡Ð½Ñ‹Ð¼ SPN.
  - ÐŸÐ¾Ð¿Ñ‹Ñ‚ÐºÐ¸ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð° Ðº ÑÐµÑ€Ð²Ð¸ÑÐ°Ð¼ Ð±ÐµÐ· Ð¿Ñ€Ð¾Ñ…Ð¾Ð¶Ð´ÐµÐ½Ð¸Ñ Ð¿Ð¾Ð»Ð½Ð¾Ð¹ Ð°ÑƒÑ‚ÐµÐ½Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸Ð¸.
- **Ð›Ð¾Ð³Ð¸ Windows (Event ID):** 4769, 4624, 4625.

### 3.2.3. Kerberoasting

- **ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ**: Ð—Ð°Ð¿Ñ€Ð¾Ñ TGS Ð´Ð»Ñ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒÑÐºÐ¸Ñ… SPN Ñ Ð¿Ð¾ÑÐ»ÐµÐ´ÑƒÑŽÑ‰Ð¸Ð¼ Ð¾Ñ„Ñ„Ð»Ð°Ð¹Ð½-Ð¿ÐµÑ€ÐµÐ±Ð¾Ñ€Ð¾Ð¼ Ñ…ÑÑˆÐµÐ¹.
- **Ð¦ÐµÐ»ÑŒ**: ÐŸÐ¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ðµ Ð¿Ð°Ñ€Ð¾Ð»ÐµÐ¹ Ð¾Ñ‚ ÑƒÑ‡ÐµÑ‚Ð½Ñ‹Ñ… Ð·Ð°Ð¿Ð¸ÑÐµÐ¹ ÑÐµÑ€Ð²Ð¸ÑÐ¾Ð².
- **ÐŸÑ€Ð¸Ð·Ð½Ð°ÐºÐ¸:**
  - ÐœÐ½Ð¾Ð¶ÐµÑÑ‚Ð²Ð¾ Ð·Ð°Ð¿Ñ€Ð¾ÑÐ¾Ð² TGS Ðº Ñ€Ð°Ð·Ð½Ñ‹Ð¼ SPN.
  - Ð—Ð°Ð¿Ñ€Ð¾ÑÑ‹ Ðº SPN, ÑÐ²ÑÐ·Ð°Ð½Ð½Ñ‹Ð¼ Ñ ÑƒÑ‡ÐµÑ‚Ð½Ñ‹Ð¼Ð¸ Ð·Ð°Ð¿Ð¸ÑÑÐ¼Ð¸ ÑÐµÑ€Ð²Ð¸ÑÐ¾Ð² (Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, MSSQLSvc, HTTP).
  - Ð’Ñ‹ÑÐ¾ÐºÐ°Ñ Ñ‡Ð°ÑÑ‚Ð¾Ñ‚Ð° Ñ‚Ð°ÐºÐ¸Ñ… Ð·Ð°Ð¿Ñ€Ð¾ÑÐ¾Ð² Ð² ÐºÐ¾Ñ€Ð¾Ñ‚ÐºÐ¸Ð¹ Ð¿Ñ€Ð¾Ð¼ÐµÐ¶ÑƒÑ‚Ð¾Ðº Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸.
- **Ð›Ð¾Ð³Ð¸ Windows (Event ID):** 4769.

### 3.2.4. AS-REP Roasting

- **ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ**: ÐŸÐ¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ðµ Ñ‡Ð°ÑÑ‚Ð¸ Ð·Ð°ÑˆÐ¸Ñ„Ñ€Ð¾Ð²Ð°Ð½Ð½Ð¾Ð³Ð¾ Ð¾Ñ‚Ð²ÐµÑ‚Ð° AS-REP Ð±ÐµÐ· Ð¿Ñ€ÐµÐ´Ð²Ð°Ñ€Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ð¹ Ð°ÑƒÑ‚ÐµÐ½Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸Ð¸.
- **Ð£ÑÐ»Ð¾Ð²Ð¸Ðµ**: Ð’Ñ‹ÐºÐ»ÑŽÑ‡ÐµÐ½Ð½Ð°Ñ pre-authentication.
- **ÐŸÑ€Ð¸Ð·Ð½Ð°ÐºÐ¸:**
  - ÐœÐ½Ð¾Ð¶ÐµÑÑ‚Ð²Ð¾ Ð·Ð°Ð¿Ñ€Ð¾ÑÐ¾Ð² AS-REQ Ð±ÐµÐ· Ð¿Ð¾ÑÐ»ÐµÐ´ÑƒÑŽÑ‰ÐµÐ³Ð¾ Ð¾Ñ‚Ð²ÐµÑ‚Ð° ÐºÐ»Ð¸ÐµÐ½Ñ‚Ð°.
  - Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÐµÐ¹ Ñ Ð²Ñ‹ÐºÐ»ÑŽÑ‡ÐµÐ½Ð½Ð¾Ð¹ pre-authentication.
- **Ð›Ð¾Ð³Ð¸ Windows (Event ID):** 4771 (Ð¾ÑˆÐ¸Ð±ÐºÐ° "KDC_ERR_PREAUTH_REQUIRED" Ð¾Ñ‚ÑÑƒÑ‚ÑÑ‚Ð²ÑƒÐµÑ‚).

### 3.2.5. Pass-the-Ticket

- **ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ**: Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ðµ ÑƒÐºÑ€Ð°Ð´ÐµÐ½Ð½Ð¾Ð³Ð¾ Ð±Ð¸Ð»ÐµÑ‚Ð° Ð±ÐµÐ· Ñ€Ð°ÑÑˆÐ¸Ñ„Ñ€Ð¾Ð²ÐºÐ¸.
- **ÐŸÑ€Ð¸Ð·Ð½Ð°ÐºÐ¸:**
  - ÐŸÐ¾Ð²Ñ‚Ð¾Ñ€Ð½Ð¾Ðµ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¾Ð´Ð½Ð¾Ð³Ð¾ Ð¸ Ñ‚Ð¾Ð³Ð¾ Ð¶Ðµ Ð±Ð¸Ð»ÐµÑ‚Ð°.
  - ÐÐºÑ‚Ð¸Ð²Ð½Ð¾ÑÑ‚ÑŒ Ð¸Ð· Ñ€Ð°Ð·Ð½Ñ‹Ñ… Ñ…Ð¾ÑÑ‚Ð¾Ð² Ñ Ð¾Ð´Ð¸Ð½Ð°ÐºÐ¾Ð²Ñ‹Ð¼ Ð±Ð¸Ð»ÐµÑ‚Ð¾Ð¼.
  - ÐžÑ‚ÑÑƒÑ‚ÑÑ‚Ð²Ð¸Ðµ ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ð¹ Ð°ÑƒÑ‚ÐµÐ½Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸Ð¸ Ð´Ð¾ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ñ Ð±Ð¸Ð»ÐµÑ‚Ð°.
- **Ð›Ð¾Ð³Ð¸ Windows (Event ID):** 4624, 4672.

### 3.2.6. Brute-force Ñ‡ÐµÑ€ÐµÐ· Kerberos

- **ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ**: ÐŸÐµÑ€ÐµÐ±Ð¾Ñ€ Ð¿Ð°Ñ€Ð¾Ð»ÐµÐ¹ Ð¿ÑƒÑ‚Ñ‘Ð¼ Ð¼Ð½Ð¾Ð¶ÐµÑÑ‚Ð²ÐµÐ½Ð½Ñ‹Ñ… Ð¿Ð¾Ð¿Ñ‹Ñ‚Ð¾Ðº Ð°ÑƒÑ‚ÐµÐ½Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸Ð¸.
- **ÐŸÑ€Ð¸Ð·Ð½Ð°ÐºÐ¸:**
  - Ð¡ÐµÑ€Ð¸Ñ ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ð¹ 4771 Ñ Ð¾ÑˆÐ¸Ð±ÐºÐ¾Ð¹ "bad password".
  - ÐŸÐ¾Ð²Ñ‚Ð¾Ñ€Ð½Ñ‹Ðµ Ð¿Ð¾Ð¿Ñ‹Ñ‚ÐºÐ¸ Ð²Ñ…Ð¾Ð´Ð° Ð¾Ñ‚ Ð¾Ð´Ð½Ð¾Ð³Ð¾ IP-Ð°Ð´Ñ€ÐµÑÐ° Ð¸Ð»Ð¸ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ.
  - Ð’Ñ‹ÑÐ¾ÐºÐ°Ñ Ñ‡Ð°ÑÑ‚Ð¾Ñ‚Ð° Ð·Ð°Ð¿Ñ€Ð¾ÑÐ¾Ð² AS-REQ.
- **Ð›Ð¾Ð³Ð¸ Windows (Event ID):** 4771.

---

## 3.3. ÐœÐµÑ‚Ð¾Ð´Ñ‹ Ð¾Ð±Ð½Ð°Ñ€ÑƒÐ¶ÐµÐ½Ð¸Ñ Ð°Ñ‚Ð°Ðº

Ð”Ð»Ñ Ð°Ð½Ð°Ð»Ð¸Ð·Ð° ÑÐµÑ‚ÐµÐ²Ð¾Ð³Ð¾ Ñ‚Ñ€Ð°Ñ„Ð¸ÐºÐ° Ð¸ Ð²Ñ‹ÑÐ²Ð»ÐµÐ½Ð¸Ñ Ð°Ñ‚Ð°Ðº Ð½Ð° Ð¿Ñ€Ð¾Ñ‚Ð¾ÐºÐ¾Ð» Kerberos Ð¿Ñ€Ð¸Ð¼ÐµÐ½ÑÑŽÑ‚ÑÑ Ñ€Ð°Ð·Ð»Ð¸Ñ‡Ð½Ñ‹Ðµ Ð¼ÐµÑ‚Ð¾Ð´Ñ‹, Ð² Ñ‚Ð¾Ð¼ Ñ‡Ð¸ÑÐ»Ðµ ÑÐ¸Ð³Ð½Ð°Ñ‚ÑƒÑ€Ð½Ñ‹Ð¹ Ð¸ Ð¿Ð¾Ð²ÐµÐ´ÐµÐ½Ñ‡ÐµÑÐºÐ¸Ð¹ Ð°Ð½Ð°Ð»Ð¸Ð·. ÐšÐ¾Ð¼Ð±Ð¸Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ ÑÑ‚Ð¸Ñ… Ð¿Ð¾Ð´Ñ…Ð¾Ð´Ð¾Ð² Ð¿Ð¾Ð·Ð²Ð¾Ð»ÑÐµÑ‚ Ð¿Ð¾Ð²Ñ‹ÑÐ¸Ñ‚ÑŒ Ñ‚Ð¾Ñ‡Ð½Ð¾ÑÑ‚ÑŒ Ð¾Ð±Ð½Ð°Ñ€ÑƒÐ¶ÐµÐ½Ð¸Ñ Ð¸ ÑÐ½Ð¸Ð·Ð¸Ñ‚ÑŒ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ð»Ð¾Ð¶Ð½Ñ‹Ñ… ÑÑ€Ð°Ð±Ð°Ñ‚Ñ‹Ð²Ð°Ð½Ð¸Ð¹.

### 3.3.1. Ð¡Ð¸Ð³Ð½Ð°Ñ‚ÑƒÑ€Ð½Ñ‹Ð¹ Ð°Ð½Ð°Ð»Ð¸Ð·

Ð¡Ð¸Ð³Ð½Ð°Ñ‚ÑƒÑ€Ð½Ñ‹Ð¹ Ð¼ÐµÑ‚Ð¾Ð´ Ð·Ð°ÐºÐ»ÑŽÑ‡Ð°ÐµÑ‚ÑÑ Ð² ÑÑ€Ð°Ð²Ð½ÐµÐ½Ð¸Ð¸ Ñ‚ÐµÐºÑƒÑ‰Ð¸Ñ… ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ð¹ Ñ Ð·Ð°Ñ€Ð°Ð½ÐµÐµ Ð¸Ð·Ð²ÐµÑÑ‚Ð½Ñ‹Ð¼Ð¸ ÑˆÐ°Ð±Ð»Ð¾Ð½Ð°Ð¼Ð¸ Ð°Ñ‚Ð°Ðº.

#### ÐŸÑ€Ð¸Ð¼ÐµÑ€Ñ‹ ÑÐ¸Ð³Ð½Ð°Ñ‚ÑƒÑ€:

- **Golden Ticket**: TTL Ð±Ð¸Ð»ÐµÑ‚Ð° > 24 Ñ‡Ð°ÑÐ° + Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ðµ krbtgt.
- **Kerberoasting**: Ð±Ð¾Ð»ÐµÐµ 20 TGS-Ð·Ð°Ð¿Ñ€Ð¾ÑÐ¾Ð² Ð·Ð° Ð¼Ð¸Ð½ÑƒÑ‚Ñƒ.
- **AS-REP Roasting**: AS-REQ Ð±ÐµÐ· Ð¿Ð¾ÑÐ»ÐµÐ´ÑƒÑŽÑ‰ÐµÐ³Ð¾ AS-REP.

#### Ð˜Ð½ÑÑ‚Ñ€ÑƒÐ¼ÐµÐ½Ñ‚Ñ‹:
- Sigma rules
- Snort / Suricata Ð¿Ñ€Ð°Ð²Ð¸Ð»Ð°
- YARA Ð¿Ñ€Ð°Ð²Ð¸Ð»Ð° Ð´Ð»Ñ Ñ‚Ñ€Ð°Ñ„Ð¸ÐºÐ°

### 3.3.2. ÐŸÐ¾Ð²ÐµÐ´ÐµÐ½Ñ‡ÐµÑÐºÐ¸Ð¹ Ð°Ð½Ð°Ð»Ð¸Ð·

ÐŸÐ¾Ð²ÐµÐ´ÐµÐ½Ñ‡ÐµÑÐºÐ¸Ð¹ Ð¼ÐµÑ‚Ð¾Ð´ Ð¾ÑÐ½Ð¾Ð²Ð°Ð½ Ð½Ð° Ð¿Ð¾ÑÑ‚Ñ€Ð¾ÐµÐ½Ð¸Ð¸ Ð¼Ð¾Ð´ÐµÐ»ÐµÐ¹ Ð½Ð¾Ñ€Ð¼Ð°Ð»ÑŒÐ½Ð¾Ð³Ð¾ Ð¿Ð¾Ð²ÐµÐ´ÐµÐ½Ð¸Ñ Ð¸ Ð²Ñ‹ÑÐ²Ð»ÐµÐ½Ð¸Ð¸ Ð¾Ñ‚ÐºÐ»Ð¾Ð½ÐµÐ½Ð¸Ð¹ Ð¾Ñ‚ Ð½Ð¸Ñ….

#### ÐŸÐ¾Ð´Ñ…Ð¾Ð´Ñ‹:
- **Ð¡Ñ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ð¹ Ð°Ð½Ð°Ð»Ð¸Ð·**: ÑÑ€Ð°Ð²Ð½ÐµÐ½Ð¸Ðµ Ñ‡Ð°ÑÑ‚Ð¾Ñ‚Ñ‹ ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ð¹ Ñ Ð¸ÑÑ‚Ð¾Ñ€Ð¸Ñ‡ÐµÑÐºÐ¸Ð¼Ð¸ Ð´Ð°Ð½Ð½Ñ‹Ð¼Ð¸.
- **ÐšÐ¾Ð½Ñ‚ÐµÐºÑÑ‚Ð½Ñ‹Ð¹ Ð°Ð½Ð°Ð»Ð¸Ð·**: ÑƒÑ‡Ñ‘Ñ‚ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸, Ð³ÐµÐ¾Ð³Ñ€Ð°Ñ„Ð¸Ð¸, Ñ‚Ð¸Ð¿Ð° ÑƒÑÑ‚Ñ€Ð¾Ð¹ÑÑ‚Ð²Ð°, Ñ€Ð¾Ð»Ð¸ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ.
- **ÐœÐµÐ¶ÑÐµÑ‚ÐµÐ²Ð¾Ð¹ Ð°Ð½Ð°Ð»Ð¸Ð·**: Ð²Ñ‹ÑÐ²Ð»ÐµÐ½Ð¸Ðµ Ð½ÐµÑÐ¾Ð¾Ñ‚Ð²ÐµÑ‚ÑÑ‚Ð²Ð¸Ð¹ Ð¼ÐµÐ¶Ð´Ñƒ ÑÑ‚Ð°Ð¿Ð°Ð¼Ð¸ Kerberos-ÑÐµÑÑÐ¸Ð¸.

#### ÐŸÑ€Ð¸Ð¼ÐµÑ€Ñ‹ Ð¿Ñ€Ð°Ð²Ð¸Ð»:
- ÐÐµÐ¾Ð±Ñ‹Ñ‡Ð½Ð¾ Ð²Ñ‹ÑÐ¾ÐºÐ¾Ðµ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ TGS-Ð±Ð¸Ð»ÐµÑ‚Ð¾Ð² Ð´Ð»Ñ Ð¾Ð±Ñ‹Ñ‡Ð½Ð¾Ð³Ð¾ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ.
- Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ðµ TGS Ð±ÐµÐ· Ð¿Ñ€ÐµÐ´Ñ‹Ð´ÑƒÑ‰ÐµÐ³Ð¾ TGT.
- ÐÐºÑ‚Ð¸Ð²Ð½Ð¾ÑÑ‚ÑŒ Kerberos Ð²Ð½Ðµ Ñ€Ð°Ð±Ð¾Ñ‡ÐµÐ³Ð¾ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸.

### 3.3.3. Ð’Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ÑÑ‚Ð¸ Ð¼Ð°ÑˆÐ¸Ð½Ð½Ð¾Ð³Ð¾ Ð¾Ð±ÑƒÑ‡ÐµÐ½Ð¸Ñ

ÐœÐ°ÑˆÐ¸Ð½Ð½Ð¾Ðµ Ð¾Ð±ÑƒÑ‡ÐµÐ½Ð¸Ðµ Ð¼Ð¾Ð¶ÐµÑ‚ Ð¿Ñ€Ð¸Ð¼ÐµÐ½ÑÑ‚ÑŒÑÑ Ð´Ð»Ñ Ð¿Ð¾ÑÑ‚Ñ€Ð¾ÐµÐ½Ð¸Ñ ÑÐ»Ð¾Ð¶Ð½Ñ‹Ñ… Ð¼Ð¾Ð´ÐµÐ»ÐµÐ¹ Ð¿Ð¾Ð²ÐµÐ´ÐµÐ½Ð¸Ñ Ð¸ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¾Ð³Ð¾ Ð¾Ð±Ð½Ð°Ñ€ÑƒÐ¶ÐµÐ½Ð¸Ñ Ð°Ð½Ð¾Ð¼Ð°Ð»Ð¸Ð¹.

#### ÐŸÐµÑ€ÑÐ¿ÐµÐºÑ‚Ð¸Ð²Ð½Ñ‹Ðµ Ð°Ð»Ð³Ð¾Ñ€Ð¸Ñ‚Ð¼Ñ‹:
- **Isolation Forest** â€” Ð´Ð»Ñ Ð¾Ð±Ð½Ð°Ñ€ÑƒÐ¶ÐµÐ½Ð¸Ñ Ð²Ñ‹Ð±Ñ€Ð¾ÑÐ¾Ð².
- **Autoencoder** â€” Ð´Ð»Ñ Ð²Ñ‹ÑÐ²Ð»ÐµÐ½Ð¸Ñ Ð½ÐµÑ…Ð°Ñ€Ð°ÐºÑ‚ÐµÑ€Ð½Ñ‹Ñ… Ð¿Ð°Ñ‚Ñ‚ÐµÑ€Ð½Ð¾Ð².
- **LSTM** â€” Ð´Ð»Ñ Ð°Ð½Ð°Ð»Ð¸Ð·Ð° Ð²Ñ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ñ… Ð¿Ð¾ÑÐ»ÐµÐ´Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒÐ½Ð¾ÑÑ‚ÐµÐ¹ Kerberos-ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ð¹.

#### ÐŸÑ€ÐµÐ¸Ð¼ÑƒÑ‰ÐµÑÑ‚Ð²Ð°:
- Ð’Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ÑÑ‚ÑŒ Ð¾Ð±Ð½Ð°Ñ€ÑƒÐ¶ÐµÐ½Ð¸Ñ Ð½Ð¾Ð²Ñ‹Ñ…, Ñ€Ð°Ð½ÐµÐµ Ð½ÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ñ‹Ñ… Ð°Ñ‚Ð°Ðº.
- ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ð·Ð°Ñ†Ð¸Ñ Ð¿Ð¾ÑÑ‚Ñ€Ð¾ÐµÐ½Ð¸Ñ Ð¼Ð¾Ð´ÐµÐ»ÐµÐ¹ Ð¿Ð¾Ð²ÐµÐ´ÐµÐ½Ð¸Ñ.
- Ð£ÑÑ‚Ð¾Ð¹Ñ‡Ð¸Ð²Ð¾ÑÑ‚ÑŒ Ðº Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸ÑŽ Ð¿Ð¾Ð²ÐµÐ´ÐµÐ½Ð¸Ñ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÐµÐ¹ ÑÐ¾ Ð²Ñ€ÐµÐ¼ÐµÐ½ÐµÐ¼.

#### ÐžÐ³Ñ€Ð°Ð½Ð¸Ñ‡ÐµÐ½Ð¸Ñ:
- Ð¢Ñ€ÐµÐ±ÑƒÐµÑ‚ÑÑ Ð±Ð¾Ð»ÑŒÑˆÐ¾Ðµ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ ÐºÐ°Ñ‡ÐµÑÑ‚Ð²ÐµÐ½Ð½Ñ‹Ñ… Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð´Ð»Ñ Ð¾Ð±ÑƒÑ‡ÐµÐ½Ð¸Ñ.
- Ð¡Ð»Ð¾Ð¶Ð½Ð¾ÑÑ‚ÑŒ Ð¸Ð½Ñ‚ÐµÑ€Ð¿Ñ€ÐµÑ‚Ð°Ñ†Ð¸Ð¸ Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ð¾Ð².
- Ð’Ñ‹ÑÐ¾ÐºÐ¸Ðµ Ð²Ñ‹Ñ‡Ð¸ÑÐ»Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ñ‚Ñ€ÐµÐ±Ð¾Ð²Ð°Ð½Ð¸Ñ.

---

## 3.4. Ð˜Ð´ÐµÐ½Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ‚Ð¾Ñ€Ñ‹ ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ð¹ Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚Ð¸ Windows

Ð’ Ð´Ð¾Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ðµ Ðº ÑÐµÑ‚ÐµÐ²Ð¾Ð¼Ñƒ Ñ‚Ñ€Ð°Ñ„Ð¸ÐºÑƒ, Ð´Ð»Ñ Ð¾Ð±Ð½Ð°Ñ€ÑƒÐ¶ÐµÐ½Ð¸Ñ Ð°Ñ‚Ð°Ðº Ð½Ð° Kerberos Ð¼Ð¾Ð¶Ð½Ð¾ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ Ð¶ÑƒÑ€Ð½Ð°Ð»Ñ‹ Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚Ð¸ Windows, Ð³Ð´Ðµ Ñ„Ð¸ÐºÑÐ¸Ñ€ÑƒÑŽÑ‚ÑÑ ÐºÐ»ÑŽÑ‡ÐµÐ²Ñ‹Ðµ ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ñ Ð°ÑƒÑ‚ÐµÐ½Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸Ð¸.

| Event ID | ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ |
|----------|-----------|
| **4768** | Ð—Ð°Ð¿Ñ€Ð¾Ñ TGT (Authentication Service Request) |
| **4769** | Ð—Ð°Ð¿Ñ€Ð¾Ñ TGS (Ticket Granting Service Request) |
| **4771** | ÐžÑˆÐ¸Ð±ÐºÐ° Ð°ÑƒÑ‚ÐµÐ½Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸Ð¸ Kerberos (Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, Ð½ÐµÐ²ÐµÑ€Ð½Ñ‹Ð¹ Ð¿Ð°Ñ€Ð¾Ð»ÑŒ) |
| **4672** | ÐÐ°Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ ÑÐ¿ÐµÑ†Ð¸Ð°Ð»ÑŒÐ½Ñ‹Ñ… Ð¿Ñ€Ð¸Ð²Ð¸Ð»ÐµÐ³Ð¸Ð¹ Ð¿Ñ€Ð¸ Ð²Ñ…Ð¾Ð´Ðµ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ |
| **4624** | Ð£ÑÐ¿ÐµÑˆÐ½Ñ‹Ð¹ Ð²Ñ…Ð¾Ð´ Ð² ÑÐ¸ÑÑ‚ÐµÐ¼Ñƒ |
| **4625** | ÐÐµÑƒÐ´Ð°Ñ‡Ð½Ð°Ñ Ð¿Ð¾Ð¿Ñ‹Ñ‚ÐºÐ° Ð²Ñ…Ð¾Ð´Ð° |

Ð­Ñ‚Ð¸ ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ñ Ð¿Ð¾Ð·Ð²Ð¾Ð»ÑÑŽÑ‚ ÑÑ‚Ñ€Ð¾Ð¸Ñ‚ÑŒ Ð¼Ð¾Ð´ÐµÐ»ÑŒ Ð¿Ð¾Ð²ÐµÐ´ÐµÐ½Ð¸Ñ Ð¸ Ð²Ñ‹ÑÐ²Ð»ÑÑ‚ÑŒ Ð°Ð½Ð¾Ð¼Ð°Ð»ÑŒÐ½ÑƒÑŽ Ð°ÐºÑ‚Ð¸Ð²Ð½Ð¾ÑÑ‚ÑŒ Ð´Ð°Ð¶Ðµ Ð¿Ñ€Ð¸ Ð¾Ñ‚ÑÑƒÑ‚ÑÑ‚Ð²Ð¸Ð¸ Ð²Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ÑÑ‚Ð¸ Ð¿ÐµÑ€ÐµÑ…Ð²Ð°Ñ‚Ð° ÑÐµÑ‚ÐµÐ²Ð¾Ð³Ð¾ Ñ‚Ñ€Ð°Ñ„Ð¸ÐºÐ°.

---

## 3.5. Ð—Ð°ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ Ð¿Ð¾ Ð³Ð»Ð°Ð²Ðµ

Ð’ Ð´Ð°Ð½Ð½Ð¾Ð¹ Ð³Ð»Ð°Ð²Ðµ Ð±Ñ‹Ð»Ð¸ Ñ€Ð°ÑÑÐ¼Ð¾Ñ‚Ñ€ÐµÐ½Ñ‹ Ð¼Ð¾Ð´ÐµÐ»Ð¸ Ð½Ð¾Ñ€Ð¼Ð°Ð»ÑŒÐ½Ð¾Ð³Ð¾ Ð¿Ð¾Ð²ÐµÐ´ÐµÐ½Ð¸Ñ Kerberos-ÑÐµÑÑÐ¸Ð¹, Ð° Ñ‚Ð°ÐºÐ¶Ðµ Ð¿Ñ€Ð¸Ð·Ð½Ð°ÐºÐ¸ Ð½Ð°Ð¸Ð±Ð¾Ð»ÐµÐµ Ñ€Ð°ÑÐ¿Ñ€Ð¾ÑÑ‚Ñ€Ð°Ð½Ñ‘Ð½Ð½Ñ‹Ñ… Ð°Ñ‚Ð°Ðº Ð½Ð° Ð¿Ñ€Ð¾Ñ‚Ð¾ÐºÐ¾Ð» Kerberos. Ð‘Ñ‹Ð»Ð¾ Ð¿Ð¾ÐºÐ°Ð·Ð°Ð½Ð¾, Ñ‡Ñ‚Ð¾ Ð±Ð¾Ð»ÑŒÑˆÐ¸Ð½ÑÑ‚Ð²Ð¾ ÑÐ¾Ð²Ñ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ñ… Ð°Ñ‚Ð°Ðº Ð¾ÑÑ‚Ð°Ð²Ð»ÑÑŽÑ‚ Ñ…Ð°Ñ€Ð°ÐºÑ‚ÐµÑ€Ð½Ñ‹Ðµ ÑÐ»ÐµÐ´Ñ‹ Ð² ÑÐµÑ‚ÐµÐ²Ð¾Ð¼ Ñ‚Ñ€Ð°Ñ„Ð¸ÐºÐµ Ð¸ Ð»Ð¾Ð³Ð°Ñ… Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚Ð¸, Ñ‡Ñ‚Ð¾ Ð¿Ð¾Ð·Ð²Ð¾Ð»ÑÐµÑ‚ Ñ€ÐµÐ°Ð»Ð¸Ð·Ð¾Ð²Ð°Ñ‚ÑŒ ÑÐ¸ÑÑ‚ÐµÐ¼Ñ‹ Ð¾Ð±Ð½Ð°Ñ€ÑƒÐ¶ÐµÐ½Ð¸Ñ Ð½Ð° Ð¾ÑÐ½Ð¾Ð²Ðµ Ð°Ð½Ð°Ð»Ð¸Ð·Ð° Ð°Ð½Ð¾Ð¼Ð°Ð»Ð¸Ð¹.

Ð‘Ñ‹Ð»Ð¸ Ð¿Ñ€ÐµÐ´ÑÑ‚Ð°Ð²Ð»ÐµÐ½Ñ‹ Ñ‚Ñ€Ð¸ Ð¾ÑÐ½Ð¾Ð²Ð½Ñ‹Ñ… Ð¼ÐµÑ‚Ð¾Ð´Ð° Ð¾Ð±Ð½Ð°Ñ€ÑƒÐ¶ÐµÐ½Ð¸Ñ: ÑÐ¸Ð³Ð½Ð°Ñ‚ÑƒÑ€Ð½Ñ‹Ð¹, Ð¿Ð¾Ð²ÐµÐ´ÐµÐ½Ñ‡ÐµÑÐºÐ¸Ð¹ Ð¸ Ð½Ð° Ð¾ÑÐ½Ð¾Ð²Ðµ Ð¼Ð°ÑˆÐ¸Ð½Ð½Ð¾Ð³Ð¾ Ð¾Ð±ÑƒÑ‡ÐµÐ½Ð¸Ñ. ÐÐ° Ð¾ÑÐ½Ð¾Ð²Ðµ ÑÑ‚Ð¾Ð³Ð¾ Ð¼Ð°Ñ‚ÐµÑ€Ð¸Ð°Ð»Ð° Ð±Ñ‹Ð»Ð° ÑÐ¿Ñ€Ð¾ÐµÐºÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð° Ð¸ Ñ€ÐµÐ°Ð»Ð¸Ð·Ð¾Ð²Ð°Ð½Ð° Ð¿Ñ€Ð¾Ð³Ñ€Ð°Ð¼Ð¼Ð½Ð°Ñ ÑÐ¸ÑÑ‚ÐµÐ¼Ð°, ÑÐ¿Ð¾ÑÐ¾Ð±Ð½Ð°Ñ Ð°Ð½Ð°Ð»Ð¸Ð·Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ ÑÐµÑ‚ÐµÐ²Ð¾Ð¹ Ñ‚Ñ€Ð°Ñ„Ð¸Ðº Active Directory Ð¸ Ð²Ñ‹ÑÐ²Ð»ÑÑ‚ÑŒ Ð¿Ñ€Ð¸Ð·Ð½Ð°ÐºÐ¸ Ð°Ñ‚Ð°Ðº Ð½Ð° Ð¿Ñ€Ð¾Ñ‚Ð¾ÐºÐ¾Ð» Kerberos.

---

# ðŸ“˜ Ð“Ð»Ð°Ð²Ð° 4. Ð Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° Ð¿Ñ€Ð¾Ð³Ñ€Ð°Ð¼Ð¼Ð½Ð¾Ð³Ð¾ Ð¾Ð±ÐµÑÐ¿ÐµÑ‡ÐµÐ½Ð¸Ñ

## 4.1. Ð¢Ñ€ÐµÐ±Ð¾Ð²Ð°Ð½Ð¸Ñ Ðº Ñ€Ð°Ð·Ñ€Ð°Ð±Ð°Ñ‚Ñ‹Ð²Ð°ÐµÐ¼Ð¾Ð¼Ñƒ ÐŸÐž

### 4.1.1. ÐžÐ±Ñ‰Ð¸Ðµ Ñ‚Ñ€ÐµÐ±Ð¾Ð²Ð°Ð½Ð¸Ñ

Ð”Ð»Ñ Ð´Ð¾ÑÑ‚Ð¸Ð¶ÐµÐ½Ð¸Ñ Ñ†ÐµÐ»Ð¸ â€” **Ñ€Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¸ Ð¿Ñ€Ð¾Ð³Ñ€Ð°Ð¼Ð¼Ð½Ð¾Ð³Ð¾ Ð¾Ð±ÐµÑÐ¿ÐµÑ‡ÐµÐ½Ð¸Ñ, Ð²Ñ‹ÑÐ²Ð»ÑÑŽÑ‰ÐµÐ³Ð¾ Ð°Ñ‚Ð°ÐºÐ¸ Ð½Ð° Ð¿Ñ€Ð¾Ñ‚Ð¾ÐºÐ¾Ð» Kerberos Ñ‡ÐµÑ€ÐµÐ· Ð°Ð½Ð°Ð»Ð¸Ð· Ð°Ð½Ð¾Ð¼Ð°Ð»Ð¸Ð¹ Ð² ÑÐµÑ‚ÐµÐ²Ð¾Ð¼ Ñ‚Ñ€Ð°Ñ„Ð¸ÐºÐµ Active Directory**, â€” Ð±Ñ‹Ð»Ð¸ ÑÑ„Ð¾Ñ€Ð¼ÑƒÐ»Ð¸Ñ€Ð¾Ð²Ð°Ð½Ñ‹ ÑÐ»ÐµÐ´ÑƒÑŽÑ‰Ð¸Ðµ Ð¾Ð±Ñ‰Ð¸Ðµ Ñ‚Ñ€ÐµÐ±Ð¾Ð²Ð°Ð½Ð¸Ñ:

- ÐŸÑ€Ð¾Ð³Ñ€Ð°Ð¼Ð¼Ð° Ð´Ð¾Ð»Ð¶Ð½Ð° Ð±Ñ‹Ñ‚ÑŒ **Ð°Ð²Ñ‚Ð¾Ð½Ð¾Ð¼Ð½Ð¾Ð¹**, Ð½Ðµ Ñ‚Ñ€ÐµÐ±ÑƒÑŽÑ‰ÐµÐ¹ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ¸ Ð´Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ñ… Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚ÐµÐ¹.
- Ð”Ð¾Ð»Ð¶Ð½Ð° Ð¿Ð¾Ð´Ð´ÐµÑ€Ð¶Ð¸Ð²Ð°Ñ‚ÑŒ **Ð¼Ð½Ð¾Ð¶ÐµÑÑ‚Ð²Ð¾ Ð¸ÑÑ‚Ð¾Ñ‡Ð½Ð¸ÐºÐ¾Ð² Ð´Ð°Ð½Ð½Ñ‹Ñ…**: ÑÐµÑ‚ÐµÐ²Ð¾Ð¹ Ñ‚Ñ€Ð°Ñ„Ð¸Ðº (PCAP), Ð»Ð¾Ð³Ð¸ Windows Event Logs Ð¸ Ð¿Ð¾Ñ‚Ð¾ÐºÐ¾Ð²Ð¾Ðµ Ð½Ð°Ð±Ð»ÑŽÐ´ÐµÐ½Ð¸Ðµ Ð·Ð° ÑÐµÑ‚ÑŒÑŽ.
- ÐŸÑ€Ð¾Ð³Ñ€Ð°Ð¼Ð¼Ð° Ð´Ð¾Ð»Ð¶Ð½Ð° **Ð¾Ð±Ð½Ð°Ñ€ÑƒÐ¶Ð¸Ð²Ð°Ñ‚ÑŒ Ð¸Ð·Ð²ÐµÑÑ‚Ð½Ñ‹Ðµ Ð°Ñ‚Ð°ÐºÐ¸** Ð½Ð° Kerberos: Golden Ticket, Silver Ticket, Kerberoasting, AS-REP Roasting, Pass-the-Ticket.
- Ð ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ñ‹ Ð°Ð½Ð°Ð»Ð¸Ð·Ð° Ð´Ð¾Ð»Ð¶Ð½Ñ‹ Ð²Ñ‹Ð²Ð¾Ð´Ð¸Ñ‚ÑŒÑÑ Ð² ÑƒÐ´Ð¾Ð±Ð¾Ñ‡Ð¸Ñ‚Ð°ÐµÐ¼Ð¾Ð¼ Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚Ðµ: CLI, JSON Ð¸Ð»Ð¸ CSV.
- ÐŸÑ€Ð¾Ð³Ñ€Ð°Ð¼Ð¼Ð° Ð´Ð¾Ð»Ð¶Ð½Ð° Ð¸Ð¼ÐµÑ‚ÑŒ Ð²Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ÑÑ‚ÑŒ Ð¸Ð½Ñ‚ÐµÐ³Ñ€Ð°Ñ†Ð¸Ð¸ Ñ ÑÐ¸ÑÑ‚ÐµÐ¼Ð°Ð¼Ð¸ Ð¼Ð¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³Ð° Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚Ð¸ (SIEM) Ñ‡ÐµÑ€ÐµÐ· Syslog, Slack Ð¸Ð»Ð¸ Email.

### 4.1.2. Ð¤ÑƒÐ½ÐºÑ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ñ‹Ðµ Ñ‚Ñ€ÐµÐ±Ð¾Ð²Ð°Ð½Ð¸Ñ

| â„– | Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ | ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ |
|----|--------|----------|
| 1 | Ð¡Ð±Ð¾Ñ€ Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð¸Ð· PCAP-Ñ„Ð°Ð¹Ð»Ð¾Ð² | Ð§Ñ‚ÐµÐ½Ð¸Ðµ Ð¿Ð°ÐºÐµÑ‚Ð¾Ð² Ð¸ Ð¸Ð·Ð²Ð»ÐµÑ‡ÐµÐ½Ð¸Ðµ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ð¹ Kerberos |
| 2 | Ð—Ð°Ñ…Ð²Ð°Ñ‚ Ñ‚Ñ€Ð°Ñ„Ð¸ÐºÐ° Ð² Ñ€ÐµÐ°Ð»ÑŒÐ½Ð¾Ð¼ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸ | Ð’Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ÑÑ‚ÑŒ live capture Ñ Ð¿Ð¾Ð¼Ð¾Ñ‰ÑŒÑŽ tcpdump/tshark |
| 3 | ÐŸÐ°Ñ€ÑÐ¸Ð½Ð³ Kerberos-ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ð¹ | Ð˜Ð·Ð²Ð»ÐµÑ‡ÐµÐ½Ð¸Ðµ Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ð¾Ð² Ð±Ð¸Ð»ÐµÑ‚Ð¾Ð² (TGT/TGS), SPN, Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÐµÐ¹ |
| 4 | Ð§Ñ‚ÐµÐ½Ð¸Ðµ Ð»Ð¾Ð³Ð¾Ð² Windows | ÐŸÐ¾Ð´Ð´ÐµÑ€Ð¶ÐºÐ° Ñ‡Ñ‚ÐµÐ½Ð¸Ñ EVT/ETW-Ñ„Ð°Ð¹Ð»Ð¾Ð² Ñ ÑÐ¾Ð±Ñ‹Ñ‚Ð¸ÑÐ¼Ð¸ Kerberos (ID 4768, 4769, 4771) |
| 5 | ÐžÐ±Ð½Ð°Ñ€ÑƒÐ¶ÐµÐ½Ð¸Ðµ Ð°Ñ‚Ð°Ðº | ÐÐ½Ð°Ð»Ð¸Ð· Ð¾Ñ‚ÐºÐ»Ð¾Ð½ÐµÐ½Ð¸Ð¹ Ð¾Ñ‚ Ð½Ð¾Ñ€Ð¼Ð°Ð»ÑŒÐ½Ð¾Ð³Ð¾ Ð¿Ð¾Ð²ÐµÐ´ÐµÐ½Ð¸Ñ Ð¸ ÑÐ¸Ð³Ð½Ð°Ñ‚ÑƒÑ€ |
| 6 | Ð’Ñ‹Ð²Ð¾Ð´ Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ð¾Ð² | Ð¦Ð²ÐµÑ‚Ð¾Ð²Ð°Ñ Ð¸Ð½Ð´Ð¸ÐºÐ°Ñ†Ð¸Ñ ÑƒÑ€Ð¾Ð²Ð½Ñ Ñ€Ð¸ÑÐºÐ°, ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ðµ Ð² Ñ„Ð°Ð¹Ð» |
| 7 | Ð˜Ð½Ñ‚ÐµÐ³Ñ€Ð°Ñ†Ð¸Ñ Ñ Ð²Ð½ÐµÑˆÐ½Ð¸Ð¼Ð¸ ÑÐ¸ÑÑ‚ÐµÐ¼Ð°Ð¼Ð¸ | ÐžÑ‚Ð¿Ñ€Ð°Ð²ÐºÐ° Ð°Ð»ÐµÑ€Ñ‚Ð¾Ð² Ñ‡ÐµÑ€ÐµÐ· Syslog, Email Ð¸Ð»Ð¸ API |

### 4.1.3. ÐÐµÑ„ÑƒÐ½ÐºÑ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ñ‹Ðµ Ñ‚Ñ€ÐµÐ±Ð¾Ð²Ð°Ð½Ð¸Ñ

| ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ | Ð¢Ñ€ÐµÐ±Ð¾Ð²Ð°Ð½Ð¸Ðµ |
|-----------|------------|
| Ð¡Ð¾Ð²Ð¼ÐµÑÑ‚Ð¸Ð¼Ð¾ÑÑ‚ÑŒ | Ð Ð°Ð±Ð¾Ñ‚Ð° Ð½Ð° Windows Ð¸ Linux |
| ÐŸÑ€Ð¾Ð¸Ð·Ð²Ð¾Ð´Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ÑÑ‚ÑŒ | ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° Ñ‚Ñ€Ð°Ñ„Ð¸ÐºÐ° Ð² Ñ€ÐµÐ°Ð»ÑŒÐ½Ð¾Ð¼ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸ Ð¸Ð»Ð¸ Ð±Ð»Ð¸Ð·ÐºÐ¾Ð¼ Ðº Ð½ÐµÐ¼Ñƒ |
| Ð‘ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚ÑŒ | ÐÐ¸ÐºÐ°ÐºÐ°Ñ ÐºÐ¾Ð½Ñ„Ð¸Ð´ÐµÐ½Ñ†Ð¸Ð°Ð»ÑŒÐ½Ð°Ñ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ Ð½Ðµ Ð´Ð¾Ð»Ð¶Ð½Ð° Ð·Ð°Ð¿Ð¸ÑÑ‹Ð²Ð°Ñ‚ÑŒÑÑ Ð±ÐµÐ· ÑÐ¾Ð³Ð»Ð°ÑÐ¸Ñ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ |
| Ð£Ð´Ð¾Ð±ÑÑ‚Ð²Ð¾ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ñ | CLI-Ð¸Ð½Ñ‚ÐµÑ€Ñ„ÐµÐ¹Ñ Ñ Ð¿Ð¾Ð½ÑÑ‚Ð½Ñ‹Ð¼ Ð²Ñ‹Ð²Ð¾Ð´Ð¾Ð¼ |
| Ð Ð°ÑÑˆÐ¸Ñ€ÑÐµÐ¼Ð¾ÑÑ‚ÑŒ | ÐŸÐ¾Ð´Ð´ÐµÑ€Ð¶ÐºÐ° Ð´Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð¸Ñ Ð½Ð¾Ð²Ñ‹Ñ… Ð¿Ñ€Ð°Ð²Ð¸Ð» Ð°Ð½Ð°Ð»Ð¸Ð·Ð° Ð¸ Ñ‚Ð¸Ð¿Ð¾Ð² Ð°Ñ‚Ð°Ðº |
| Ð”Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ð¾ÑÑ‚ÑŒ | ÐšÐ¾Ð¼Ð¼ÐµÐ½Ñ‚Ð°Ñ€Ð¸Ð¸ Ð² ÐºÐ¾Ð´Ðµ, README, Ð¿Ñ€Ð¸Ð¼ÐµÑ€Ñ‹ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ñ |

---

## 4.2. ÐÑ€Ñ…Ð¸Ñ‚ÐµÐºÑ‚ÑƒÑ€Ð° ÑÐ¸ÑÑ‚ÐµÐ¼Ñ‹

Ð Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚Ð°Ð½Ð½Ð¾Ðµ Ð¿Ñ€Ð¾Ð³Ñ€Ð°Ð¼Ð¼Ð½Ð¾Ðµ Ð¾Ð±ÐµÑÐ¿ÐµÑ‡ÐµÐ½Ð¸Ðµ ÑÐ¾ÑÑ‚Ð¾Ð¸Ñ‚ Ð¸Ð· Ð½ÐµÑÐºÐ¾Ð»ÑŒÐºÐ¸Ñ… Ð²Ð·Ð°Ð¸Ð¼Ð¾Ð´ÐµÐ¹ÑÑ‚Ð²ÑƒÑŽÑ‰Ð¸Ñ… Ð¼Ð¾Ð´ÑƒÐ»ÐµÐ¹, ÐºÐ°Ð¶Ð´Ñ‹Ð¹ Ð¸Ð· ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ñ… Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÑÐµÑ‚ ÑÐ²Ð¾ÑŽ Ñ„ÑƒÐ½ÐºÑ†Ð¸ÑŽ Ð² Ð¿Ñ€Ð¾Ñ†ÐµÑÑÐµ ÑÐ±Ð¾Ñ€Ð°, Ð°Ð½Ð°Ð»Ð¸Ð·Ð° Ð¸ Ð¾Ð±Ð½Ð°Ñ€ÑƒÐ¶ÐµÐ½Ð¸Ñ Ð°Ð½Ð¾Ð¼Ð°Ð»Ð¸Ð¹ Ð² Kerberos-Ñ‚Ñ€Ð°Ñ„Ð¸ÐºÐµ.

### 4.2.1. ÐœÐ¾Ð´ÑƒÐ»ÑŒ ÑÐ±Ð¾Ñ€Ð° Ð´Ð°Ð½Ð½Ñ‹Ñ…

Ð­Ñ‚Ð¾Ñ‚ Ð¼Ð¾Ð´ÑƒÐ»ÑŒ Ð¾Ñ‚Ð²ÐµÑ‡Ð°ÐµÑ‚ Ð·Ð° Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ðµ Ð¸ÑÑ…Ð¾Ð´Ð½Ñ‹Ñ… Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð´Ð»Ñ Ð°Ð½Ð°Ð»Ð¸Ð·Ð°.

#### Ð’Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ÑÑ‚Ð¸:
- Ð§Ñ‚ÐµÐ½Ð¸Ðµ PCAP-Ñ„Ð°Ð¹Ð»Ð¾Ð².
- Ð—Ð°Ñ…Ð²Ð°Ñ‚ Ñ‚Ñ€Ð°Ñ„Ð¸ÐºÐ° Ð² Ñ€ÐµÐ°Ð»ÑŒÐ½Ð¾Ð¼ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸.
- Ð§Ñ‚ÐµÐ½Ð¸Ðµ Windows Event Logs (EVTX).
- Ð“Ñ€ÑƒÐ¿Ð¿Ð¸Ñ€Ð¾Ð²ÐºÐ° ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ð¹ Ð¿Ð¾ IP, Ð¸Ð¼ÐµÐ½Ð¸ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ Ð¸ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸.

#### Ð¢ÐµÑ…Ð½Ð¸Ñ‡ÐµÑÐºÐ°Ñ Ñ€ÐµÐ°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ:
- Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ðµ `scapy` Ð¸ `pyshark` Ð´Ð»Ñ Ð¿Ð°Ñ€ÑÐ¸Ð½Ð³Ð° Ð¿Ð°ÐºÐµÑ‚Ð¾Ð².
- Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ðµ `Evtx` Ð´Ð»Ñ Ñ‡Ñ‚ÐµÐ½Ð¸Ñ Ð¶ÑƒÑ€Ð½Ð°Ð»Ð¾Ð² Windows.
- Ð ÐµÐ°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ Ñ„Ð¸Ð»ÑŒÑ‚Ñ€Ð°Ñ†Ð¸Ð¸ Ð½Ð° Ð¾ÑÐ½Ð¾Ð²Ðµ Ð¿Ð¾Ñ€Ñ‚Ð° 88 (Kerberos).

### 4.2.2. ÐœÐ¾Ð´ÑƒÐ»ÑŒ Ð¿Ð°Ñ€ÑÐ¸Ð½Ð³Ð° Ð¸ Ñ„Ð¸Ð»ÑŒÑ‚Ñ€Ð°Ñ†Ð¸Ð¸

Ð­Ñ‚Ð¾Ñ‚ Ð¼Ð¾Ð´ÑƒÐ»ÑŒ Ð¾Ñ‚Ð²ÐµÑ‡Ð°ÐµÑ‚ Ð·Ð° Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÑƒ ÑÑ‹Ñ€Ñ‹Ñ… Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð¸ Ð²Ñ‹Ð´ÐµÐ»ÐµÐ½Ð¸Ðµ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ñ‚ÐµÑ… ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ð¹, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ðµ ÑÐ²ÑÐ·Ð°Ð½Ñ‹ Ñ Ð¿Ñ€Ð¾Ñ‚Ð¾ÐºÐ¾Ð»Ð¾Ð¼ Kerberos.

#### Ð’Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ÑÑ‚Ð¸:
- Ð˜Ð·Ð²Ð»ÐµÑ‡ÐµÐ½Ð¸Ðµ ASN.1 ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€ Ð¸Ð· Ð¿Ð°ÐºÐµÑ‚Ð¾Ð².
- Ð˜Ð·Ð²Ð»ÐµÑ‡ÐµÐ½Ð¸Ðµ Ð¸Ð¼ÐµÐ½Ð¸ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ, SPN, Ñ‚Ð¸Ð¿Ð° Ð·Ð°Ð¿Ñ€Ð¾ÑÐ°, TTL Ð±Ð¸Ð»ÐµÑ‚Ð°.
- Ð¤Ð¸Ð»ÑŒÑ‚Ñ€Ð°Ñ†Ð¸Ñ Ð½ÐµÑ€ÐµÐ»ÐµÐ²Ð°Ð½Ñ‚Ð½Ð¾Ð³Ð¾ Ñ‚Ñ€Ð°Ñ„Ð¸ÐºÐ°.

#### ÐŸÑ€Ð¸Ð¼ÐµÑ€ Ð¿Ð°Ñ€ÑÐ¸Ð½Ð³Ð° Kerberos-Ð·Ð°Ð¿Ñ€Ð¾ÑÐ°:
```python
from scapy.all import *
from scapy.layers.kerberos import Kerberos

def extract_kerberos_data(pkt):
    if pkt.haslayer(Kerberos):
        kerb_layer = pkt[Kerberos]
        return {
            'type': kerb_layer.type,
            'user': kerb_layer.cname,
            'spn': kerb_layer.sname,
            'till': kerb_layer.till,
            'timestamp': pkt.time
        }
```

### 4.2.3. ÐœÐ¾Ð´ÑƒÐ»ÑŒ Ð°Ð½Ð°Ð»Ð¸Ð·Ð° Ð¸ Ð¾Ð±Ð½Ð°Ñ€ÑƒÐ¶ÐµÐ½Ð¸Ñ Ð°Ð½Ð¾Ð¼Ð°Ð»Ð¸Ð¹

Ð­Ñ‚Ð¾Ñ‚ Ð¼Ð¾Ð´ÑƒÐ»ÑŒ Ñ€ÐµÐ°Ð»Ð¸Ð·ÑƒÐµÑ‚ Ð°Ð»Ð³Ð¾Ñ€Ð¸Ñ‚Ð¼Ñ‹ Ð¾Ð±Ð½Ð°Ñ€ÑƒÐ¶ÐµÐ½Ð¸Ñ Ð°Ñ‚Ð°Ðº.

#### ÐœÐµÑ‚Ð¾Ð´Ñ‹ Ð°Ð½Ð°Ð»Ð¸Ð·Ð°:
- **Ð¡Ð¸Ð³Ð½Ð°Ñ‚ÑƒÑ€Ð½Ñ‹Ð¹ Ð°Ð½Ð°Ð»Ð¸Ð·:** ÑÑ€Ð°Ð²Ð½ÐµÐ½Ð¸Ðµ Ñ Ð¸Ð·Ð²ÐµÑÑ‚Ð½Ñ‹Ð¼Ð¸ ÑˆÐ°Ð±Ð»Ð¾Ð½Ð°Ð¼Ð¸ Ð°Ñ‚Ð°Ðº.
- **ÐŸÐ¾Ð²ÐµÐ´ÐµÐ½Ñ‡ÐµÑÐºÐ¸Ð¹ Ð°Ð½Ð°Ð»Ð¸Ð·:** ÑÑ€Ð°Ð²Ð½ÐµÐ½Ð¸Ðµ Ñ‚ÐµÐºÑƒÑ‰Ð¸Ñ… Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ð¹ Ñ Ð¸ÑÑ‚Ð¾Ñ€Ð¸Ñ‡ÐµÑÐºÐ¸Ð¼Ð¸ Ð´Ð°Ð½Ð½Ñ‹Ð¼Ð¸.
- **ÐšÐ¾Ð½Ñ‚ÐµÐºÑÑ‚Ð½Ñ‹Ð¹ Ð°Ð½Ð°Ð»Ð¸Ð·:** Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ° ÑÐ¾Ð¾Ñ‚Ð²ÐµÑ‚ÑÑ‚Ð²Ð¸Ñ Ð¼ÐµÐ¶Ð´Ñƒ ÑÑ‚Ð°Ð¿Ð°Ð¼Ð¸ Kerberos-ÑÐµÑÑÐ¸Ð¸.

#### ÐŸÑ€Ð¸Ð¼ÐµÑ€ Ð¿Ñ€Ð°Ð²Ð¸Ð»Ð° Ð¾Ð±Ð½Ð°Ñ€ÑƒÐ¶ÐµÐ½Ð¸Ñ Golden Ticket:
```python
def detect_golden_ticket(ticket):
    if ticket['lifetime'] > 86400 and ticket['user'] == 'krbtgt':
        return {
            'alert': 'Golden Ticket detected',
            'severity': 'high',
            'description': 'Ticket with long lifetime issued for krbtgt account'
        }
```

#### ÐŸÑ€Ð¸Ð¼ÐµÑ€ Ð¿Ñ€Ð°Ð²Ð¸Ð»Ð° Ð¾Ð±Ð½Ð°Ñ€ÑƒÐ¶ÐµÐ½Ð¸Ñ Kerberoasting:
```python
def detect_kerberoasting(tgs_requests):
    if len(tgs_requests) > 20 and tgs_requests[0]['time_diff'] < 5:
        return {
            'alert': 'Potential Kerberoasting detected',
            'severity': 'medium',
            'description': 'Multiple TGS requests to service accounts in a short time'
        }
```

### 4.2.4. ÐœÐ¾Ð´ÑƒÐ»ÑŒ Ð²Ñ‹Ð²Ð¾Ð´Ð° Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ð¾Ð²

Ð­Ñ‚Ð¾Ñ‚ Ð¼Ð¾Ð´ÑƒÐ»ÑŒ Ð¾Ñ‚Ð²ÐµÑ‡Ð°ÐµÑ‚ Ð·Ð° Ð¾Ñ‚Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ðµ Ð¸ ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ðµ Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ð¾Ð² Ð°Ð½Ð°Ð»Ð¸Ð·Ð°.

#### Ð’Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ÑÑ‚Ð¸:
- Ð¦Ð²ÐµÑ‚Ð¾Ð²Ð¾Ð¹ Ð²Ñ‹Ð²Ð¾Ð´ Ð² CLI.
- Ð¡Ð¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ðµ Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ð¾Ð² Ð² JSON/CSV.
- ÐžÑ‚Ð¿Ñ€Ð°Ð²ÐºÐ° Ð°Ð»ÐµÑ€Ñ‚Ð¾Ð² Ñ‡ÐµÑ€ÐµÐ· Syslog, Slack, Email.

#### ÐŸÑ€Ð¸Ð¼ÐµÑ€ Ð²Ñ‹Ð²Ð¾Ð´Ð° Ð² ÐºÐ¾Ð½ÑÐ¾Ð»ÑŒ:
```python
from termcolor import colored

def display_alert(alert):
    color_map = {
        'low': 'green',
        'medium': 'yellow',
        'high': 'red'
    }
    print(colored(f"[!] {alert['description']}", color_map.get(alert['severity'], 'white')))
```

#### ÐŸÑ€Ð¸Ð¼ÐµÑ€ Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚Ð° JSON:
```json
{
  "timestamp": "2025-04-05T10:34:22",
  "alert": "Golden Ticket detected",
  "severity": "high",
  "description": "Ticket with long lifetime issued for krbtgt account",
  "source_ip": "192.168.1.100"
}
```

---

## 4.3. Ð ÐµÐ°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ Ð¼Ð¾Ð´ÑƒÐ»ÐµÐ¹

### 4.3.1. ÐŸÐ°Ñ€ÑÐ¸Ð½Ð³ ÑÐµÑ‚ÐµÐ²Ð¾Ð³Ð¾ Ñ‚Ñ€Ð°Ñ„Ð¸ÐºÐ°

Ð”Ð»Ñ Ð¿Ð°Ñ€ÑÐ¸Ð½Ð³Ð° ÑÐµÑ‚ÐµÐ²Ð¾Ð³Ð¾ Ñ‚Ñ€Ð°Ñ„Ð¸ÐºÐ° Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð»Ð¸ÑÑŒ ÑÐ»ÐµÐ´ÑƒÑŽÑ‰Ð¸Ðµ Ð±Ð¸Ð±Ð»Ð¸Ð¾Ñ‚ÐµÐºÐ¸:

- **Scapy**: Ð¿Ð¾Ð·Ð²Ð¾Ð»ÑÐµÑ‚ Ñ‡Ð¸Ñ‚Ð°Ñ‚ÑŒ Ð¸ Ð°Ð½Ð°Ð»Ð¸Ð·Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ ÑÐµÑ‚ÐµÐ²Ñ‹Ðµ Ð¿Ð°ÐºÐµÑ‚Ñ‹, Ð² Ñ‚Ð¾Ð¼ Ñ‡Ð¸ÑÐ»Ðµ Ñ Kerberos-Ð·Ð°Ð³Ð¾Ð»Ð¾Ð²ÐºÐ°Ð¼Ð¸.
- **PyShark**: Ð¿Ñ€ÐµÐ´Ð¾ÑÑ‚Ð°Ð²Ð»ÑÐµÑ‚ ÑƒÐ´Ð¾Ð±Ð½Ñ‹Ð¹ API Ð´Ð»Ñ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹ Ñ Wireshark-Ð¿Ð°ÐºÐµÑ‚Ð°Ð¼Ð¸, Ð¾ÑÐ¾Ð±ÐµÐ½Ð½Ð¾ Ð¿Ñ€Ð¸ Ñ€Ð°Ð±Ð¾Ñ‚Ðµ Ñ ASN.1-ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð°Ð¼Ð¸.

#### ÐŸÑ€Ð¸Ð¼ÐµÑ€ ÐºÐ¾Ð´Ð°:
```python
from scapy.all import *
from scapy.layers.kerberos import Kerberos

def parse_kerberos_packets(pcap_file):
    packets = rdpcap(pcap_file)
    for pkt in packets:
        if Kerberos in pkt:
            kerb_pkt = pkt[Kerberos]
            print(f"[+] Kerberos packet found: {kerb_pkt.show()}")
```

### 4.3.2. ÐÐ½Ð°Ð»Ð¸Ð· Ð¶ÑƒÑ€Ð½Ð°Ð»Ð¾Ð² Windows

Ð”Ð»Ñ Ñ‡Ñ‚ÐµÐ½Ð¸Ñ ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ð¹ Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚Ð¸ Windows Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð»ÑÑ Python-Ð¼Ð¾Ð´ÑƒÐ»ÑŒ `Evtx`, Ð¿Ð¾Ð·Ð²Ð¾Ð»ÑÑŽÑ‰Ð¸Ð¹ Ñ€Ð°Ð±Ð¾Ñ‚Ð°Ñ‚ÑŒ Ñ ETL/EVTX-Ñ„Ð°Ð¹Ð»Ð°Ð¼Ð¸.

#### ÐŸÑ€Ð¸Ð¼ÐµÑ€ ÐºÐ¾Ð´Ð°:
```python
import xml.etree.ElementTree as ET
import Evtx.Evtx as evtx

def read_event_logs(log_file):
    with evtx.Evtx(log_file) as log:
        for record in log.records():
            xml = ET.fromstring(record.xml())
            event_id = xml.find('.//EventID').text
            if event_id in ['4768', '4769', '4771']:
                yield parse_kerberos_event(xml)

def parse_kerberos_event(xml_data):
    # Ð˜Ð·Ð²Ð»ÐµÑ‡ÐµÐ½Ð¸Ðµ Ð¸Ð¼ÐµÐ½Ð¸ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ, SPN, Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸ Ð¸ Ð´Ñ€ÑƒÐ³Ð¸Ñ… Ð¿Ð¾Ð»ÐµÐ¹
    return {
        'event_id': ...,
        'user': ...,
        'spn': ...,
        'timestamp': ...
    }
```

### 4.3.3. ÐÐ»Ð³Ð¾Ñ€Ð¸Ñ‚Ð¼Ñ‹ Ð¾Ð±Ð½Ð°Ñ€ÑƒÐ¶ÐµÐ½Ð¸Ñ Ð°Ð½Ð¾Ð¼Ð°Ð»Ð¸Ð¹

Ð‘Ñ‹Ð»Ð¸ Ñ€ÐµÐ°Ð»Ð¸Ð·Ð¾Ð²Ð°Ð½Ñ‹ ÑÐ»ÐµÐ´ÑƒÑŽÑ‰Ð¸Ðµ Ð¿Ñ€Ð°Ð²Ð¸Ð»Ð° Ð°Ð½Ð°Ð»Ð¸Ð·Ð°:

#### Golden Ticket:
```python
def detect_golden_ticket(ticket):
    if ticket['lifetime'] > 86400 and ticket['user'] == 'krbtgt':
        return "Golden Ticket detected"
```

#### Kerberoasting:
```python
def detect_kerberoasting(tgs_requests):
    if len(tgs_requests) > 20 and tgs_requests[0]['time_diff'] < 5:
        return "Potential Kerberoasting detected"
```

#### Silver Ticket:
```python
def detect_silver_ticket(session):
    if 'TGT' not in session and 'TGS' in session:
        return "Possible Silver Ticket detected"
```

### 4.3.4. Ð˜Ð½Ñ‚ÐµÑ€Ñ„ÐµÐ¹Ñ Ð²Ñ‹Ð²Ð¾Ð´Ð° Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ð¾Ð²

Ð ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ñ‹ Ð²Ñ‹Ð²Ð¾Ð´Ð¸Ð»Ð¸ÑÑŒ Ð² ÐºÐ¾Ð½ÑÐ¾Ð»ÑŒ Ñ Ñ†Ð²ÐµÑ‚Ð¾Ð²Ð¾Ð¹ Ð¸Ð½Ð´Ð¸ÐºÐ°Ñ†Ð¸ÐµÐ¹:

```python
from termcolor import colored

def display_alert(alert):
    color_map = {
        'low': 'green',
        'medium': 'yellow',
        'high': 'red'
    }
    print(colored(f"[!] {alert['description']}", color_map.get(alert['severity'], 'white')))
```

ÐŸÑ€Ð¸Ð¼ÐµÑ€ Ð²Ñ‹Ð²Ð¾Ð´Ð°:
```
[!] Potential Kerberoasting detected at 10:34:22 from 192.168.1.100
```

---

## 4.4. Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÐ¼Ñ‹Ðµ Ñ‚ÐµÑ…Ð½Ð¾Ð»Ð¾Ð³Ð¸Ð¸

### 4.4.1. Ð¯Ð·Ñ‹Ðº Ð¿Ñ€Ð¾Ð³Ñ€Ð°Ð¼Ð¼Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ

- **Python 3.10+** â€” Ð²Ñ‹Ð±Ñ€Ð°Ð½ ÐºÐ°Ðº Ð¾ÑÐ½Ð¾Ð²Ð½Ð¾Ð¹ ÑÐ·Ñ‹Ðº Ñ€ÐµÐ°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ð¸ Ð±Ð»Ð°Ð³Ð¾Ð´Ð°Ñ€Ñ ÑˆÐ¸Ñ€Ð¾ÐºÐ¾Ð¹ Ð¿Ð¾Ð´Ð´ÐµÑ€Ð¶ÐºÐµ ÑÐµÑ‚ÐµÐ²Ñ‹Ñ… Ð¸ Ð°Ð½Ð°Ð»Ð¸Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ñ… Ð±Ð¸Ð±Ð»Ð¸Ð¾Ñ‚ÐµÐº.

### 4.4.2. Ð‘Ð¸Ð±Ð»Ð¸Ð¾Ñ‚ÐµÐºÐ¸ Ð¸ Ñ„Ñ€ÐµÐ¹Ð¼Ð²Ð¾Ñ€ÐºÐ¸

| ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ | ÐÐ°Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ |
|---------|------------|
| Scapy | ÐŸÐ°Ñ€ÑÐ¸Ð½Ð³ ÑÐµÑ‚ÐµÐ²Ð¾Ð³Ð¾ Ñ‚Ñ€Ð°Ñ„Ð¸ÐºÐ° |
| PyShark | Ð”ÐµÐºÐ¾Ð´Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Kerberos-ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ð¹ |
| Pandas | ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° Ð¸ Ð°Ð½Ð°Ð»Ð¸Ð· Ð»Ð¾Ð³Ð¾Ð² |
| NumPy | ÐœÐ°Ñ‚ÐµÐ¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ðµ Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸Ð¸ |
| Evtx | Ð§Ñ‚ÐµÐ½Ð¸Ðµ Windows Event Logs |
| Termcolor | Ð¦Ð²ÐµÑ‚Ð¾Ð²Ð¾Ðµ Ð¾Ñ„Ð¾Ñ€Ð¼Ð»ÐµÐ½Ð¸Ðµ Ð²Ñ‹Ð²Ð¾Ð´Ð° |
| Argparse | ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° ÐºÐ¾Ð¼Ð°Ð½Ð´Ð½Ð¾Ð¹ ÑÑ‚Ñ€Ð¾ÐºÐ¸ |
| Logging | Ð›Ð¾Ð³Ð³Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹ Ð¿Ñ€Ð¾Ð³Ñ€Ð°Ð¼Ð¼Ñ‹ |

### 4.4.3. Ð˜Ð½ÑÑ‚Ñ€ÑƒÐ¼ÐµÐ½Ñ‚Ñ‹ Ð°Ð½Ð°Ð»Ð¸Ð·Ð°

| Ð˜Ð½ÑÑ‚Ñ€ÑƒÐ¼ÐµÐ½Ñ‚ | ÐÐ°Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ |
|-----------|------------|
| Wireshark | ÐÐ½Ð°Ð»Ð¸Ð· Ð¸ ÑÐºÑÐ¿Ð¾Ñ€Ñ‚ PCAP-Ñ„Ð°Ð¹Ð»Ð¾Ð² |
| Tcpdump | Ð—Ð°Ñ…Ð²Ð°Ñ‚ Ñ‚Ñ€Ð°Ñ„Ð¸ÐºÐ° Ð² Ñ€ÐµÐ°Ð»ÑŒÐ½Ð¾Ð¼ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸ |
| Event Viewer | Ð§Ñ‚ÐµÐ½Ð¸Ðµ Ð¸ ÑÐºÑÐ¿Ð¾Ñ€Ñ‚ Windows Security Logs |
| Sigma | Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ ÑÐ¸Ð³Ð½Ð°Ñ‚ÑƒÑ€ Ð´Ð»Ñ ÑÑ€Ð°Ð²Ð½ÐµÐ½Ð¸Ñ |
| Jupyter Notebook | ÐŸÑ€ÐµÐ´Ð²Ð°Ñ€Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ð¹ Ð°Ð½Ð°Ð»Ð¸Ð· Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð¸ Ð¾Ñ‚Ð»Ð°Ð´ÐºÐ° Ð°Ð»Ð³Ð¾Ñ€Ð¸Ñ‚Ð¼Ð¾Ð² |

---

